/*! betajs - v0.0.2 - 2014-06-09, Copyright (c) Oliver Friedmann & Victor Lingenthal, MIT Software License. */BetaJS.Net.AbstractAjax.extend("BetaJS.Browser.JQueryAjax",{_syncCall:function(a){var b;return BetaJS.$.ajax({type:a.method,async:!1,url:a.uri,dataType:a.decodeType?a.decodeType:null,data:a.encodeType&&"json"==a.encodeType?JSON.stringify(a.data):a.data,success:function(a){b=a},error:function(a,b,c){throw new BetaJS.Net.AjaxException(a.status,c,JSON.parse(a.responseText))}}),b},_asyncCall:function(a,b){BetaJS.Browser.Info.isInternetExplorer()&&BetaJS.Browser.Info.internetExplorerVersion()<=9&&(BetaJS.$.support.cors=!0),BetaJS.$.ajax({type:a.method,async:!0,url:a.uri,dataType:a.decodeType?a.decodeType:null,data:a.encodeType&&"json"==a.encodeType?JSON.stringify(a.data):a.data,success:function(a){BetaJS.SyncAsync.callback(b,"success",a)},error:function(a,c,d){var e=new BetaJS.Net.AjaxException(a.status,d,JSON.parse(a.responseText));BetaJS.SyncAsync.callback(b,"exception",e)}})}}),BetaJS.Browser.Cookies={get:function(a){return BetaJS.Strings.read_cookie_string(document.cookie,a)},set:function(a,b){document.cookie=BetaJS.Strings.write_cookie_string(document.cookie,a,b)}},BetaJS.Browser.Dom={traverseNext:function(a,b){return"get"in a&&(a=a.get(0)),a.firstChild&&!b?BetaJS.$(a.firstChild):a.parentNode?a.nextSibling?BetaJS.$(a.nextSibling):this.traverseNext(a.parentNode,!0):null},selectNode:function(a,b){a=BetaJS.$(a).get(0);var c=null,d=null;window.getSelection?(c=window.getSelection(),c.removeAllRanges(),d=document.createRange()):document.selection&&(c=document.selection,d=c.createRange()),b?(d.setStart(a,b),d.setEnd(a,b),c.addRange(d)):(d.selectNode(a),c.addRange(d))},selectionStartNode:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).startContainer):document.selection?BetaJS.$(document.selection.createRange().startContainer):null},selectedHtml:function(){return window.getSelection?window.getSelection().toString():document.selection?document.selection.createRange().htmlText:""},selectionAncestor:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).commonAncestorContainer):document.selection?BetaJS.$(document.selection.createRange().parentElement()):null},selectionStartOffset:function(){return window.getSelection?window.getSelection().getRangeAt(0).startOffset:document.selection?document.selection.createRange().startOffset:null},selectionEndOffset:function(){return window.getSelection?window.getSelection().getRangeAt(0).endOffset:document.selection?document.selection.createRange().endOffset:null},selectionStart:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).startContainer):document.selection?BetaJS.$(document.selection.createRange().startContainer):null},selectionEnd:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).endContainer):document.selection?BetaJS.$(document.selection.createRange().endContainer):null},selectionNonEmpty:function(){var a=this.selectionStart(),b=this.selectionEnd();return a&&b&&a.get(0)&&b.get(0)&&(a.get(0)!=b.get(0)||this.selectionStartOffset()!=this.selectionEndOffset())},selectionContained:function(a){return a.has(this.selectionStart()).length>0&&a.has(this.selectionEnd()).length>0},selectionNodes:function(){var a=[],b=this.selectionStart(),c=this.selectionEnd();a.push(b);for(var d=b;d.get(0)!=c.get(0);)d=this.traverseNext(d),a.push(d);return a},selectionLeaves:function(){return BetaJS.Objs.filter(this.selectionNodes(),function(a){return 0===a.children().length})},contentSiblings:function(a){return a.parent().contents().filter(function(){return this!=a.get(0)})},remove_tag_from_parent_path:function(a,b,c){b=b.toLowerCase(),a=BetaJS.$(a);for(var d=a.parents(c?c+" "+b:b),e=0;e<d.length;++e){var f=d.get(e);for(f=BetaJS.$(f);a.get(0)!=f.get(0);)this.contentSiblings(a).wrap("<"+b+"></"+b+">"),a=a.parent();f.contents().unwrap()}},selectionSplitOffsets:function(){var a=this.selectionStartOffset(),b=this.selectionEndOffset(),c=this.selectionStart(),d=this.selectionEnd(),e=c.get(0)==d.get(0);if(b<d.get(0).wholeText.length){var f=d.get(0);f.splitText(b),d=BetaJS.$(f),e&&(c=d)}a>0&&(c=BetaJS.$(c.get(0).splitText(a)),e&&(d=c)),this.selectRange(c,d)},selectRange:function(a,b,c,d){a=BetaJS.$(a),b=BetaJS.$(b);var e=null,f=null;window.getSelection?(e=window.getSelection(),e.removeAllRanges(),f=document.createRange()):document.selection&&(e=document.selection,f=e.createRange()),f.setStart(a.get(0),c||0),f.setEnd(b.get(0),d||b.get(0).data.length),e.addRange(f)},splitNode:function(a,b,c){if(a=BetaJS.$(a),b=b||0,c=c||a.get(0).data.length,c<a.get(0).data.length){var d=a.get(0);d.splitText(c),a=BetaJS.$(d)}return b>0&&(a=BetaJS.$(a.get(0).splitText(b))),a}},BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Hotkeys={SHIFT_NUMS:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},SPECIAL_KEYS:{esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},MODIFIERS:["ctrl","alt","shift","meta"],keyCodeToCharacter:function(a){return 188==a?",":190==a?".":String.fromCharCode(a).toLowerCase()},register:function(a,b,c,d){d=BetaJS.Objs.extend({type:"keyup",propagate:!1,disable_in_input:!1,target:document,keycode:!1},d),d.target=BetaJS.$(d.target);var e=a.toLowerCase().split("+"),f=function(a){if(d.disable_in_input){var f=a.target||a.srcElement||null;if(f&&3==f.nodeType&&(f=f.parentNode),f&&("INPUT"==f.tagName||"TEXTAREA"==f.tagName))return}var g=a.keyCode||a.which||0,h=BetaJS.Browser.Hotkeys.keyCodeToCharacter(g),i=0,j={};BetaJS.Objs.iter(BetaJS.Browser.Hotkeys.MODIFIERS,function(b){j[b]={pressed:a[b+"Key"],wanted:!1}},this),BetaJS.Objs.iter(e,function(b){b in j?(j[b].wanted=!0,i++):b.length>1?BetaJS.Browser.Hotkeys.SPECIAL_KEYS[b]==g&&i++:d.keycode?d.keycode==g&&i++:(h==b||a.shiftKey&&BetaJS.Browser.Hotkeys.SHIFT_NUMS[h]==b)&&i++},this),i==e.length&&BetaJS.Objs.all(j,function(a){return a.wanted==a.pressed})&&(b.apply(c||this),d.propagate||a.preventDefault())};return d.target.on(d.type,f),{target:d.target,type:d.type,func:f}},unregister:function(a){a.target.off(a.type,a.func)}},BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Info={getNavigator:function(){return{appCodeName:navigator.appCodeName,appName:navigator.appName,appVersion:navigator.appVersion,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,platform:navigator.platform,userAgent:navigator.userAgent}},__cache:{},__cached:function(a,b){return a in this.__cache||(this.__cache[a]=b.apply(this)),this.__cache[a]},flash:function(){return this.__cached("flash",function(){return new BetaJS.Browser.FlashDetect})},isiOS:function(){return this.__cached("isiOS",function(){var a=navigator.userAgent;return-1!=a.indexOf("iPhone")||-1!=a.indexOf("iPod")||-1!=a.indexOf("iPad")})},isChrome:function(){return this.__cached("isChrome",function(){return"chrome"in window})},isAndroid:function(){return this.__cached("isAndroid",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("android")})},isWebOS:function(){return this.__cached("isWebOS",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("webos")})},isWindowsPhone:function(){return this.__cached("isWindowsPhone",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("windows phone")})},isBlackberry:function(){return this.__cached("isBlackberry",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("blackberry")})},iOSversion:function(){return this.__cached("iOSversion",function(){if(!this.isiOS())return!1;var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return{major:parseInt(a[1],10),minor:parseInt(a[2],10),revision:parseInt(a[3]||0,10)}})},isMobile:function(){return this.__cached("isMobile",function(){return this.isiOS()||this.isAndroid()||this.isWebOS()||this.isWindowsPhone()||this.isBlackberry()})},isInternetExplorer:function(){return this.__cached("isInternetExplorer",function(){return null!==this.internetExplorerVersion()})},isFirefox:function(){return this.__cached("isFirefox",function(){return-1!=navigator.userAgent.toLowerCase().indexOf("firefox")})},isSafari:function(){return this.__cached("isSafari",function(){return!this.isChrome()&&-1!=navigator.userAgent.toLowerCase().indexOf("safari")})},isWindows:function(){return this.__cached("isWindows",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("win")})},isMacOS:function(){return this.__cached("isMacOS",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("mac")})},isUnix:function(){return this.__cached("isUnix",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("x11")})},isLinux:function(){return this.__cached("isLinux",function(){return-1!=navigator.appVersion.toLowerCase().indexOf("linux")})},internetExplorerVersion:function(){if("Microsoft Internet Explorer"==navigator.appName){var a=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");if(a.exec(navigator.userAgent))return parseFloat(RegExp.$1)}else if("Netscape"==navigator.appName){var b=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})");if(b.exec(navigator.userAgent))return parseFloat(RegExp.$1)}return null}},BetaJS.Class.extend("BetaJS.Browser.FlashDetect",{constructor:function(){if(this._inherited(BetaJS.Browser.FlashDetect,"constructor"),this.__version=null,navigator.plugins&&navigator.plugins.length>0){var a="application/x-shockwave-flash",b=navigator.mimeTypes;b&&b[a]&&b[a].enabledPlugin&&b[a].enabledPlugin.description&&(this.__version=this.parseVersion(b[a].enabledPlugin.description))}else if(-1==navigator.appVersion.indexOf("Mac")&&window.execScript)for(var c=0;c<this.__activeXDetectRules.length;c++)try{var d=new ActiveXObject(this.__activeXDetectRules[c].name),e=this.__activeXDetectRules[c].version(d);if(e){this.__version=this.parseActiveXVersion(e);break}}catch(f){}},parseVersion:function(a){var b=a.split(/ +/),c=b[2].split(/\./),d=b[3];return{raw:a,major:parseInt(c[0],10),minor:parseInt(c[1],10),revisionStr:d,revision:parseInt(d.replace(/[a-zA-Z]/g,""),10)}},parseActiveXVersion:function(a){var b=a.split(",");return{raw:a,major:parseInt(b[0].split(" ")[1],10),minor:parseInt(b[1],10),revision:parseInt(b[2],10),revisionStr:b[2]}},version:function(){return this.__version},installed:function(){return null!==this.__version},supported:function(){return this.installed()||!BetaJS.Browser.Info.isiOS()},majorAtLeast:function(a){return this.installed()&&this.version().major>=a},minorAtLeast:function(a){return this.installed()&&this.version().minor>=a},revisionAtLeast:function(a){return this.installed()&&this.version().revision>=a},versionAtLeast:function(){if(!this.installed())return!1;var a=[this.version().major,this.version().minor,this.version().revision],b=Math.min(a.length,arguments.length);for(i=0;b>i;i++)if(a[i]!=arguments[i])return a[i]>arguments[i];return!0},__activeXDetectRules:[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(a){try{return a.GetVariable("$version")}catch(b){return null}}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(a){try{a.AllowScriptAccess="always";try{return a.GetVariable("$version")}catch(b){return null}}catch(b){return"6,0,21"}}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(a){try{return a.GetVariable("$version")}catch(b){return null}}}]}),BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Loader={loadScript:function(a,b,c){var d=!1,e=document.getElementsByTagName("head")[0],f=document.createElement("script");f.src=a,f.onload=f.onreadystatechange=function(){d||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(d=!0,f.onload=f.onreadystatechange=null,b&&b.apply(c||this,[a]))},e.appendChild(f)},loadStyles:function(a,b,c){var d=!1,e=document.getElementsByTagName("head")[0],f=document.createElement("link");f.rel="stylesheet",f.href=a,f.onload=f.onreadystatechange=function(){d||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(d=!0,f.onload=f.onreadystatechange=null,b&&b.apply(c||this,[a]))},e.appendChild(f)},inlineStyles:function(a){BetaJS.$("<style>"+a+"</style>").appendTo("head")}},BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Router=BetaJS.Class.extend("BetaJS.Browser.Router",[BetaJS.Events.EventsMixin,{routes:[],constructor:function(a){this._inherited(BetaJS.Browser.Router,"constructor");var b=BetaJS.Types.is_function(this.routes)?this.routes():this.routes;BetaJS.Types.is_array(b)||(b=[b]),"routes"in a&&(BetaJS.Types.is_array(a.routes)?b=b.concat(a.routes):b.push(a.routes)),this.__routes=[],this.__paths={},this.__current=null,BetaJS.Objs.iter(b,function(a){BetaJS.Objs.iter(a,function(a,b){BetaJS.Types.is_string(a)&&(a={action:a}),a.key=b,a.route=new RegExp("^"+b+"$"),"applicable"in a?BetaJS.Types.is_array(a.applicable)||(a.applicable=[a.applicable]):a.applicable=[],"valid"in a?BetaJS.Types.is_array(a.valid)||(a.valid=[a.valid]):a.valid=[],"path"in a||(a.path=a.key),this.__routes.push(a),this.__paths[a.path]=a},this)},this),"actions"in a&&BetaJS.Objs.iter(a.actions,function(a,b){this[b]=a},this)},destroy:function(){this.__leave(),this._inherited(BetaJS.Browser.Router,"destroy")},parse:function(a){for(var b=0;b<this.__routes.length;++b){var c=this.__routes[b],d=c.route.exec(a);if(null!==d){d.shift(1);var e=!0;if(BetaJS.Objs.iter(c.applicable,function(a){var b=BetaJS.Types.is_string(a)?this[a]:a;e=e&&b.apply(this,d)},this),!e)continue;var f=!0;return BetaJS.Objs.iter(c.valid,function(a){var b=BetaJS.Types.is_string(a)?this[a]:a;f=f&&b.apply(this,d)},this),f?{object:c,params:d}:null}}return null},object:function(a){return this.__paths[a]},path:function(a){for(var b=this.object(a).key,c=Array.prototype.slice.apply(arguments,[1]),d=/\(.*?\)/;;){var e=c.shift();if(!e)break;b=b.replace(d,e)}return b},navigate:function(a){this.trigger("navigate",a);var b=this.parse(a);return null===b?(this.trigger("navigate-fail",a),!1):(this.trigger("navigate-success",b.object,b.params),this.invoke(b.object,b.params,a))},invoke:function(a,b,c){c=c||this.path(a.key,b),this.trigger("before_invoke",a,b,c),this.__enter(a,b,c),this.trigger("after_invoke",a,b,c);var d=this._invoke(a,b);return d},_invoke:function(a,b){var c=a.action;return BetaJS.Types.is_string(c)&&(c=this[c]),c.apply(this,b)},__leave:function(){null!==this.__current&&(this.trigger("leave",this.__current),this.__current.destroy(),this.__current=null)},__enter:function(a,b,c){this.__leave(),this.__current=new BetaJS.Events.Events,this.__current.route=c,this.__current.object=a,this.__current.params=b,this.trigger("enter",this.__current)},current:function(){return this.__current}}]),BetaJS.Class.extend("BetaJS.Browser.RouterHistory",[BetaJS.Events.EventsMixin,{constructor:function(a){this._inherited(BetaJS.Browser.RouterHistory,"constructor"),this.__router=a,this.__history=[],a.on("after_invoke",this.__after_invoke,this)},destroy:function(){this.__router.off(null,null,this),this._inherited(BetaJS.Browser.RouterHistory,"destroy")},__after_invoke:function(a,b){this.__history.push({object:a,params:b}),this.trigger("change")},last:function(a){return a=a||0,this.get(this.count()-1-a)},count:function(){return this.__history.length},get:function(a){return a=a||0,this.__history[a]},getRoute:function(a){var b=this.get(a);return this.__router.path(b.object.path,b.params)},back:function(a){if(this.count()<2)return null;for(a=a||0;a>=0&&this.count()>1;)this.__history.pop(),--a;var b=this.__history.pop();return this.trigger("change"),this.__router.invoke(b.object,b.params)}}]),BetaJS.Class.extend("BetaJS.Browser.RouteBinder",{constructor:function(a){this._inherited(BetaJS.Browser.RouteBinder,"constructor"),this.__router=a,this.__router.on("after_invoke",function(a,b,c){this._getExternalRoute()!=c&&this._setExternalRoute(c)},this)},destroy:function(){this.__router.off(null,null,this),this._inherited(BetaJS.Browser.RouteBinder,"destroy")},current:function(){return this._getExternalRoute()},_setRoute:function(a){var b=this.__router.current();b&&b.route==a||this.__router.navigate(a)},_getExternalRoute:function(){return""},_setExternalRoute:function(){}}),BetaJS.Browser.RouteBinder.extend("BetaJS.Browser.HashRouteBinder",{constructor:function(a){this._inherited(BetaJS.Browser.HashRouteBinder,"constructor",a);var b=this;BetaJS.$(window).on("hashchange.events"+this.cid(),function(){b._setRoute(b._getExternalRoute())})},destroy:function(){BetaJS.$(window).off("hashchange.events"+this.cid()),this._inherited(BetaJS.Browser.HashRouteBinder,"destroy")},_getExternalRoute:function(){var a=window.location.hash;return a.length&&"#"==a[0]?a.slice(1):a},_setExternalRoute:function(a){window.location.hash="#"+a}}),BetaJS.Browser.RouteBinder.extend("BetaJS.Browser.HistoryRouteBinder",{constructor:function(a){this._inherited(BetaJS.Browser.HistoryRouteBinder,"constructor",a);var b=this;this.__used=!1,BetaJS.$(window).on("popstate.events"+this.cid(),function(){b.__used&&b._setRoute(b._getExternalRoute())})},destroy:function(){BetaJS.$(window).off("popstate.events"+this.cid()),this._inherited(BetaJS.Browser.HistoryRouteBinder,"destroy")},_getExternalRoute:function(){return window.location.pathname},_setExternalRoute:function(a){window.history.pushState({},document.title,a),this.__used=!0}},{supported:function(){return window.history&&window.history.pushState}}),BetaJS.Browser.RouteBinder.extend("BetaJS.Browser.LocationRouteBinder",{_getExternalRoute:function(){return window.location.pathname},_setExternalRoute:function(a){window.location.pathname=a}}),BetaJS.Stores.StoreException.extend("BetaJS.Stores.RemoteStoreException",{constructor:function(a){a=BetaJS.Net.AjaxException.ensure(a),this._inherited(BetaJS.Stores.RemoteStoreException,"constructor",a.toString()),this.__source=a},source:function(){return this.__source}}),BetaJS.Stores.BaseStore.extend("BetaJS.Stores.RemoteStore",{constructor:function(a,b,c){this._inherited(BetaJS.Stores.RemoteStore,"constructor",c),this._uri=a,this.__ajax=b,this.__options=BetaJS.Objs.extend({update_method:"PUT",uri_mappings:{},bulk_method:"POST",supports_bulk:!1},c||{})},getUri:function(){return this._uri},prepare_uri:function(a,b){return this.__options.uri_mappings[a]?this.__options.uri_mappings[a](b):"remove"==a||"get"==a||"update"==a?this.getUri()+"/"+b[this._id_key]:this.getUri()},_encode_query:function(){return{uri:this.prepare_uri("query")}},__invoke:function(a,b,c){if(b)return this.__ajax.asyncCall(a,{success:function(a){if(c&&BetaJS.Types.is_string(a))try{a=JSON.parse(a)}catch(d){}BetaJS.SyncAsync.callback(b,"success",a)},exception:function(a){BetaJS.SyncAsync.callback(b,"exception",new BetaJS.Stores.RemoteStoreException(a))}});try{var d=this.__ajax.syncCall(a);if(c&&BetaJS.Types.is_string(d))try{return JSON.parse(d)}catch(e){}return d}catch(e){throw new BetaJS.Stores.RemoteStoreException(e)}return!1},_insert:function(a,b){return this.__invoke({method:"POST",uri:this.prepare_uri("insert",a),data:a},b,!0)},_get:function(a,b){var c={};return c[this._id_key]=a,this.__invoke({uri:this.prepare_uri("get",c)},b)},_update:function(a,b,c){var d=BetaJS.Objs.clone(b,1);return d[this._id_key]=a,this.__invoke({method:this.__options.update_method,uri:this.prepare_uri("update",d),data:b},c)},_remove:function(a,b){var c={};return c[this._id_key]=a,this.__invoke({method:"DELETE",uri:this.prepare_uri("remove",c)},b)},_query:function(a,b,c){return this.__invoke(this._encode_query(a,b),c,!0)},bulk:function(a,b){return this.__options.supports_bulk?this.__invoke({method:this.__options.bulk_method,uri:this.prepare_uri("bulk"),data:a}):this._inherited(BetaJS.Stores.RemoteStore,"bulk",a,b)}}),BetaJS.Stores.RemoteStore.extend("BetaJS.Stores.QueryGetParamsRemoteStore",{constructor:function(a,b,c,d){this._inherited(BetaJS.Stores.QueryGetParamsRemoteStore,"constructor",a,b,d),this.__capability_params=c},_query_capabilities:function(){var a={};return"skip"in this.__capability_params&&(a.skip=!0),"limit"in this.__capability_params&&(a.limit=!0),"query"in this.__capability_params&&(a.query=!0),"sort"in this.__capability_params&&(a.sort=!0),a},_encode_query:function(a,b){b=b||{};var c=this.getUri()+"?";return b.skip&&"skip"in this.__capability_params&&(c+=this.__capability_params.skip+"="+b.skip+"&"),b.limit&&"limit"in this.__capability_params&&(c+=this.__capability_params.limit+"="+b.limit+"&"),b.sort&&"sort"in this.__capability_params&&(c+=this.__capability_params.sort+"="+JSON.stringify(b.sort)+"&"),"query"in this.__capability_params&&(c+=this.__capability_params.query+"="+JSON.stringify(a)+"&"),{uri:c}}}),BetaJS.$=jQuery||null,BetaJS.Exceptions.Exception.extend("BetaJS.Views.ViewException"),BetaJS.Views.View=BetaJS.Class.extend("BetaJS.Views.View",[BetaJS.Events.EventsMixin,BetaJS.Events.ListenMixin,BetaJS.Properties.PropertiesMixin,BetaJS.Classes.ModuleMixin,{$el:null,_templates:function(){return{}},_dynamics:function(){return{}},_events:function(){return[]},_global_events:function(){return[]},_css:function(){return{}},css:function(a){if(this.__css[a])return this.__css[a];var b=null;return this.__parent&&(b=this.__parent.css(a),b&&b!=a)?b:(b=this._css(),b[a]?b[a]:a)},_render:function(){this.__html?this.$el.html(this.__html):this.__templates["default"]?this.$el.html(this.evaluateTemplate("default",{})):this.__dynamics["default"]&&this.evaluateDynamics("default",this.$el,{},{name:"default"})},templates:function(a){return a in this.__templates?this.__templates[a]:null},dynamics:function(a){return a in this.__dynamics?this.__dynamics[a]:null},_supp:function(){return{__context:this,css:function(a){return this.__context.css(a)},attrs:function(a){var b="";for(var c in a)b+=(a[c]?c+"='"+a[c]+"'":c)+" ";return b},styles:function(a){var b="";for(var c in a)b+=c+":"+a[c]+";";return b},selector:function(a){return"data-selector='"+a+"' "},view_id:this.cid()}},templateArguments:function(){var a=this.getAll();return a.supp=this._supp(),a},evaluateTemplate:function(a,b){return b=b||{},this.__templates[a].evaluate(BetaJS.Objs.extend(b,this.templateArguments()))},evaluateDynamics:function(a,b,c,d){return this.__dynamics[a].renderInstance(b,BetaJS.Objs.extend(d||{},{args:c||{}}))},_setOption:function(a,b,c,d){d=d?d:"__",this[d+b]=a&&b in a&&BetaJS.Types.is_defined(a[b])?a[b]:c},_setOptionTyped:function(a,b,c,d,e){this._setOption(a,b,this.cls._parseType(c,d),e)},_setOptionProperty:function(a,b,c){this.set(b,a&&b in a&&BetaJS.Types.is_defined(a[b])?a[b]:c)},_setOptionPropertyTyped:function(a,b,c){this._setOptionProperty(a,b,this.cls._parseType(c,type))},constructor:function(a){a=a||{},this._inherited(BetaJS.Views.View,"constructor"),this._setOption(a,"el",null),this._setOption(a,"visible",!0),this._setOption(a,"html",null),this._setOption(a,"events",[]),this._setOption(a,"attributes",{}),this._setOption(a,"invalidate_on_show",!1),this._setOption(a,"append_to_el",!1),this.__old_attributes={},this._setOption(a,"el_classes",[]),BetaJS.Types.is_string(this.__el_classes)&&(this.__el_classes=this.__el_classes.split(" ")),this.__added_el_classes=[],this._setOption(a,"el_styles",{}),this._setOption(a,"children_styles",{}),this._setOption(a,"children_classes",[]),BetaJS.Types.is_string(this.__children_classes)&&(this.__children_classes=this.__children_classes.split(" ")),this._setOption(a,"invalidate_on_change",!1),this.__old_el_styles={},this._setOption(a,"css",{}),this.__parent=null,this.__children={},this.__active=!1,this.$el=null;var b=BetaJS.Types.is_function(this._events)?this._events():this._events;BetaJS.Types.is_array(b)||(b=[b]),this.__events=b.concat(this.__events);var c=BetaJS.Types.is_function(this._global_events)?this._global_events():this._global_events;BetaJS.Types.is_array(c)||(c=[c]),this.__global_events=c;var d=BetaJS.Objs.extend(BetaJS.Types.is_function(this._templates)?this._templates():this._templates,a.templates||{});"template"in a&&(d["default"]=a.template),this.__templates={};var e=null;for(e in d){if(!d[e])throw new BetaJS.Views.ViewException("Could not find template '"+e+"' in View '"+this.cls.classname+"'");this.__templates[e]=new BetaJS.Templates.Template(BetaJS.Types.is_string(d[e])?d[e]:d[e].html())}var f=BetaJS.Objs.extend(BetaJS.Types.is_function(this._dynamics)?this._dynamics():this._dynamics,a.dynamics||{});"dynamic"in a&&(f["default"]=a.dynamic),this.__dynamics={};for(e in f)this.__dynamics[e]=new BetaJS.Views.DynamicTemplate(this,BetaJS.Types.is_string(f[e])?f[e]:f[e].html());this.setAll(a.properties||{}),this.__invalidate_on_change&&this.on("change",function(){this.invalidate()},this),this.__modules={},BetaJS.Objs.iter(a.modules||[],this.add_module,this),this._notify("created",a),this.ns={};var g=this._domain(),h=this._domain_defaults(),i=null;if(!BetaJS.Types.is_empty(g)){var j=[];for(i in g)j.push({name:i,data:g[i]});j=BetaJS.Sort.dependency_sort(j,function(a){return a.name},function(a){return a.data.before||[]},function(a){var b=a.data.after||[];return a.data.parent&&b.push(a.data.parent),b});for(var k=0;k<j.length;++k){i=j[k].name;var l=j[k].data,m=l.options||{};BetaJS.Types.is_function(m)&&(m=m.apply(this,[this]));var n=h[l.type]||{};BetaJS.Types.is_function(n)&&(n=n.apply(this,[this])),m=BetaJS.Objs.tree_merge(n,m),l.type in BetaJS.Views&&(l.type=BetaJS.Views[l.type]),BetaJS.Types.is_string(l.type)&&(l.type=BetaJS.Scopes.resolve(l.type));var o=new l.type(m);this.ns[i]=o;var p=l.parent_options||{},q=this;l.parent&&(q=BetaJS.Scopes.resolve(l.parent,this.ns)),l.method?l.method(q,o):q.addChild(o,p),o.domain=this;var r=null;for(r in l.events||{})o.on(r,l.events[r],o);for(r in l.listeners||{})this.on(r,l.listeners[r],o)}}},_domain:function(){return{}},_domain_defaults:function(){return{}},isActive:function(){return this.__active},activate:function(){if(this.isActive())return this;if(this.__parent&&!this.__parent.isActive())return null;if(this.$el=this.__parent?this.__el?this.__parent.$(this.__el):this.__parent.$el:BetaJS.$(this.__el),0===this.$el.size()&&(this.$el=null),!this.$el)return null;this.__append_to_el&&(this.$el.append("<div data-view-id='"+this.cid()+"'></div>"),this.$el=this.$el.find("[data-view-id='"+this.cid()+"']")),this.__old_attributes={};var a=null,b=null;for(a in this.__attributes)b=this.$el.attr(a),this.__old_attributes[a]=BetaJS.Types.is_defined(b)?b:null,this.$el.attr(a,this.__attributes[a]);this.__added_el_classes=[];for(var c=this._el_classes().concat(this.__el_classes),d=0;d<c.length;++d)this.$el.hasClass(c[d])||(this.$el.addClass(c[d]),this.__added_el_classes.push(c[d]));this.__old_el_styles={};var e=BetaJS.Objs.extend(this._el_styles(),this.__el_styles);for(a in e)b=this.$el.css(a),this.__old_el_styles[a]=BetaJS.Types.is_defined(b)?b:null,this.$el.css(a,e[a]);return this.__bind(),this.__visible||this.$el.css("display",this.__visible?"":"none"),this.__active=!0,this.__render(),BetaJS.Objs.iter(this.__children,function(a){a.view.activate()}),this._notify("activate"),this.trigger("activate"),this.__visible&&this.trigger("show"),this.trigger("visibility",this.__visible),this.trigger("resize"),this},deactivate:function(){if(!this.isActive())return!1;this.__visible&&this.trigger("hide"),this.trigger("visibility",!1),this._notify("deactivate"),this.trigger("deactivate"),BetaJS.Objs.iter(this.__children,function(a){a.view.deactivate()}),this.__active=!1,BetaJS.Objs.iter(this.__dynamics,function(a){a.reset()},this),this.__unbind(),this.$el.html("");var a=null;for(a in this.__old_attributes)this.$el.attr(a,this.__old_attributes[a]);for(var b=0;b<this.__added_el_classes.length;++b)this.$el.removeClass(this.__added_el_classes[b]);for(a in this.__old_el_styles)this.$el.css(a,this.__old_el_styles[a]);return this.__append_to_el&&this.$el.remove(),this.$el=null,!0},_el_styles:function(){return{}},_el_classes:function(){return[]},$:function(a){return this.$el.find(a)},$data:function(a,b){b||(b=this.$el);var c="";for(var d in a)c+="[data-"+d+"='"+a[d]+"']";return b.find(c)},destroy:function(){this.deactivate(),this.setParent(null);var a=this.__children;this.__children={},BetaJS.Objs.iter(a,function(a){a.view.destroy()}),this.__children={},BetaJS.Objs.iter(this.__dynamics,function(a){a.destroy()},this),BetaJS.Objs.iter(this.__templates,function(a){a.destroy()},this),this.trigger("destroy"),this._inherited(BetaJS.Views.View,"destroy")},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},isVisible:function(){return this.__visible},setVisibility:function(a){a!=this.__visible&&(this.__visible=a,this.isActive()&&(this.$el.css("display",this.__visible?"":"none"),this.__visible&&(this.trigger("resize"),this.__invalidate_on_show&&this.invalidate()),this.trigger(a?"show":"hide"),this.trigger("visibility",a)),this.__parent&&this.__parent.updateChildVisibility(this))},updateChildVisibility:function(){},toggle:function(){this.setVisibility(!this.isVisible())},__bind:function(){var a=this;this.__unbind(),BetaJS.Objs.iter(this.__events,function(b){BetaJS.Objs.iter(b,function(b,c){var d=BetaJS.Types.is_function(b)?b:a[b],e=c.match(BetaJS.Views.BIND_EVENT_SPLITTER),f=e[1],g=e[2];f=f+".events"+a.cid();var h=BetaJS.Functions.as_method(d,a);""===g?a.$el.on(f,h):a.$el.on(f,g,h)})}),BetaJS.Objs.iter(this.__global_events,function(b){BetaJS.Objs.iter(b,function(b,c){var d=BetaJS.Types.is_function(b)?b:a[b],e=c.match(BetaJS.Views.BIND_EVENT_SPLITTER),f=e[1],g=e[2];f=f+".events"+a.cid();var h=BetaJS.Functions.as_method(d,a);""===g?BetaJS.$(document).on(f,h):BetaJS.$(document).on(f,g,h)})})},__unbind:function(){this.$el.off(".events"+this.cid()),BetaJS.$(document).off(".events"+this.cid())},__render:function(){if(this.isActive()){this._render();var a=this.$el.children();if(!BetaJS.Types.is_empty(this.__children_styles))for(var b in this.__children_styles)a.css(b,this.__children_styles[b]);BetaJS.Objs.iter(this.__children_classes,function(b){a.addClass(b)}),this.trigger("render")}},invalidate:function(){this.isActive()&&(BetaJS.Objs.iter(this.__children,function(a){a.view.deactivate()}),BetaJS.Objs.iter(this.__dynamics,function(a){a.reset()},this),this.__render(),BetaJS.Objs.iter(this.__children,function(a){a.view.activate()}))},setEl:function(a){this.isActive()?(this.deactivate(),this.__el=a,this.activate()):this.__el=a},getParent:function(){return this.__parent},hasChild:function(a){return a&&a.cid()in this.__children},setParent:function(a){if(a!=this.__parent){if(this.deactivate(),this.__parent){this._unbindParent(this.__parent);var b=this.__parent;this.__parent.off(null,null,this),this.__parent=null,b.removeChild(this)}a&&(this.__parent=a,a.addChild(this),this._bindParent(a),a.isActive()&&this.activate())}},_bindParent:function(){},_unbindParent:function(){},children:function(){var a={};return BetaJS.Objs.iter(this.__children,function(b,c){a[c]=b.view},this),a},childOptions:function(a){return this.__children[a.cid()].options},addChildren:function(a){BetaJS.Objs.iter(a,function(a){this.addChild(a)},this)},addChild:function(a,b){return this.hasChild(a)?null:(b=b||{},this.__children[a.cid()]={view:a,options:b},this._notify("addChild",a,b),a.setParent(this),this.isActive()&&this.isVisible()&&this.trigger("resize"),a)},removeChildren:function(a){BetaJS.Objs.iter(a,function(a){this.removeChild(a)},this)},removeChild:function(a){this.hasChild(a)&&(delete this.__children[a.cid()],a.setParent(null),a.off(null,null,this),this._notify("removeChild",a),this.isActive()&&this.isVisible()&&this.trigger("resize"))},width:function(){return this.$el.width()},innerWidth:function(){return this.$el.innerWidth()},outerWidth:function(){return this.$el.outerWidth()},height:function(){return this.$el.height()},innerHeight:function(){return this.$el.innerHeight()},outerHeight:function(){return this.$el.outerHeight()}}],{parseType:function(a,b){if(BetaJS.Types.is_defined(a)&&BetaJS.Types.is_string(a)){if(a=a.replace(/\s+/g,""),"int"==b)return parseInt(a,10);
if("array"==b)return a.split(",");if("bool"==b)return""===a||BetaJS.Strings.parseBool(a);if("object"==b||"function"==b)return BetaJS.Scopes.resolve(a)}return a}}),BetaJS.Views.BIND_EVENT_SPLITTER=/^(\S+)\s*(.*)$/,BetaJS.Class.extend("BetaJS.Views.DynamicTemplate",{constructor:function(a,b){this._inherited(BetaJS.Views.DynamicTemplate,"constructor"),this.__parent=a,this.__template=new BetaJS.Templates.Template(b),this.__instances={},this.__instances_by_name={}},reset:function(){BetaJS.Objs.iter(this.__instances,function(a){this.removeInstance(a)},this)},destroy:function(){this.reset(),this._inherited(BetaJS.Views.DynamicTemplate,"destroy")},renderInstance:function(a,b){b=b||{},b.name&&this.removeInstanceByName(b.name);var c=new BetaJS.Views.DynamicTemplateInstance(this,a,b);this.__instances[c.cid()]=c,b.name&&(this.__instances_by_name[name]=c)},removeInstanceByName:function(a){a in this.__instances_by_name&&this.removeInstance(this.__instances_by_name[a])},removeInstance:function(a){delete this.__instances[a.cid()],delete this.__instances_by_name[a.name()],a.destroy()},view:function(){return this.__parent},template:function(){return this.__template}}),BetaJS.Class.extend("BetaJS.Views.DynamicTemplateInstance",[BetaJS.Events.ListenMixin,{__bind:{attr:function(a,b){return this.__context.__bind_attribute(a,b)},attrs:function(a){var b="";for(attribute in a)b+=this.attr(attribute,a[attribute])+" ";return b},value:function(a){return this.__context.__bind_value(a)},inner:function(a){return this.__context.__bind_inner(a)},css_if:function(a,b){return this.__context.__bind_css_if(a,b,!0)},css_if_not:function(a,b){return this.__context.__bind_css_if(a,b,!1)}},__new_element:function(a){var b=BetaJS.Ids.uniqueId();return this.__elements[b]=BetaJS.Objs.extend({id:b,$el:null},a),this.__elements[b]},__decompose_variable:function(a){var b=a.split(".");return{object:1==b.length?this.__parent.view():this.__args[b[0]],key:1==b.length?a:b[1]}},__get_variable:function(a){var b=this.__decompose_variable(a);return b.object.get(b.key)},__set_variable:function(a,b){var c=this.__decompose_variable(a);return c.object.set(c.key,b)},__update_element:function(a){var b=this.__get_variable(a.variable);"inner"==a.type?a.$el.html(b):"value"==a.type?a.$el.val()!=b&&a.$el.val(b):"attribute"==a.type?a.$el.attr(a.attribute,b):"css"==a.type&&(a.positive||(b=!b),b?a.$el.addClass(this.__parent.view().css(a.css)):a.$el.removeClass(this.__parent.view().css(a.css)))},__prepare_element:function(a){var b=this;a.$el=this.$el.find(a.selector),"inner"==a.type||"css"==a.type?this.__update_element(a):"value"==a.type&&a.$el.on("change input keyup paste",function(){b.__set_variable(a.variable,a.$el.val())})},__bind_attribute:function(a,b){var c=this.__new_element({type:"attribute",attribute:a,variable:b}),d="data-bind-"+a+"='"+c.id+"'";c.selector="["+d+"]";var e=this.__decompose_variable(b);return this.listenOn(e.object,"change:"+e.key,function(){this.__update_element(c)},this),d+" "+a+"='"+e.object.get(e.key)+"'"},__bind_css_if:function(a,b,c){var d=this.__new_element({type:"css",css:a,variable:b,positive:c}),e="data-bind-css-"+a+"='"+d.id+"'";d.selector="["+e+"]";var f=this.__decompose_variable(b);return this.listenOn(f.object,"change:"+f.key,function(){this.__update_element(d)},this),e},__bind_value:function(a){var b=this.__new_element({type:"value",variable:a}),c="data-bind-value='"+b.id+"'";b.selector="["+c+"]";var d=this.__decompose_variable(a);return this.listenOn(d.object,"change:"+d.key,function(){this.__update_element(b)},this),c+" value='"+d.object.get(d.key)+"'"},__bind_inner:function(a){var b=this.__new_element({type:"inner",variable:a}),c="data-bind-inner='"+b.id+"'";b.selector="["+c+"]";var d=this.__decompose_variable(a);return this.listenOn(d.object,"change:"+d.key,function(){this.__update_element(b)},this),c},constructor:function(a,b,c){this._inherited(BetaJS.Views.DynamicTemplateInstance,"constructor"),this.__elements={},this.__inners={},c=c||{},c.name&&(this.__name=name),this.__parent=a,this.$el=b,this.__args=BetaJS.Objs.extend(c.args||{},this.__parent.view().templateArguments()),this.__args.bind=BetaJS.Objs.extend({__context:this},this.__bind),this.$el.html(a.template().evaluate(this.__args)),BetaJS.Objs.iter(this.__elements,function(a){this.__prepare_element(a)},this)},destroy:function(){BetaJS.Objs.iter(this.__elements,function(a){a.$el.off()},this),this._inherited(BetaJS.Views.DynamicTemplateInstance,"destroy")},name:function(){return this.__name}}]),BetaJS.Views.ActiveDom={__prefix_alias:["bjs","betajs"],__view_alias:{},__views:{},__active:!1,__on_add_element:function(a){var b=BetaJS.$(a.target);if(b){var c=!1;b.prop("tagName")&&(BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__prefix_alias,function(a){b.prop("tagName").toLowerCase()==a+"view"&&(BetaJS.Views.ActiveDom.__attach(b),c=!0)}),BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__view_alias,function(a,d){b.prop("tagName").toLowerCase()==d&&(BetaJS.Views.ActiveDom.__attach(b,a),c=!0)})),c||(BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__prefix_alias,function(a){b.find(a+"view").each(function(){BetaJS.Views.ActiveDom.__attach(BetaJS.$(this))})}),BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__view_alias,function(a,c){b.find(c).each(function(){BetaJS.Views.ActiveDom.__attach(BetaJS.$(this),a)})}))}},__on_remove_element:function(a){var b=BetaJS.$(a.target);b.attr("data-active-dom-id")in BetaJS.Views.ActiveDom.__views?BetaJS.Views.ActiveDom.__views[b.attr("data-active-dom-id")].destroy():b.find("[data-active-dom-id]").each(function(){var a=BetaJS.$(this);a.attr("data-active-dom-id")in BetaJS.Views.ActiveDom.__views&&BetaJS.Views.ActiveDom.__views[a.attr("data-active-dom-id")].destroy()})},__attach:function(a,b){if(!a.attr("data-active-dom-element")){var c=function(a,c){for(var d=0;d<BetaJS.Views.ActiveDom.__prefix_alias.length;){var i=BetaJS.Views.ActiveDom.__prefix_alias[d];if(BetaJS.Strings.starts_with(a,i+"-"))return a=BetaJS.Strings.strip_start(a,i+"-"),void(BetaJS.Strings.starts_with(a,"child-")?(a=BetaJS.Strings.strip_start(a,"child-"),f[a]=c):a in h?b[a]=c:g[a]=c);++d}e[a]=c},d=function(a){var b=a.find("script[type='text/param']");return BetaJS.Strings.nltrim(b.length>0?b.html():a.html())},e={},f={},g={},h={type:"View","default":null,name:null,"keep-tag":!0};b=BetaJS.Objs.extend(BetaJS.Objs.clone(h,1),b||{});for(var i=a.get(0).attributes,j=0;j<i.length;++j)c(i.item(j).nodeName,i.item(j).nodeValue);BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__prefix_alias,function(b){a.children(b+"param").each(function(){var a=BetaJS.$(this);c(b+"-"+a.attr(b+"-key"),d(a))})}),b["default"]&&(g[b["default"]]=d(a)),b.type in BetaJS.Views&&(b.type=BetaJS.Views[b.type]),BetaJS.Types.is_string(b.type)&&(b.type=BetaJS.Scopes.resolve(b.type));var k=new b.type(g);k.setEl("[data-active-dom-id='"+k.cid()+"']");var l="<div data-active-dom-id='"+k.cid()+"'></div>";b["keep-tag"]&&(l="<"+a.prop("tagName")+" data-active-dom-element='"+k.cid()+"'>"+l+"</"+a.prop("tagName")+">"),a.replaceWith(l),a=BetaJS.$("[data-active-dom-id='"+k.cid()+"']");var m=null;for(m in e)a.attr(m,e[m]);k.on("destroy",function(){delete BetaJS.Views.ActiveDom.__views[k.cid()]}),BetaJS.Views.ActiveDom.__views[k.cid()]=k,k.activate();for(m in f)a.children().attr(m,f[m]);b.name&&BetaJS.Scopes.set(k,b.name)}},activate:function(){BetaJS.$(document).ready(function(){BetaJS.Views.ActiveDom.__active||(document.addEventListener?(document.addEventListener("DOMNodeInserted",BetaJS.Views.ActiveDom.__on_add_element),document.addEventListener("DOMNodeRemoved",BetaJS.Views.ActiveDom.__on_remove_element)):(document.attachEvent("DOMNodeInserted",BetaJS.Views.ActiveDom.__on_add_element),document.attachEvent("DOMNodeRemoved",BetaJS.Views.ActiveDom.__on_remove_element)),BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__prefix_alias,function(a){BetaJS.$(a+"view").each(function(){BetaJS.Views.ActiveDom.__attach(BetaJS.$(this))})}),BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__view_alias,function(a,b){BetaJS.$(b).each(function(){BetaJS.Views.ActiveDom.__attach(BetaJS.$(this),a)})}),BetaJS.Views.ActiveDom.__active=!0)})},deactivate:function(){BetaJS.$(document).ready(function(){BetaJS.Views.ActiveDom.__active&&(document.removeEventListener("DOMNodeInserted",BetaJS.Views.ActiveDom.__on_add_element),document.removeEventListener("DOMNodeRemoved",BetaJS.Views.ActiveDom.__on_remove_element),BetaJS.Objs.iter(BetaJS.Views.ActiveDom.__views,function(a){a.destroy()}),BetaJS.Views.ActiveDom.__active=!1)})},registerPrefixAlias:function(a){this.__prefix_alias.push(a)},registerViewAlias:function(a,b,c){this.__view_alias[a]={type:b},this.__view_alias[a]["default"]=c}},BetaJS.Classes.Module.extend("BetaJS.Views.Modules.Centering",{constructor:function(a){this._inherited(BetaJS.Views.Modules.Centering,"constructor",a),this.__vertical="vertical"in a?a.vertical:!1,this.__horizontal="horizontal"in a?a.horizontal:!1},_register:function(a){a.on("resize",function(){a.isVisible()&&this.__update(a)},this),a.isActive()&&a.isVisible()&&this.__update(a)},__update:function(a){this.__vertical&&(a.$el.css("top","50%"),a.$el.css("margin-top",Math.round(-a.$el.height()/2)+"px")),this.__horizontal&&(a.$el.css("left","50%"),a.$el.css("margin-left",Math.round(-a.$el.width()/2)+"px"))}},{__vertical:null,vertical:function(){return this.__vertical||(this.__vertical=new this({auto_destroy:!1,vertical:!0,horizontal:!1})),this.__vertical},__horizontal:null,horizontal:function(){return this.__horizontal||(this.__horizontal=new this({auto_destroy:!1,horizontal:!0,vertical:!1})),this.__horizontal},__both:null,both:function(){return this.__both||(this.__both=new this({auto_destroy:!1,vertical:!0,horizontal:!0})),this.__both}}),BetaJS.Classes.Module.extend("BetaJS.Views.Modules.BindOnActivate",{_register:function(a,b){b.bound=!1,a.on("activate",function(){this.__bind(a)},this),a.on("deactivate",function(){this.__unbind(a)},this),a.isActive()&&this.__bind(a)},_unregister:function(a){this.__unbind(a)},__bind:function(a){var b=this._data(a);b.bound||(this._bind(a,b),b.bound=!0)},__unbind:function(a){var b=this._data(a);b.bound&&(this._unbind(a,b),b.bound=!1)},_bind:function(){},_unbind:function(){}}),BetaJS.Classes.Module.extend("BetaJS.Views.Modules.BindOnVisible",{_register:function(a,b){b.bound=!1,a.on("visibility",function(b){b?this.__bind(a):this.__unbind(a)},this),a.isActive()&&a.isVisible()&&this.__bind(a)},_unregister:function(a){this.__unbind(a)},__bind:function(a){var b=this._data(a);b.bound||(this._bind(a,b),b.bound=!0)},__unbind:function(a){var b=this._data(a);b.bound&&(this._unbind(a,b),b.bound=!1)},_bind:function(){},_unbind:function(){}}),BetaJS.Views.Modules.BindOnVisible.extend("BetaJS.Views.Modules.HideOnLeave",{_bind:function(a,b){var c=a.$el.get(0);b.hide_on_leave_func=function(d){return b.hide_on_leave_skip?void(b.hide_on_leave_skip=!1):void(document.contains(d.target)&&d.target!==c&&!BetaJS.$.contains(c,d.target)&&a.hide())},b.hide_on_leave_skip=!0,BetaJS.$(document.body).on("click",b.hide_on_leave_func)},_unbind:function(a,b){BetaJS.$(document.body).unbind("click",b.hide_on_leave_func)}}),BetaJS.Views.Modules.BindOnActivate.extend("BetaJS.Views.Modules.Hotkeys",{constructor:function(a){this._inherited(BetaJS.Views.Modules.Hotkeys,"constructor",a),this.__hotkeys=a.hotkeys},_bind:function(a,b){b.hotkeys={},BetaJS.Objs.iter(this.__hotkeys,function(c,d){b.hotkeys[d]=BetaJS.Browser.Hotkeys.register(d,BetaJS.Types.is_function(c)?c:a[c],a)},this)},_unbind:function(a,b){BetaJS.Objs.iter(b.hotkeys,function(a){BetaJS.Browser.Hotkeys.unregister(a)},this),b.hotkeys={}}}),BetaJS.Templates.Cached=BetaJS.Templates.Cached||{},BetaJS.Templates.Cached["holygrail-view-template"]="  <div data-selector=\"right\" class='holygrail-view-right-container'></div>  <div data-selector=\"left\" class='holygrail-view-left-container'></div>  <div data-selector=\"center\" class='holygrail-view-center-container'></div> ",BetaJS.Templates.Cached["list-container-view-item-template"]='  <{%= container_element %} data-view-id="{%= cid %}"></{%= container_element %}> ',BetaJS.Templates.Cached["switch-container-view-item-template"]='  <div data-view-id="{%= cid %}" data-selector="switch-container-item"></div> ',BetaJS.Templates.Cached["button-view-template"]='   <{%= button_container_element %} data-selector="button-inner" class="{%= supp.css("default") %}"    {%= bind.css_if("disabled", "disabled") %}    {%= bind.css_if("selected", "selected") %}    {%= bind.inner("label") %}>   </{%= button_container_element %}>  ',BetaJS.Templates.Cached["check-box-view-template"]='  <input type="checkbox" {%= checked ? "checked" : "" %} id="check-{%= supp.view_id %}" />  <label for="check-{%= supp.view_id %}">{%= label %}</label> ',BetaJS.Templates.Cached["input-view-template"]='  <input class="input-view" type="{%= input_type %}" {%= bind.value("value") %} {%= bind.attr("placeholder", "placeholder") %} {%= bind.css_if("input-horizontal-fill", "horizontal_fill") %} /> ',BetaJS.Templates.Cached["label-view-template"]='  <{%= element %} class="{%= supp.css(\'label\') %}" {%= bind.inner("label") %}></{%= element %}> ',BetaJS.Templates.Cached["link-view-template"]='  <a href="javascript:{}" {%= bind.inner("label") %}></a> ',BetaJS.Templates.Cached["text-area-template"]='   <textarea {%= bind.value("value") %} {%= bind.attr("placeholder", "placeholder") %}             {%= bind.css_if_not("text-area-no-resize", "resizable") %}             {%= readonly ? \'readonly\' : \'\' %}             style="resize: {%= horizontal_resize ? (vertical_resize ? \'both\' : \'horizontal\') : (vertical_resize ? \'vertical\' : \'none\') %}"             {%= bind.css_if("text-area-horizontal-fill", "horizontal_fill") %}></textarea>  ',BetaJS.Templates.Cached["progress-template"]='  <div class="{%= supp.css(\'outer\') %}">   <div data-selector="inner" class="{%= supp.css(\'inner\') %}" style="{%= horizontal ? \'width\': \'height\' %}:{%= value*100 %}%">   </div>   <div class="progress-view-overlay" data-selector="label">    {%= label %}   </div>  </div> ',BetaJS.Templates.Cached["list-view-template"]='   <{%= list_container_element %}    {%= supp.attrs(list_container_attrs) %}    class="{%= list_container_classes %}"    data-selector="list">   </{%= list_container_element %}>  ',BetaJS.Templates.Cached["list-view-item-container-template"]='   <{%= item_container_element %}    {%= supp.attrs(item_container_attrs) %}    class="{%= item_container_classes %}"    {%= supp.list_item_attr(item) %}>   </{%= item_container_element %}>  ',BetaJS.Templates.Cached["overlay-view-template"]='  <div data-selector="container"></div> ',BetaJS.Templates.Cached["fullscreen-overlay-view-template"]='  <div class="fullscreen-overlay-background" data-selector="outer"></div>  <div class="fullscreen-overlay" data-selector="inner"></div> ',BetaJS.Views.View.extend("BetaJS.Views.HolygrailView",{_templates:{"default":BetaJS.Templates.Cached["holygrail-view-template"]},constructor:function(a){this._inherited(BetaJS.Views.HolygrailView,"constructor",a),this.__left=null,this.__center=null,this.__right=null},getLeft:function(){return this.__left},setLeft:function(a){return this.__setView("left",a)},getCenter:function(){return this.__center},setCenter:function(a){return this.__setView("center",a)},getRight:function(){return this.__right},setRight:function(a){return this.__setView("right",a)},__setView:function(a,b){return this.removeChild(this["__"+a]),this["__"+a]=null,b&&(b.setEl('[data-selector="'+a+'"]'),this["__"+a]=this.addChild(b)),b}}),BetaJS.Views.View.extend("BetaJS.Views.ListContainerView",{_templates:{item:BetaJS.Templates.Cached["list-container-view-item-template"]},_notifications:{addChild:"__addChildContainer",removeChild:"__removeChildContainer"},constructor:function(a){a=a||{},this._inherited(BetaJS.Views.ListContainerView,"constructor",a),this._setOption(a,"alignment","horizontal"),this._setOption(a,"positioning","float"),this._setOption(a,"clear_float",!1),this._setOption(a,"container_element","div"),this.on("show",function(){"computed"==this.__positioning&&this.__updatePositioning()},this)},isHorizontal:function(){return"horizontal"==this.__alignment},_render:function(){this.$el.html(this.__clear_float?"<div data-selector='clearboth' style='clear:both'></div>":""),BetaJS.Objs.iter(this.children(),function(a){this.__addChildContainer(a)},this)},__addChildContainer:function(a){var b=this.childOptions(a);if(this.isActive()){var c=this.evaluateTemplate("item",{cid:a.cid(),container_element:this.__container_element});this.__clear_float?this.$("[data-selector='clearboth']").before(c):this.$el.append(c)}if(a.setEl("[data-view-id='"+a.cid()+"']"),!this.isHorizontal()||"float"in b||"float"!=this.__positioning||(b["float"]="left"),this.isActive()&&"float"in b&&"float"==this.__positioning){var d=this.$("[data-view-id='"+a.cid()+"']");d.css("float",b["float"])}},__removeChildContainer:function(a){this.$data({"view-id":a.cid()}).remove()},__updatePositioningHelper:function(a,b,c){var d=0;BetaJS.Objs.iter(a,function(a){var e=this.childOptions(a);return e.type&&"ignore"==e.type||(a.$el.css(b,d+"px"),a.isVisible()&&(d+=parseInt(a.$el.css(c),10)),!e.type||"dynamic"!=e.type)?void 0:!1},this)},__updatePositioning:function(){var a=BetaJS.Objs.values(this.children()),b=BetaJS.Objs.clone(a,1).reverse(),c=this.isHorizontal()?"left":"top",d=this.isHorizontal()?"right":"bottom",e=this.isHorizontal()?"width":"height";this.__updatePositioningHelper(b,d,e),this.__updatePositioningHelper(a,c,e)},updateChildVisibility:function(a){this._inherited(BetaJS.Views.ListContainerView,"updateChildVisibility",a),"computed"==this.__positioning&&this.__updatePositioning()}}),BetaJS.Views.View.extend("BetaJS.Views.SingleContainerView",{constructor:function(a){this._inherited(BetaJS.Views.SingleContainerView,"constructor",a),this.__view=null},getView:function(){return this.__view},setView:function(a){return this.removeChild(this.__view),a&&(a.setEl(""),this.__view=this.addChild(a)),a}}),BetaJS.Views.View.extend("BetaJS.Views.SwitchContainerView",{_templates:{item:BetaJS.Templates.Cached["switch-container-view-item-template"]},_notifications:{addChild:"__addChildContainer",removeChild:"__removeChildContainer"},constructor:function(a){this._inherited(BetaJS.Views.SwitchContainerView,"constructor",a),this.__selected=null},_render:function(){this.$el.html(""),BetaJS.Objs.iter(this.children(),function(a){this.__addChildContainer(a)},this)},__addChildContainer:function(a){this.isActive()&&this.$el.append(this.evaluateTemplate("item",{cid:a.cid()})),a.setEl("[data-view-id='"+a.cid()+"']"),this.__selected=this.__selected||a,a.setVisibility(this.__selected==a)},__removeChildContainer:function(a){this.$data({"view-id":a.cid()}).remove(),this.__selected==a&&(this.__selected=null)},select:function(a){this.__selected=a,BetaJS.Objs.iter(this.children(),function(a){a.setVisibility(this.__selected==a)},this)},selected:function(){return this.__selected}}),BetaJS.Views.ListContainerView.extend("BetaJS.Views.TabbedView",{constructor:function(a){a=BetaJS.Objs.extend(a||{},{alignment:"vertical",positioning:"none"}),this._inherited(BetaJS.Views.TabbedView,"constructor",a),this.toolbar=this.addChild(new BetaJS.Views.ToolBarView),this.container=this.addChild(new BetaJS.Views.SwitchContainerView),this.toolbar.on("item:click",function(a){this.select(a)},this),a.tabs&&BetaJS.Objs.iter(a.tabs,function(a){this.addTab(a)},this)},addTab:function(a){a=BetaJS.Objs.extend(a,{selectable:!0,deselect_all:!0});var b=this.toolbar.addItem(a);return b.__tabView=this.container.addChild(a.view),a.view.__tabButton=b,a.selected&&this.select(b),b.__tabView},select:function(a){var b=null;return b=BetaJS.Types.is_string(a)?this.toolbar.itemByIdent(a).__tabView:a.__tabButton?a:a.__tabView,this.container.select(b),b.__tabButton.select(),this.trigger("select",b),b}}),BetaJS.Views.View.extend("BetaJS.Views.ButtonView",{_dynamics:{"default":BetaJS.Templates.Cached["button-view-template"]},_css:function(){return{disabled:"","default":"",selected:""}},constructor:function(a){if(a=a||{},this._inherited(BetaJS.Views.ButtonView,"constructor",a),this._setOptionProperty(a,"label",""),this._setOptionProperty(a,"button_container_element","button"),this._setOptionProperty(a,"disabled",!1),this._setOptionProperty(a,"selected",!1),this._setOption(a,"selectable",!1),this._setOption(a,"deselect_all",!1),a.hotkey){var b={};b[a.hotkey]=function(){this.click()},this.add_module(new BetaJS.Views.Modules.Hotkeys({hotkeys:b}))}},_events:function(){return this._inherited(BetaJS.Views.ButtonView,"_events").concat([{"click [data-selector='button-inner']":"click"}])},click:function(){this.get("disabled")||(this.__selectable&&this.select(),this.trigger("click"))},_bindParent:function(a){a.on("deselect",function(){this.unselect()},this)},_unbindParent:function(a){a.off("deselect",this)},select:function(){this.__selectable&&(this.__deselect_all&&this.getParent().trigger("deselect"),this.getParent().trigger("select",this),this.set("selected",!0))},unselect:function(){this.__selectable&&this.set("selected",!1)},isSelected:function(){return this.get("selected")}}),BetaJS.Views.View.extend("BetaJS.Views.CheckBoxView",{_templates:{"default":BetaJS.Templates.Cached["check-box-view-template"]},_events:function(){return this._inherited(BetaJS.Views.ButtonView,"_events").concat([{"click input":"__click"}])},constructor:function(a){a=a||{},a.invalidate_on_change=!0,this._inherited(BetaJS.Views.CheckBoxView,"constructor",a),this._setOptionProperty(a,"checked",!1),this._setOptionProperty(a,"label","")},__click:function(){this.set("checked",this.$("input").is(":checked")),this.trigger("check",this.get("checked"))}}),BetaJS.Views.SwitchContainerView.extend("BetaJS.Views.InputLabelView",{constructor:function(a){this._inherited(BetaJS.Views.InputLabelView,"constructor",a),this._setOptionProperty(a,"value",""),this._setOptionProperty(a,"placeholder",""),this._setOption(a,"edit_on_click",!0),this._setOption(a,"label_mode",!0),this._setOption(a,"read_only",!1),this.label=this.addChild(new BetaJS.Views.LabelView({label:this.binding("value"),el_classes:a.label_el_classes,children_classes:a.label_children_classes})),this.input=this.addChild(new BetaJS.Views.InputView({value:this.binding("value"),placeholder:this.binding("placeholder")})),this.__label_mode||this.select(this.input),this.input.on("leave enter_key",function(){this.label_mode()},this),this.__edit_on_click&&this.label.on("click",function(){this.edit_mode()},this)},is_label_mode:function(){return this.__label_mode},is_edit_mode:function(){return!this.__label_mode},label_mode:function(){this.is_label_mode()||(this.__label_mode=!0,this.select(this.label))},edit_mode:function(){this.is_edit_mode()||this.__read_only||(this.__label_mode=!1,this.select(this.input),this.input.focus(!0))}}),BetaJS.Views.View.extend("BetaJS.Views.InputView",{_dynamics:{"default":BetaJS.Templates.Cached["input-view-template"]},_events:function(){return[{"blur input":"__leaveEvent","keyup input":"__changeEvent","change input":"__changeEvent","input input":"__changeEvent","paste input":"__changeEvent"},{"keyup input":"__keyupEvent"}]},constructor:function(a){this._inherited(BetaJS.Views.InputView,"constructor",a),this._setOptionProperty(a,"value",""),this._setOptionProperty(a,"placeholder",""),this._setOptionProperty(a,"clear_after_enter",!1),this._setOptionProperty(a,"horizontal_fill",!1),this._setOptionProperty(a,"input_type","text")},__keyupEvent:function(a){var b=a.keyCode||a.which;13==b&&(this.trigger("enter_key",this.get("value")),this.get("clear_after_enter")&&this.set("value",""))},__leaveEvent:function(){this.trigger("leave")},__changeEvent:function(){this.trigger("change",this.get("value"))},focus:function(a){this.$("input").focus(),this.$("input").focus(),a&&this.$("input").select()}}),BetaJS.Views.View.extend("BetaJS.Views.LabelView",{_dynamics:{"default":BetaJS.Templates.Cached["label-view-template"]},_css:function(){return{label:"label-view-class"}},_events:function(){return[{click:"__clickEvent"}]},constructor:function(a){this._inherited(BetaJS.Views.LabelView,"constructor",a),this._setOptionProperty(a,"label",""),this._setOptionProperty(a,"element","span")},__clickEvent:function(){this.trigger("click")}}),BetaJS.Views.View.extend("BetaJS.Views.LinkView",{_dynamics:{"default":BetaJS.Templates.Cached["link-view-template"]},constructor:function(a){this._inherited(BetaJS.Views.LinkView,"constructor",a),this._setOptionProperty(a,"label","")},_events:function(){return this._inherited(BetaJS.Views.LinkView,"_events").concat([{"click a":"__click"}])},__click:function(){this.trigger("click")}}),BetaJS.Views.View.extend("BetaJS.Views.ProgressView",{_templates:{"default":BetaJS.Templates.Cached["progress-template"]},_css:function(){return{outer:"",inner:""}},constructor:function(a){this._inherited(BetaJS.Views.ProgressView,"constructor",a),this._setOptionProperty(a,"label",""),this._setOptionProperty(a,"horizontal",!0),this._setOptionProperty(a,"value",1),this.on("change:value",function(a){this.isActive()&&this.$("[data-selector='inner']").css(this.get("horizontal")?"width":"height",100*a+"%")},this),this.on("change:label",function(a){this.isActive()&&this.$("[data-selector='label']").html(a)},this)}}),BetaJS.Views.View.extend("BetaJS.Views.TextAreaView",{_dynamics:{"default":BetaJS.Templates.Cached["text-area-template"]},constructor:function(a){this._inherited(BetaJS.Views.TextAreaView,"constructor",a),this._setOptionProperty(a,"value",""),this._setOptionProperty(a,"placeholder",""),this._setOptionProperty(a,"horizontal_resize",!1),this._setOptionProperty(a,"vertical_resize",!0),this._setOptionProperty(a,"horizontal_fill",!1),this._setOptionProperty(a,"readonly",!1),this.on("change:readonly",function(){this.get("readonly")?this.$("textarea").attr("readonly","readonly"):this.$("textarea").removeAttr("readonly")},this)},addLine:function(a){this.get("value")?this.set("value",this.get("value")+"\n"+a):this.set("value",a),this.scrollToEnd()},scrollToEnd:function(){var a=this.$("textarea").get(0);a.scrollTop=a.scrollHeight}}),BetaJS.Views.View.extend("BetaJS.Views.CustomListView",{_templates:function(){return{"default":BetaJS.Templates.Cached["list-view-template"],"item-container":BetaJS.Templates.Cached["list-view-item-container-template"]}},_supp:function(){return BetaJS.Objs.extend(this._inherited(BetaJS.Views.CustomListView,"_supp"),{list_item_attr:function(a){return this.attrs({"data-view-id":this.__context.cid(),"data-cid":BetaJS.Ids.objectId(a),"data-index":this.__context.__collection.getIndex(a)})}})},_notifications:{activate:"__activateItems",deactivate:"__deactivateItems"},_events:function(){return[{click:"__click"}]},constructor:function(a){if(this._inherited(BetaJS.Views.CustomListView,"constructor",a),this._setOption(a,"list_container_element","ul"),this._setOption(a,"list_container_attrs",{}),this._setOption(a,"list_container_classes",""),this._setOption(a,"item_container_element","li"),this._setOption(a,"item_container_classes",""),this._setOption(a,"selectable",!0),this._setOption(a,"multi_select",!1),this._setOption(a,"click_select",!1),this.__itemData={},"table"in a){var b=this.cls.parseType(a.table,"object");this.active_query=new BetaJS.Queries.ActiveQuery(b.active_query_engine(),{}),a.collection=this.active_query.collection(),a.destroy_collection=!0}if("compare"in a&&(a.compare=this.cls.parseType(a.compare,"function")),"collection"in a)this.__collection=a.collection,this.__destroy_collection="destroy_collection"in a?a.destroy_collection:!1,"compare"in a&&this.__collection.set_compare(a.compare);else{var c={};"objects"in a&&(c.objects=a.objects),"compare"in a&&(c.compare=a.compare),this.__collection=new BetaJS.Collections.Collection(c),this.__destroy_collection=!0}this.__collection.on("add",function(a){this._addItem(a)},this),this.__collection.on("remove",function(a){this._removeItem(a)},this),this.__collection.on("change",function(a){this._changeItem(a)},this),this.__collection.on("index",function(a,b){this.__updateItemIndex(a,b)},this),this.__collection.on("reindexed",function(a){this.__reIndexItem(a)},this),this.__collection.on("sorted",function(){this.__sort()},this),this.__collection.iterate(function(a){this._registerItem(a)},this)},destroy:function(){this.__collection.iterate(function(a){this._unregisterItem(a)},this),this.__collection.off(null,null,this),this.__destroy_collection&&this.__collection.destroy(),this._inherited(BetaJS.Views.CustomListView,"destroy")},_itemBySubElement:function(a){var b=a.closest("[data-view-id='"+this.cid()+"']");return 0===b.length?null:this.__collection.getById(b.attr("data-cid"))},__click:function(a){if(this.__click_select&&this.__selectable){var b=this._itemBySubElement(BetaJS.$(a.target));b&&this.select(b)}},collection:function(){return this.__collection},add:function(a){this.__collection.add(a)},remove:function(a){this.__collection.remove(a)},_render:function(){this.$selector_list=this._renderListContainer()},_renderListContainer:function(){return this.$el.html(this.evaluateTemplate("default",{list_container_element:this.__list_container_element,list_container_attrs:this.__list_container_attrs,list_container_classes:this.__list_container_classes})),this.$data({selector:"list"})},invalidate:function(){this.isActive()&&this.__deactivateItems(),this._inherited(BetaJS.Views.CustomListView,"invalidate"),this.isActive()&&this.__activateItems()},__activateItems:function(){this.__collection.iterate(function(a){this._activateItem(a)},this)},__deactivateItems:function(){this.__collection.iterate(function(a){this._deactivateItem(a)},this)},itemElement:function(a){return this.$data({"view-id":this.cid(),cid:BetaJS.Ids.objectId(a)},this.$selector_list)},_findIndexElement:function(a){return this.$data({"view-id":this.cid(),index:a},this.$selector_list)},_changeItem:function(){},__updateItemIndex:function(a,b){var c=this.itemElement(a);c.attr("data-index",b),this._updateItemIndex(a,c)},__reIndexItem:function(a){var b=this.itemElement(a),c=this.collection().getIndex(a);if(0===c)this.$selector_list.prepend(b);else{var d=this._findIndexElement(c-1);d.after(b)}},_updateItemIndex:function(){},__sort:function(){for(var a=this.collection().count()-1;a>=0;a--)this.$selector_list.prepend(this._findIndexElement(a))},itemData:function(a){return this.__itemData[a.cid()]},_registerItem:function(a){this.__itemData[a.cid()]={properties:new BetaJS.Properties.Properties({selected:!1,new_element:!1})}},_unregisterItem:function(a){this.__itemData[a.cid()]&&(this.__itemData[a.cid()].properties.destroy(),delete this.__itemData[a.cid()])},_activateItem:function(a){var b=this.evaluateTemplate("item-container",{item:a,item_container_element:this.__item_container_element,item_container_attrs:this.__item_container_attrs,item_container_classes:this.__item_container_classes}),c=this.__collection.getIndex(a);if(0===c)this.$selector_list.prepend(b);else{var d=this._findIndexElement(c-1);if(d.length>0)d.after(b);else{var e=this._findIndexElement(c+1);e.length>0?e.before(b):this.$selector_list.append(b)}}this.trigger("activate_item",a)},_deactivateItem:function(a){this.itemData(a).new_element=!1;var b=this.itemElement(a);b.remove()},_addItem:function(a){this._registerItem(a),this.isActive()&&(this.itemData(a).new_element=!0,this._activateItem(a))},_removeItem:function(a){this.isActive()&&this._deactivateItem(a),this._unregisterItem(a)},isSelected:function(a){return this.itemData(a).properties.get("selected")},select:function(a){var b=this.itemData(a);return this.__selectable&&!this.isSelected(a)&&(this.__multi_select||this.collection().iterate(function(a){this.unselect(a)},this),b.properties.set("selected",!0),this.trigger("select",a)),b},unselect:function(a){var b=this.itemData(a);return this.__selectable&&this.isSelected(a)&&(b.properties.set("selected",!1),this.trigger("unselect",a)),b}}),BetaJS.Views.CustomListView.extend("BetaJS.Views.ListView",{constructor:function(a){a=a||{},"item_template"in a&&(a.templates={item:a.item_template}),"item_dynamic"in a&&(a.dynamics={item:a.item_dynamic}),this._inherited(BetaJS.Views.ListView,"constructor",a),this._setOption(a,"item_label","label"),this._setOption(a,"render_item_on_change",BetaJS.Types.is_defined(this.dynamics("item")))
},_changeItem:function(a){this._inherited(BetaJS.Views.ListView,"_changeItem",a),this.__render_item_on_change&&this.isActive()&&this._renderItem(a)},_activateItem:function(a){this._inherited(BetaJS.Views.ListView,"_activateItem",a),this._renderItem(a)},_renderItem:function(a){var b=this.itemElement(a),c=this.itemData(a).properties;this.templates("item")?b.html(this.evaluateTemplate("item",{item:a,properties:c})):this.dynamics("item")?this.evaluateDynamics("item",b,{item:a,properties:c},{name:"item-"+BetaJS.Ids.objectId(a)}):b.html(a.get(this.__item_label))},_deactivateItem:function(a){this.dynamics("item")&&this.dynamics("item").removeInstanceByName("item-"+BetaJS.Ids.objectId(a)),this._inherited(BetaJS.Views.ListView,"_deactivateItem",a)}}),BetaJS.Views.CustomListView.extend("BetaJS.Views.SubViewListView",{_sub_view:BetaJS.Views.View,_sub_view_options:function(a){return{item:a,item_properties:this.itemData(a).properties}},_property_map:function(){},constructor:function(a){this._inherited(BetaJS.Views.SubViewListView,"constructor",a),"create_view"in a&&(this._create_view=a.create_view),"sub_view"in a&&(this._sub_view=this.cls.parseType(a.sub_view,"object")),"sub_view_options"in a&&(this._sub_view_options_param=a.sub_view_options),"property_map"in a&&(this._property_map_param=a.property_map)},_create_view:function(a){var b=BetaJS.Objs.extend(BetaJS.Types.is_function(this._property_map)?this._property_map.apply(this,[a]):this._property_map,BetaJS.Types.is_function(this._property_map_param)?this._property_map_param.apply(this,[a]):this._property_map_param),c=BetaJS.Objs.extend(BetaJS.Types.is_function(this._sub_view_options)?this._sub_view_options.apply(this,[a]):this._sub_view_options,BetaJS.Objs.extend(BetaJS.Types.is_function(this._sub_view_options_param)?this._sub_view_options_param.apply(this,[a]):this._sub_view_options_param||{},BetaJS.Objs.map(b,a.get,a)));return c.el=this.itemElement(a),new this._sub_view(c)},_activateItem:function(a){this._inherited(BetaJS.Views.SubViewListView,"_activateItem",a);var b=this._create_view(a);this.delegateEvents(null,b,"item",[b,a]),this.itemData(a).view=b,this.addChild(b)},_deactivateItem:function(a){var b=this.itemData(a).view;this.removeChild(b),b.destroy(),this._inherited(BetaJS.Views.SubViewListView,"_deactivateItem",a)}}),BetaJS.Classes.Module.extend("BetaJS.Views.Modules.ListViewAnimation",{_register:function(a){a.on("activate_item",function(b){if(a.itemData(b).new_element){var c=a.itemElement(b);c.css("display","none"),c.fadeIn()}},this)}},{__singleton:null,singleton:function(){return this.__singleton||(this.__singleton=new this({auto_destroy:!1})),this.__singleton}}),BetaJS.Views.View.extend("BetaJS.Views.OverlayView",{_templates:{"default":BetaJS.Templates.Cached["overlay-view-template"]},constructor:function(a){a=a||{},a.anchor=a.anchor||"absolute",a.visible="visible"in a?a.visible:!1,a.children_classes=a.children_classes||[],BetaJS.Types.is_string(a.children_classes)&&(a.children_classes=a.children_classes.split(" ")),a.children_classes.push("overlay-container-class"),this._inherited(BetaJS.Views.OverlayView,"constructor",a),this._setOption(a,"anchor","none"),this._setOption(a,"element",""),this._setOption(a,"overlay_left",0),this._setOption(a,"overlay_top",0),this._setOption(a,"overlay_align_vertical","top"),this._setOption(a,"overlay_align_horizontal","left"),this._setOption(a,"element_align_vertical","bottom"),this._setOption(a,"element_align_horizontal","left"),a.overlay_inner&&(a.overlay_inner.setEl('[data-selector="container"]'),this.overlay_inner=this.addChild(a.overlay_inner)),"hide_on_leave"in a&&!a.hide_on_leave||this.add_module(BetaJS.Views.Modules.HideOnLeave.singleton()),this.on("show",this._after_show,this)},_after_show:function(){if("none"!=this.__anchor){var a=this.$(".overlay-container-class"),b=a.outerWidth(),c=a.outerHeight(),d=this.__overlay_left,e=this.__overlay_top;"bottom"==this.__overlay_align_vertical?e-=c:"center"==this.__overlay_align_vertical&&(e-=Math.round(c/2)),"right"==this.__overlay_align_horizontal?d-=b:"center"==this.__overlay_align_horizontal&&(d-=Math.round(b/2));var f=this.$el;"element"==this.__anchor&&this.__element&&(f=this.__element,BetaJS.Types.is_string(f)?f=BetaJS.$(f):BetaJS.Class.is_class_instance(f)&&(f=f.$el)),("relative"==this.__anchor||"element"==this.__anchor)&&(element_width=f.outerWidth(),element_height=f.outerHeight(),d+=f.offset().left-$(window).scrollLeft(),e+=f.offset().top-$(window).scrollTop(),"bottom"==this.__element_align_vertical?e+=element_height:"center"==this.__element_align_vertical&&(e+=Math.round(element_height/2)),"right"==this.__element_align_horizontal?d+=element_width:"center"==this.__element_align_horizontal&&(d+=Math.round(element_width/2))),a.css("left",d+"px"),a.css("top",e+"px")}}}),BetaJS.Views.View.extend("BetaJS.Views.FullscreenOverlayView",{_templates:{"default":BetaJS.Templates.Cached["fullscreen-overlay-view-template"]},_events:function(){return[{'click [data-selector="outer"]':"__unfocus",'touchstart [data-selector="outer"]':"__unfocus"}]},constructor:function(a){a=a||{},a.el=a.el||"body",a.append_to_el="append_to_el"in a?a.append_to_el:!0,a.visible="visible"in a?a.visible:!1,this._inherited(BetaJS.Views.FullscreenOverlayView,"constructor",a),a.overlay_inner.setEl('[data-selector="inner"]'),this.overlay_inner=this.addChild(a.overlay_inner),this._setOption(a,"hide_on_unfocus",!0),this._setOption(a,"destroy_on_unfocus",!1),this.on("show",this._after_show,this),this.on("hide",this._after_hide,this)},_after_show:function(){var a=this.$('[data-selector="outer"]'),b=this.$('[data-selector="inner"]');b.removeClass("fullscreen-overlay-float"),b.removeClass("fullscreen-overlay-fit");var c=a.outerWidth(),d=a.outerHeight(),e=b.outerWidth(),f=b.outerHeight(),g=Math.floor((c-e)/2),h=Math.floor((d-f)/2);g>=0&&h>=0?(b.css("left",g+"px"),b.css("top",h+"px"),b.addClass("fullscreen-overlay-float")):(b.css("left","0px"),b.css("top","0px"),b.addClass("fullscreen-overlay-fit")),BetaJS.$("body").addClass("fullscreen-overlay-body")},_after_hide:function(){BetaJS.$("body").removeClass("fullscreen-overlay-body")},__unfocus:function(){this.__destroy_on_unfocus?this.destroy():this.__hide_on_unfocus&&this.hide()}}),BetaJS.Views.ListContainerView.extend("BetaJS.Views.FormControlView",{constructor:function(a){this._inherited(BetaJS.Views.FormControlView,"constructor",a),this._model=a.model,this._property=a.property,this._setOption(a,"validate_on_change",!1),this._setOption(a,"validate_on_show",!1),this._setOption(a,"error_classes",""),this.control_view=this.addChild(this._createControl(this._model,this._property,a.control_options||{})),this.label_view=this.addChild(new BetaJS.Views.LabelView(BetaJS.Objs.extend(a.label_options||{},{visible:!1}))),this.__validate_on_change&&this._model.on("change:"+this._property,this.validate,this),this.__validate_on_show&&this.on("show",this.validate,this),this._model.on("validate:"+this._property,this.validate,this)},validate:function(){if(this.isActive()){var a=this._model.validateAttr(this._property);this.label_view.setVisibility(!a),a?this.$el.removeClass(this.__error_classes):(this.$el.addClass(this.__error_classes),this.label_view.set("label",this._model.getError(this._property)))}},_createControl:function(){}}),BetaJS.Views.FormControlView.extend("BetaJS.Views.FormInputView",{_createControl:function(a,b,c){return new BetaJS.Views.InputView(BetaJS.Objs.extend(c,{value:a.binding(b)}))}}),BetaJS.Views.FormControlView.extend("BetaJS.Views.FormCheckBoxView",{_createControl:function(a,b,c){return new BetaJS.Views.CheckBoxView(BetaJS.Objs.extend(c,{checked:a.binding(b)}))}}),BetaJS.Views.ListContainerView.extend("BetaJS.Views.ToolBarView",{_css:function(){return{divider:"divider",group:"group"}},constructor:function(a){a=BetaJS.Objs.extend({clear_float:!0},a||{}),this._inherited(BetaJS.Views.ToolBarView,"constructor",a),this.__group_by_ident={},this.__item_by_ident={},a.groups&&BetaJS.Objs.iter(a.groups,function(a){this.addGroup(a)},this),a.items&&BetaJS.Objs.iter(a.items,function(a){this.addItem(a)},this)},__group_parent_options:BetaJS.Objs.objectify(["group_ident","group_type","group_options"]),addGroup:function(a){var b={group_type:"container"},c={};BetaJS.Objs.iter(a||{},function(a,d){d in this.__group_parent_options?b[d]=a:c[d]=a},this);var d=null;if("container"==b.group_type){if(c.el_classes=this.css("group"),d=this.addChild(new BetaJS.Views.ListContainerView(c),b),b.group_ident){if(b.group_ident in this.__group_by_ident)throw"Group identifier already registered: "+b.group_ident;this.__group_by_ident[b.group_ident]=d}return d}if("divider"!=b.group_type)throw"Unknown group type: "+b.group_type;return c.el_classes=this.css("divider"),d=this.addChild(new BetaJS.Views.View(c),b)},__item_parent_options:BetaJS.Objs.objectify(["item_ident","item_type","item_group"]),addItem:function(a){var b={item_type:"ButtonView"},c={};BetaJS.Objs.iter(a||{},function(a,d){d in this.__item_parent_options?b[d]=a:c[d]=a},this),b.item_type in BetaJS.Views&&(b.item_type=BetaJS.Views[b.item_type]),BetaJS.Types.is_string(b.item_type)&&(b.item_type=BetaJS.Scopes.resolve(b.item_type));var d=this;if(b.item_group){if(!(b.item_group in this.__group_by_ident))throw"Unknown group identifier: "+b.item_group;d=this.__group_by_ident[b.item_group];var e=this.childOptions(d);c=BetaJS.Objs.extend(e.group_options||{},c)}var f=d.addChild(new b.item_type(c),b);if(this.delegateEvents(null,f,"item",[f,b]),b.item_ident&&this.delegateEvents(null,f,"item-"+b.item_ident,[f,b]),b.item_ident){if(b.item_ident in this.__item_by_ident)throw"Item identifier already registered: "+b.item_ident;this.__item_by_ident[b.item_ident]=f}return f},itemByIdent:function(a){return this.__item_by_ident[a]}});