/*! betajs - v0.0.1 - 2013-03-14, Copyright (c) Oliver Friedmann & Victor Lingenthal, MIT Software License. */BetaJS.Views=BetaJS.Views||{},BetaJS.Views.View=BetaJS.Class.extend("View",[BetaJS.Events.EventsMixin,BetaJS.Ids.ClientIdMixin,{_events:function(){return[]},_render:function(){this.$el.html(this.__render_string)},_setOption:function(t,e,i,n){var n=n?n:"__";this[n+e]=e in t?t[e]:i},constructor:function(t){this._inherited(BetaJS.Views.View,"constructor"),this._setOption(t,"el",null),this._setOption(t,"visible",!0),this._setOption(t,"attributes",{}),this._setOption(t,"render_string",""),this._setOption(t,"events",[]),this.__old_attributes={},this.__parent=null,this.__children={},this.__active=!1,this.$el=null,this.__events=this._events().concat(this.__events)},isActive:function(){return this.__active},activate:function(){if(this.isActive())return!0;if(!this.__el)return!1;if(this.__parent&&!this.__parent.isActive())return!1;if(this.$el=this.__parent?this.__parent.$(this.__el):$(this.__el),0==this.$el.size()&&(this.$el=null),!this.$el)return!1;this.__old_attributes={};for(var t in this.__attributes){var e=this.$el.attr(t);this.__old_attributes[t]=BetaJS.Types.is_defined(e)?e:null,this.$el.attr(t,this.__attributes[t])}return this.__bind(),this.$el.css("display",this.__visible?"":"none"),this.__active=!0,this.__render(),BetaJS.Objs.iter(this.__children,function(t){t.activate()}),!0},deactivate:function(){if(!this.isActive())return!1;BetaJS.Objs.iter(this.__children,function(t){t.deactivate()}),this.__active=!1,this.__unbind(),this.$el.html("");for(var t in this.__old_attributes)this.$el.attr(t,this.__old_attributes[t]);return this.$el=null,!0},$:function(t){return this.$el.find(t)},destroy:function(){this.deactivate(),BetaJS.Objs.iter(this.__children,function(t){t.destroy()}),this._inherited(BetaJS.Views.View,"destroy")},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},setVisibility:function(t){t!=this.__visible&&(this.__visible=t,this.__running&&this.$el.css("display",this.__visible?"":"none"))},__bind:function(){var t=this;this.__unbind(),BetaJS.Objs.iter(this.__events,function(e){BetaJS.Objs.iter(e,function(e,i){var n=t[e],s=i.match(BetaJS.Views.BIND_EVENT_SPLITTER),r=s[1],_=s[2];r=r+".events"+t.cid();var a=BetaJS.Functions.as_method(n,t);""===_?t.$el.on(r,a):t.$el.on(r,_,a)})})},__unbind:function(){this.$el.off(".events"+this.cid())},__render:function(){this.isActive()&&this._render()},invalidate:function(){this.isActive()&&(BetaJS.Objs.iter(this.__children,function(t){t.deactivate()}),this.__render(),BetaJS.Objs.iter(this.__children,function(t){t.activate()}))},getParent:function(){return this.__parent},hasChild:function(t){return t.cid()in this.__children},setParent:function(t){if(t!=this.__parent){if(this.deactivate(),this.__parent){var e=this.__parent;this.__parent=null,e.removeChild(this)}t&&(this.__parent=t,t.addChild(this),t.isActive()&&this.activate())}},addChild:function(t){this.hasChild(t)||(this.__children[t.cid()]=t,t.setParent(this))},removeChild:function(t){this.hasChild(t)&&(delete this.__children[t.cid()],t.setParent(null))}}]),BetaJS.Views.BIND_EVENT_SPLITTER=/^(\S+)\s*(.*)$/;