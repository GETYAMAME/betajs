/*! betajs - v0.0.2 - 2013-11-11, Copyright (c) Oliver Friedmann & Victor Lingenthal, MIT Software License. */BetaJS.Class.extend("BetaJS.Browser.AbstractAjax",{constructor:function(a){this._inherited(BetaJS.Browser.AbstractAjax,"constructor"),this.__options=BetaJS.Objs.extend({method:"GET",data:{}},a)},syncCall:function(a){var b=BetaJS.Objs.clone(this.__options,1);b=BetaJS.Objs.extend(b,a);var c=b.success_callback;delete b.success_callback;var d=b.failure_callback;delete b.failure_callback;var e=b.complete_callback;delete b.complete_callback;try{var f=this._syncCall(b);return c&&c(f),e&&e(),f}catch(g){if(g=BetaJS.Exceptions.ensure(g),g.assert(BetaJS.Browser.AjaxException),!d)throw g;d(g.status_code(),g.status_text(),g.data())}},asyncCall:function(a){var b=BetaJS.Objs.clone(this.__options,1);b=BetaJS.Objs.extend(b,a);var c=b.success_callback;delete b.success_callback;var d=b.failure_callback;delete b.failure_callback;var e=b.complete_callback;delete b.complete_callback;try{var f=this._asyncCall(BetaJS.Objs.extend({success:function(a){c&&c(a),e&&e()},failure:function(a,b,c){if(!d)throw new BetaJS.Browser.AjaxException(a,b,c);d(a,b,c),e&&e()}},b));return f}catch(g){if(g=BetaJS.Exceptions.ensure(g),g.assert(BetaJS.Browser.AjaxException),!d)throw g;d(g.status_code(),g.status_text(),g.data())}},call:function(a){if(!("async"in a))return!1;var b=a.async;return delete a.async,b?this.asyncCall(a):this.syncCall(a)},_syncCall:function(){},_asyncCall:function(){}}),BetaJS.Exceptions.Exception.extend("BetaJS.Browser.AjaxException",{constructor:function(a,b,c){this._inherited(BetaJS.Browser.AjaxException,"constructor",a+": "+b),this.__status_code=a,this.__status_text=b,this.__data=c},status_code:function(){return this.__status_code},status_text:function(){return this.__status_text},data:function(){return this.__data}}),BetaJS.Browser.AbstractAjax.extend("BetaJS.Browser.JQueryAjax",{_syncCall:function(a){var b;return BetaJS.$.ajax({type:a.method,async:!1,url:a.uri,dataType:a.decodeType?a.decodeType:null,data:a.encodeType&&"json"==a.encodeType?JSON.stringify(a.data):a.data,success:function(a){b=a},error:function(a,b,c){throw new BetaJS.Browser.AjaxException(a.status,c,JSON.parse(a.responseText))}}),b},_asyncCall:function(a){BetaJS.$.ajax({type:a.method,async:!0,url:a.uri,dataType:a.decodeType?a.decodeType:null,data:a.encodeType&&"json"==a.encodeType?JSON.stringify(a.data):a.data,success:function(b){a.success(b)},error:function(b,c,d){a.failure(b.status,d,JSON.parse(b.responseText))}})}}),BetaJS.Browser.Dom={traverseNext:function(a,b){return"get"in a&&(a=a.get(0)),a.firstChild&&!b?BetaJS.$(a.firstChild):a.parentNode?a.nextSibling?BetaJS.$(a.nextSibling):this.traverseNext(a.parentNode,!0):null},selectNode:function(a,b){var c=null,d=null;window.getSelection?(c=window.getSelection(),c.removeAllRanges(),d=document.createRange()):document.selection&&(c=document.selection,d=c.createRange()),b?(d.setStart(a,b),d.setEnd(a,b),c.addRange(d)):(d.selectNode(a),c.addRange(d))},selectionStartNode:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).startContainer):document.selection?BetaJS.$(document.selection.createRange().startContainer):null},selectedHtml:function(){return window.getSelection?window.getSelection().toString():document.selection?document.selection.createRange().htmlText:void 0},selectionAncestor:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).commonAncestorContainer):document.selection?BetaJS.$(document.selection.createRange().parentElement()):null},selectionOffset:function(){return window.getSelection?window.getSelection().getRangeAt(0).endOffset:document.selection?document.selection.createRange().endOffset:null},selectionStart:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).startContainer):document.selection?BetaJS.$(document.selection.createRange().startContainer):null},selectionEnd:function(){return window.getSelection?BetaJS.$(window.getSelection().getRangeAt(0).endContainer):document.selection?BetaJS.$(document.selection.createRange().endContainer):null},selectionNodes:function(){var a=[],b=this.selectionStart(),c=this.selectionEnd();a.push(b);for(var d=b;d.get(0)!=c.get(0);)d=this.traverseNext(d),a.push(d);return a},selectionLeaves:function(){return BetaJS.Objs.filter(this.selectionNodes(),function(a){return 0==a.children().length})}},BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Hotkeys={SHIFT_NUMS:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',",":"<",".":">","/":"?","\\":"|"},SPECIAL_KEYS:{esc:27,escape:27,tab:9,space:32,"return":13,enter:13,backspace:8,scrolllock:145,scroll_lock:145,scroll:145,capslock:20,caps_lock:20,caps:20,numlock:144,num_lock:144,num:144,pause:19,"break":19,insert:45,home:36,"delete":46,end:35,pageup:33,page_up:33,pu:33,pagedown:34,page_down:34,pd:34,left:37,up:38,right:39,down:40,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},MODIFIERS:["ctrl","alt","shift","meta"],keyCodeToCharacter:function(a){return 188==a?",":190==a?".":String.fromCharCode(a).toLowerCase()},register:function(a,b,c,d){d=BetaJS.Objs.extend({type:"keyup",propagate:!1,disable_in_input:!1,target:document,keycode:!1},d),d.target=BetaJS.$(d.target);var e=a.toLowerCase().split("+"),f=function(a){if(d.disable_in_input){var f=a.target||a.srcElement||null;if(f&&3==f.nodeType&&(f=f.parentNode),f&&("INPUT"==f.tagName||"TEXTAREA"==f.tagName))return}var g=a.keyCode||a.which||0,h=BetaJS.Browser.Hotkeys.keyCodeToCharacter(g),i=0,j={};BetaJS.Objs.iter(BetaJS.Browser.Hotkeys.MODIFIERS,function(b){j[b]={pressed:a[b+"Key"],wanted:!1}},this),BetaJS.Objs.iter(e,function(b){b in j?(j[b].wanted=!0,i++):b.length>1?BetaJS.Browser.Hotkeys.SPECIAL_KEYS[b]==g&&i++:d.keycode?d.keycode==g&&i++:(h==b||a.shiftKey&&BetaJS.Browser.Hotkeys.SHIFT_NUMS[h]==b)&&i++},this),i==e.length&&BetaJS.Objs.all(j,function(a){return a.wanted==a.pressed})&&(b.apply(c||this),d.propagate||a.preventDefault())};return d.target.on(d.type,f),{target:d.target,type:d.type,func:f}},unregister:function(a){a.target.off(a.type,a.func)}},BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Info={getNavigator:function(){return{appCodeName:navigator.appCodeName,appName:navigator.appName,appVersion:navigator.appVersion,cookieEnabled:navigator.cookieEnabled,onLine:navigator.onLine,platform:navigator.platform,userAgent:navigator.userAgent}},__flash:null,__isiOS:null,__isAndroid:null,__iOSversion:null,__isWebOS:null,__isWindowsPhone:null,__isBlackberry:null,__isMobile:null,__isInternetExplorer:null,flash:function(){return this.__flash||(this.__flash=new BetaJS.Browser.FlashDetect),this.__flash},isiOS:function(){return null==this.__isiOS&&(this.__isiOS=-1!=navigator.userAgent.indexOf("iPhone")||-1!=navigator.userAgent.indexOf("iPod")||-1!=navigator.userAgent.indexOf("iPad")),this.__isiOS},isChrome:function(){return"chrome"in window},isAndroid:function(){return null==this.__isAndroid&&(this.__isAndroid=-1!=navigator.userAgent.toLowerCase().indexOf("android")),this.__isAndroid},isWebOS:function(){return null==this.__isWebOS&&(this.__isWebOS=-1!=navigator.userAgent.toLowerCase().indexOf("webos")),this.__isWebOS},isWindowsPhone:function(){return null==this.__isWindowsPhone&&(this.__isWindowsPhone=-1!=navigator.userAgent.toLowerCase().indexOf("windows phone")),this.__isWindowsPhone},isBlackberry:function(){return null==this.__isBlackberry&&(this.__isBlackberry=-1!=navigator.userAgent.toLowerCase().indexOf("blackberry")),this.__isBlackberry},iOSversion:function(){if(null==this.__iOSversion&&this.isiOS()){var a=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);this.__iOSversion={major:parseInt(a[1],10),minor:parseInt(a[2],10),revision:parseInt(a[3]||0,10)}}return this.__iOSversion},isMobile:function(){return null==this.__isMobile&&(this.__isMobile=this.isiOS()||this.isAndroid()||this.isWebOS()||this.isWindowsPhone()||this.isBlackberry()),this.__isMobile},isInternetExplorer:function(){return null==this.__isInternetExplorer&&(this.__isInternetExplorer="Microsoft Internet Explorer"==navigator.appName),this.__isInternetExplorer}},BetaJS.Class.extend("BetaJS.Browser.FlashDetect",{constructor:function(){if(this._inherited(BetaJS.Browser.FlashDetect,"constructor"),this.__version=null,navigator.plugins&&navigator.plugins.length>0){var a="application/x-shockwave-flash",b=navigator.mimeTypes;b&&b[a]&&b[a].enabledPlugin&&b[a].enabledPlugin.description&&(this.__version=this.parseVersion(b[a].enabledPlugin.description))}else if(-1==navigator.appVersion.indexOf("Mac")&&window.execScript)for(var c=0;c<this.__activeXDetectRules.length;c++)try{var d=new ActiveXObject(this.__activeXDetectRules[c].name),e=this.__activeXDetectRules[c].version(d);if(e){this.__version=this.parseActiveXVersion(e);break}}catch(f){}},parseVersion:function(a){var b=a.split(/ +/),c=b[2].split(/\./),d=b[3];return{raw:a,major:parseInt(c[0],10),minor:parseInt(c[1],10),revisionStr:d,revision:parseInt(d.replace(/[a-zA-Z]/g,""),10)}},parseActiveXVersion:function(a){var b=a.split(",");return{raw:a,major:parseInt(b[0].split(" ")[1],10),minor:parseInt(b[1],10),revision:parseInt(b[2],10),revisionStr:b[2]}},version:function(){return this.__version},installed:function(){return null!=this.__version},supported:function(){return this.installed()||!BetaJS.Browser.Info.is_iOS()},majorAtLeast:function(a){return this.installed()&&this.version().major>=a},minorAtLeast:function(a){return this.installed()&&this.version().minor>=a},revisionAtLeast:function(a){return this.installed()&&this.version().revision>=a},versionAtLeast:function(){if(!this.installed())return!1;var a=[this.version().major,this.version().minor,this.version().revision],b=Math.min(a.length,arguments.length);for(i=0;b>i;i++)if(a[i]!=arguments[i])return a[i]>arguments[i];return!0},__activeXDetectRules:[{name:"ShockwaveFlash.ShockwaveFlash.7",version:function(a){try{return a.GetVariable("$version")}catch(b){return null}}},{name:"ShockwaveFlash.ShockwaveFlash.6",version:function(a){try{a.AllowScriptAccess="always";try{return a.GetVariable("$version")}catch(b){return null}}catch(b){return"6,0,21"}}},{name:"ShockwaveFlash.ShockwaveFlash",version:function(a){try{return a.GetVariable("$version")}catch(b){return null}}}]}),BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Loader={loadScript:function(a,b,c){var d=!1,e=document.getElementsByTagName("head")[0],f=document.createElement("script");f.src=a,f.onload=f.onreadystatechange=function(){d||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(d=!0,f.onload=f.onreadystatechange=null,b&&b.apply(c||this,[a]))},e.appendChild(f)}},BetaJS.Browser=BetaJS.Browser||{},BetaJS.Browser.Router=BetaJS.Class.extend("BetaJS.Browser.Router",[BetaJS.Events.EventsMixin,{routes:[],constructor:function(a){this._inherited(BetaJS.Browser.Router,"constructor");var b=BetaJS.Types.is_function(this.routes)?this.routes():this.routes;BetaJS.Types.is_array(b)||(b=[b]),"routes"in a&&(BetaJS.Types.is_array(a.routes)?b=b.concat(a.routes):b.push(a.routes)),this.__routes=[],this.__paths={},this.__current=null,BetaJS.Objs.iter(b,function(a){BetaJS.Objs.iter(a,function(a,b){BetaJS.Types.is_string(a)&&(a={action:a}),a.key=b,a.route=new RegExp("^"+b+"$"),"applicable"in a?BetaJS.Types.is_array(a.applicable)||(a.applicable=[a.applicable]):a.applicable=[],"valid"in a?BetaJS.Types.is_array(a.valid)||(a.valid=[a.valid]):a.valid=[],"path"in a||(a.path=a.key),this.__routes.push(a),this.__paths[a.path]=a},this)},this),"actions"in a&&BetaJS.Objs.iter(a.actions,function(a,b){this[b]=a},this)},destroy:function(){this.__leave(),this._inherited(BetaJS.Browser.Router,"destroy")},parse:function(a){for(var b=0;b<this.__routes.length;++b){var c=this.__routes[b],d=c.route.exec(a);if(null!=d){d.shift(1);var e=!0;if(BetaJS.Objs.iter(c.applicable,function(a){var b=BetaJS.Types.is_string(a)?this[a]:a;e=e&&b.apply(this,d)},this),!e)continue;var f=!0;return BetaJS.Objs.iter(c.valid,function(a){var b=BetaJS.Types.is_string(a)?this[a]:a;f=f&&b.apply(this,d)},this),f?{object:c,params:d}:null}}return null},object:function(a){return this.__paths[a]},path:function(a){for(var b=this.object(a).key,c=Array.prototype.slice.apply(arguments,[1]),d=/\(.*?\)/;arg=c.shift();)b=b.replace(d,arg);return b},navigate:function(a){this.trigger("navigate",a);var b=this.parse(a);return null==b?(this.trigger("navigate-fail",a),!1):(this.trigger("navigate-success",b.object,b.params),this.invoke(b.object,b.params,a))},invoke:function(a,b,c){c=c||this.path(a.key,b),this.trigger("before_invoke",a,b,c),this.__enter(a,b,c),this.trigger("after_invoke",a,b,c);var d=this._invoke(a,b);return d},_invoke:function(a,b){var c=a.action;return BetaJS.Types.is_string(c)&&(c=this[c]),c.apply(this,b)},__leave:function(){null!=this.__current&&(this.trigger("leave",this.__current),this.__current.destroy(),this.__current=null)},__enter:function(a,b,c){this.__leave(),this.__current=new BetaJS.Events.Events,this.__current.route=c,this.__current.object=a,this.__current.params=b,this.trigger("enter",this.__current)},current:function(){return this.__current}}]),BetaJS.Class.extend("BetaJS.Browser.RouterHistory",[BetaJS.Events.EventsMixin,{constructor:function(a){this._inherited(BetaJS.Browser.RouterHistory,"constructor"),this.__router=a,this.__history=[],a.on("after_invoke",this.__after_invoke,this)},destroy:function(){this.__router.off(null,null,this),this._inherited(BetaJS.Browser.RouterHistory,"destroy")},__after_invoke:function(a,b){this.__history.push({object:a,params:b}),this.trigger("change")},last:function(a){return a=a||0,this.get(this.count()-1-a)},count:function(){return this.__history.length},get:function(a){return a=a||0,this.__history[a]},getRoute:function(a){var b=this.get(a);return this.__router.path(b.object.path,b.params)},back:function(a){if(!(this.count()<2)){for(a=a||0;a>=0&&this.count()>1;)this.__history.pop(),--a;var b=this.__history.pop();return this.trigger("change"),this.__router.invoke(b.object,b.params)}}}]),BetaJS.Class.extend("BetaJS.Browser.RouteBinder",{constructor:function(a){this._inherited(BetaJS.Browser.RouteBinder,"constructor"),this.__router=a,this.__router.on("after_invoke",function(a,b,c){this._getExternalRoute()!=c&&this._setExternalRoute(c)},this)},destroy:function(){this.__router.off(null,null,this),this._inherited(BetaJS.Browser.RouteBinder,"destroy")},current:function(){return this._getExternalRoute()},_setRoute:function(a){var b=this.__router.current();b&&b.route==a||this.__router.navigate(a)},_getExternalRoute:function(){return""},_setExternalRoute:function(){}}),BetaJS.Browser.RouteBinder.extend("BetaJS.Browser.HashRouteBinder",[BetaJS.Ids.ClientIdMixin,{constructor:function(a){this._inherited(BetaJS.Browser.HashRouteBinder,"constructor",a);var b=this;BetaJS.$(window).on("hashchange.events"+this.cid(),function(){b._setRoute(b._getExternalRoute())})},destroy:function(){BetaJS.$(window).off("hashchange.events"+this.cid()),this._inherited(BetaJS.Browser.HashRouteBinder,"destroy")},_getExternalRoute:function(){var a=window.location.hash;return a.length&&"#"==a[0]?a.slice(1):a},_setExternalRoute:function(a){window.location.hash="#"+a}}]),BetaJS.Browser.RouteBinder.extend("BetaJS.Browser.HistoryRouteBinder",[BetaJS.Ids.ClientIdMixin,{constructor:function(a){this._inherited(BetaJS.Browser.HistoryRouteBinder,"constructor",a);var b=this;this.__used=!1,BetaJS.$(window).on("popstate.events"+this.cid(),function(){b.__used&&b._setRoute(b._getExternalRoute())})},destroy:function(){BetaJS.$(window).off("popstate.events"+this.cid()),this._inherited(BetaJS.Browser.HistoryRouteBinder,"destroy")},_getExternalRoute:function(){return window.location.pathname},_setExternalRoute:function(a){window.history.pushState({},document.title,a),this.__used=!0}}],{supported:function(){return window.history&&window.history.pushState}}),BetaJS.Browser.RouteBinder.extend("BetaJS.Browser.LocationRouteBinder",{_getExternalRoute:function(){return window.location.pathname},_setExternalRoute:function(a){window.location.pathname=a}}),BetaJS.Stores.StoreException.extend("BetaJS.Stores.RemoteStoreException",{constructor:function(a){a=BetaJS.Browser.AjaxException.ensure(a),this._inherited(BetaJS.Stores.RemoteStoreException,"constructor",a.toString()),this.__source=a},source:function(){return this.__source}}),BetaJS.Stores.BaseStore.extend("BetaJS.Stores.RemoteStore",{constructor:function(a,b,c){this._inherited(BetaJS.Stores.RemoteStore,"constructor",c),this._uri=a,this.__ajax=b,this.__options=BetaJS.Objs.extend({update_method:"PUT",uri_mappings:{}},c||{})},_supports_async_write:function(){return!0},_supports_async_read:function(){return!1},getUri:function(){return this._uri},prepare_uri:function(a,b){return this.__options.uri_mappings[a]?this.__options.uri_mappings[a](b):"remove"==a||"get"==a||"update"==a?this.getUri()+"/"+b[this._id_key]:this.getUri()},_include_callbacks:function(a,b,c){return a.failure=function(a,c,d){b(new BetaJS.Stores.RemoteStoreException(new BetaJS.Browser.AjaxException(a,c,d)))},a.success=c,a},_insert:function(a,b){try{var c={method:"POST",uri:this.prepare_uri("insert",a),data:a};if(!this._async_write)return this.__ajax.syncCall(c);this.__ajax.asyncCall(this._include_callbacks(c,b.exception,b.success))}catch(d){throw new BetaJS.Stores.RemoteStoreException(d)}},_remove:function(a,b){try{var c={};c[this._id_key]=a;var d={method:"DELETE",uri:this.prepare_uri("remove",c)};if(!this._async_write){var e=this.__ajax.syncCall(d);return e||(e={},e[this._id_key]=a),e}var f=this;d=this._include_callbacks(d,b.exception,function(c){c||(c={},c[f._id_key]=a),b.success(c)}),this.__ajax.asyncCall(d)}catch(g){throw new BetaJS.Stores.RemoteStoreException(g)}},_get:function(a,b){var c={};c[this._id_key]=a;try{var d={uri:this.prepare_uri("get",c)};if(!this._async_read)return this.__ajax.syncCall(d);this.__ajax.asyncCall(this._include_callbacks(d,b.exception,b.success))}catch(e){throw new BetaJS.Stores.RemoteStoreException(e)}},_update:function(a,b,c){var d=BetaJS.Objs.clone(b,1);d[this._id_key]=a;try{var e={method:this.__options.update_method,uri:this.prepare_uri("update",d),data:b};if(!this._async_write)return this.__ajax.syncCall(e);this.__ajax.asyncCall(this._include_callbacks(e,c.exception,c.success))}catch(f){throw new BetaJS.Stores.RemoteStoreException(f)}},_query:function(a,b,c){try{var d=this._encode_query(a,b);if(!this._async_read){var e=this.__ajax.syncCall(d);return BetaJS.Types.is_string(e)?JSON.parse(e):e}d=this._include_callbacks(d,c.exception,function(){c.success(BetaJS.Types.is_string(e)?JSON.parse(e):e)}),this.__ajax.asyncCall(d)}catch(f){throw new BetaJS.Stores.RemoteStoreException(f)}},_encode_query:function(){return{uri:this.prepare_uri("query")}}}),BetaJS.Stores.RemoteStore.extend("BetaJS.Stores.QueryGetParamsRemoteStore",{constructor:function(a,b,c,d){this._inherited(BetaJS.Stores.QueryGetParamsRemoteStore,"constructor",a,b,d),this.__capability_params=c},_query_capabilities:function(){var a={};return"skip"in this.__capability_params&&(a.skip=!0),"limit"in this.__capability_params&&(a.limit=!0),a},_encode_query:function(a,b){b=b||{};var c=this.getUri()+"?";return b.skip&&"skip"in this.__capability_params&&(c+=this.__capability_params.skip+"="+b.skip+"&"),b.limit&&"limit"in this.__capability_params&&(c+=this.__capability_params.limit+"="+b.limit+"&"),{uri:c}}}),BetaJS.Templates={tokenize:function(a){if(BetaJS.Types.is_array(a))return a;var b=[],c=0;return a.replace(BetaJS.Templates.SYNTAX_REGEX(),function(d,e,f,g,h){return h>c&&b.push({type:BetaJS.Templates.TOKEN_STRING,data:BetaJS.Strings.js_escape(a.slice(c,h))}),g&&b.push({type:BetaJS.Templates.TOKEN_CODE,data:g}),e&&b.push({type:BetaJS.Templates.TOKEN_EXPR,data:e}),f&&b.push({type:BetaJS.Templates.TOKEN_ESC,data:f}),c=h+d.length,d}),b},compile:function(a,b){BetaJS.Types.is_string(a)&&(a=this.tokenize(a)),b=b||{};for(var c=b.start_index||0,d=b.end_index||a.length,e="__p+='",f=c;d>f;++f)switch(a[f].type){case BetaJS.Templates.TOKEN_STRING:e+=a[f].data;break;case BetaJS.Templates.TOKEN_CODE:e+="';\n"+a[f].data+"\n__p+='";break;case BetaJS.Templates.TOKEN_EXPR:e+="'+\n((__t=("+a[f].data+"))==null?'':__t)+\n'";break;case BetaJS.Templates.TOKEN_ESC:e+="'+\n((__t=("+a[f].data+"))==null?'':BetaJS.Strings.htmlentities(__t))+\n'"}e+="';\n",e="with(obj||{}){\n"+e+"}\n",e="var __t,__p='',__j=Array.prototype.join,echo=function(){__p+=__j.call(arguments,'');};\n"+e+"return __p;\n";var g=new Function("obj",e),h=function(a){return g.call(this,a)};return h.source="function(obj){\n"+e+"}",h}},BetaJS.Templates.SYNTAX={OPEN:"{%",CLOSE:"%}",MODIFIER_CODE:"",MODIFIER_EXPR:"=",MODIFIER_ESC:"-"},BetaJS.Templates.SYNTAX_REGEX=function(){var a=BetaJS.Templates.SYNTAX;return BetaJS.Templates.SYNTAX_REGEX_CACHED||(BetaJS.Templates.SYNTAX_REGEX_CACHED=new RegExp(a.OPEN+a.MODIFIER_EXPR+"([\\s\\S]+?)"+a.CLOSE+"|"+a.OPEN+a.MODIFIER_ESC+"([\\s\\S]+?)"+a.CLOSE+"|"+a.OPEN+a.MODIFIER_CODE+"([\\s\\S]+?)"+a.CLOSE+"|"+"$","g")),BetaJS.Templates.SYNTAX_REGEX_CACHED},BetaJS.Templates.TOKEN_STRING=1,BetaJS.Templates.TOKEN_CODE=2,BetaJS.Templates.TOKEN_EXPR=3,BetaJS.Templates.TOKEN_ESC=4,BetaJS.Class.extend("BetaJS.Templates.Template",{constructor:function(a){this._inherited(BetaJS.Templates.Template,"constructor"),this.__tokens=BetaJS.Templates.tokenize(a),this.__compiled=BetaJS.Templates.compile(this.__tokens)},evaluate:function(a){return this.__compiled.apply(this,[a])}},{bySelector:function(a){return new this(BetaJS.$(a).html())}}),BetaJS.$=jQuery||null,BetaJS.Exceptions.Exception.extend("BetaJS.Views.ViewException"),BetaJS.Views.View=BetaJS.Class.extend("BetaJS.Views.View",[BetaJS.Events.EventsMixin,BetaJS.Events.ListenMixin,BetaJS.Ids.ClientIdMixin,BetaJS.Properties.PropertiesMixin,BetaJS.Classes.ModuleMixin,{_templates:function(){return{}},_dynamics:function(){return{}},_events:function(){return[]},_global_events:function(){return[]},_css:function(){return{}},css:function(a){if(this.__css[a])return this.__css[a];if(this.__parent){var b=this.__parent.css(a);if(b&&b!=a)return b}var b=this._css();return b[a]?b[a]:a},_render:function(){this.__html?this.$el.html(this.__html):this.__templates["default"]?this.$el.html(this.evaluateTemplate("default",{})):this.__dynamics["default"]&&this.evaluateDynamics("default",this.$el,{},{name:"default"})},templates:function(a){return a in this.__templates?this.__templates[a]:null},dynamics:function(a){return a in this.__dynamics?this.__dynamics[a]:null},_supp:function(){return{__context:this,css:function(a){return this.__context.css(a)},attrs:function(a){var b="";for(var c in a)b+=(null==a[c]?c:c+"='"+a[c]+"'")+" ";return b},styles:function(a){var b="";for(var c in a)b+=c+":"+a[c]+";";return b},selector:function(a){return"data-selector='"+a+"' "},view_id:this.cid()}},templateArguments:function(){var a=this.getAll();return a.supp=this._supp(),a},evaluateTemplate:function(a,b){return b=b||{},this.__templates[a].evaluate(BetaJS.Objs.extend(b,this.templateArguments()))},evaluateDynamics:function(a,b,c,d){return this.__dynamics[a].renderInstance(b,BetaJS.Objs.extend(d||{},{args:c||{}}))},_setOption:function(a,b,c,d){var d=d?d:"__";this[d+b]=b in a&&BetaJS.Types.is_defined(a[b])?a[b]:c},_setOptionProperty:function(a,b,c){this.set(b,b in a&&BetaJS.Types.is_defined(a[b])?a[b]:c)},constructor:function(a){a=a||{},this._inherited(BetaJS.Views.View,"constructor"),this._setOption(a,"el",null),this._setOption(a,"visible",!0),this._setOption(a,"html",null),this._setOption(a,"events",[]),this._setOption(a,"attributes",{}),this._setOption(a,"invalidate_on_show",!1),this._setOption(a,"append_to_el",!1),this.__old_attributes={},this._setOption(a,"el_classes",[]),BetaJS.Types.is_string(this.__el_classes)&&(this.__el_classes=this.__el_classes.split(" ")),this.__added_el_classes=[],this._setOption(a,"el_styles",{}),this._setOption(a,"children_styles",{}),this._setOption(a,"children_classes",[]),BetaJS.Types.is_string(this.__children_classes)&&(this.__children_classes=this.__children_classes.split(" ")),this._setOption(a,"invalidate_on_change",!1),this.__old_el_styles={},this._setOption(a,"css",{}),this.__parent=null,this.__children={},this.__active=!1,this.$el=null;var b=BetaJS.Types.is_function(this._events)?this._events():this._events;BetaJS.Types.is_array(b)||(b=[b]),this.__events=b.concat(this.__events);var c=BetaJS.Types.is_function(this._global_events)?this._global_events():this._global_events;BetaJS.Types.is_array(c)||(c=[c]),this.__global_events=c;var d=BetaJS.Objs.extend(BetaJS.Types.is_function(this._templates)?this._templates():this._templates,a.templates||{});"template"in a&&(d["default"]=a.template),this.__templates={};for(var e in d){if(null==d[e])throw new BetaJS.Views.ViewException("Could not find template '"+e+"' in View '"+this.cls.classname+"'");this.__templates[e]=new BetaJS.Templates.Template(BetaJS.Types.is_string(d[e])?d[e]:d[e].html())}var f=BetaJS.Objs.extend(BetaJS.Types.is_function(this._dynamics)?this._dynamics():this._dynamics,a.dynamics||{});"dynamic"in a&&(f["default"]=a.dynamic),this.__dynamics={};for(var e in f)this.__dynamics[e]=new BetaJS.Views.DynamicTemplate(this,BetaJS.Types.is_string(f[e])?f[e]:f[e].html());this.setAll(a.properties||{}),this.__invalidate_on_change&&this.on("change",function(){this.invalidate()},this),this.__modules={},BetaJS.Objs.iter(a.modules||[],this.add_module,this),this._notify("created",a),this.ns={};var g=this._domain(),h=this._domain_defaults();if(!BetaJS.Types.is_empty(g)){var i=[];for(var j in g)i.push({name:j,data:g[j]});i=BetaJS.Sort.dependency_sort(i,function(a){return a.name},function(a){return a.data.before||[]},function(a){var b=a.data.after||[];return a.data.parent&&b.push(a.data.parent),b});for(var k=0;k<i.length;++k){var j=i[k].name,l=i[k].data,a=l.options||{};BetaJS.Types.is_function(a)&&(a=a.apply(this,[this]));var m=h[l.type]||{};BetaJS.Types.is_function(m)&&(m=m.apply(this,[this])),a=BetaJS.Objs.tree_merge(m,a),l.type in BetaJS.Views&&(l.type=BetaJS.Views[l.type]),BetaJS.Types.is_string(l.type)&&(l.type=BetaJS.Scopes.resolve(l.type));var n=new l.type(a);this.ns[j]=n;var o=l.parent_options||{},p=this;l.parent&&(p=BetaJS.Scopes.resolve(l.parent,this.ns)),l.method?l.method(p,n):p.addChild(n,o),n.domain=this;for(var q in l.events||{})n.on(q,l.events[q],n);for(var q in l.listeners||{})this.on(q,l.listeners[q],n)}}},_domain:function(){return{}},_domain_defaults:function(){return{}},isActive:function(){return this.__active},activate:function(){if(this.isActive())return this;if(null==this.__el)return null;if(this.__parent&&!this.__parent.isActive())return null;if(this.$el=this.__parent?""==this.__el?this.__parent.$el:this.__parent.$(this.__el):BetaJS.$(this.__el),0==this.$el.size()&&(this.$el=null),!this.$el)return null;this.__append_to_el&&(this.$el.append("<div data-view-id='"+this.cid()+"'></div>"),this.$el=this.$el.find("[data-view-id='"+this.cid()+"']")),this.__old_attributes={};for(var a in this.__attributes){var b=this.$el.attr(a);this.__old_attributes[a]=BetaJS.Types.is_defined(b)?b:null,this.$el.attr(a,this.__attributes[a])}this.__added_el_classes=[];for(var c=BetaJS.Objs.extend(this._el_classes(),this.__el_classes),d=0;d<c.length;++d)this.$el.hasClass(c[d])||(this.$el.addClass(c[d]),this.__added_el_classes.push(c[d]));this.__old_el_styles={};var e=BetaJS.Objs.extend(this._el_styles(),this.__el_styles);for(var a in e){var b=this.$el.css(a);this.__old_el_styles[a]=BetaJS.Types.is_defined(b)?b:null,this.$el.css(a,e[a])}return this.__bind(),this.__visible||this.$el.css("display",this.__visible?"":"none"),this.__active=!0,this.__render(),BetaJS.Objs.iter(this.__children,function(a){a.view.activate()}),this._notify("activate"),this.trigger("activate"),this.__visible&&this.trigger("show"),this.trigger("visibility",this.__visible),this.trigger("resize"),this},deactivate:function(){if(!this.isActive())return!1;this.__visible&&this.trigger("hide"),this.trigger("visibility",!1),this._notify("deactivate"),this.trigger("deactivate"),BetaJS.Objs.iter(this.__children,function(a){a.view.deactivate()}),this.__active=!1,BetaJS.Objs.iter(this.__dynamics,function(a){a.reset()},this),this.__unbind(),this.$el.html("");for(var a in this.__old_attributes)this.$el.attr(a,this.__old_attributes[a]);for(var b=0;b<this.__added_el_classes.length;++b)this.$el.removeClass(this.__added_el_classes[b]);for(var a in this.__old_el_styles)this.$el.css(a,this.__old_el_styles[a]);return this.__append_to_el&&this.$el.remove(),this.$el=null,!0},_el_styles:function(){return{}},_el_classes:function(){return[]},$:function(a){return this.$el.find(a)},$data:function(a,b){b||(b=this.$el);var c="";for(var d in a)c+="[data-"+d+"='"+a[d]+"']";return b.find(c)},destroy:function(){this.deactivate(),BetaJS.Objs.iter(this.__children,function(a){a.view.destroy()}),BetaJS.Objs.iter(this.__dynamics,function(a){a.destroy()},this),BetaJS.Objs.iter(this.__templates,function(a){a.destroy()},this),this.trigger("destroy"),this._inherited(BetaJS.Views.View,"destroy")},show:function(){this.setVisibility(!0)},hide:function(){this.setVisibility(!1)},isVisible:function(){return this.__visible},setVisibility:function(a){a!=this.__visible&&(this.__visible=a,this.isActive()&&(this.$el.css("display",this.__visible?"":"none"),this.__visible&&(this.trigger("resize"),this.__invalidate_on_show&&this.invalidate()),this.trigger(a?"show":"hide"),this.trigger("visibility",a)),this.__parent&&this.__parent.updateChildVisibility(this))},updateChildVisibility:function(){},toggle:function(){this.setVisibility(!this.isVisible())},__bind:function(){var a=this;this.__unbind(),BetaJS.Objs.iter(this.__events,function(b){BetaJS.Objs.iter(b,function(b,c){var d=BetaJS.Types.is_function(b)?b:a[b],e=c.match(BetaJS.Views.BIND_EVENT_SPLITTER),f=e[1],g=e[2];f=f+".events"+a.cid();var h=BetaJS.Functions.as_method(d,a);""===g?a.$el.on(f,h):a.$el.on(f,g,h)})}),BetaJS.Objs.iter(this.__global_events,function(b){BetaJS.Objs.iter(b,function(b,c){var d=BetaJS.Types.is_function(b)?b:a[b],e=c.match(BetaJS.Views.BIND_EVENT_SPLITTER),f=e[1],g=e[2];f=f+".events"+a.cid();var h=BetaJS.Functions.as_method(d,a);""===g?BetaJS.$(document).on(f,h):BetaJS.$(document).on(f,g,h)})})},__unbind:function(){this.$el.off(".events"+this.cid()),BetaJS.$(document).off(".events"+this.cid())},__render:function(){if(this.isActive()){this._render();var a=this.$el.children();if(!BetaJS.Types.is_empty(this.__children_styles))for(var b in this.__children_styles)a.css(b,this.__children_styles[b]);BetaJS.Objs.iter(this.__children_classes,function(b){a.addClass(b)})}},invalidate:function(){this.isActive()&&(BetaJS.Objs.iter(this.__children,function(a){a.view.deactivate()}),BetaJS.Objs.iter(this.__dynamics,function(a){a.reset()},this),this.__render(),BetaJS.Objs.iter(this.__children,function(a){a.view.activate()}))},setEl:function(a){this.isActive()?(this.deactivate(),this.__el=a,this.activate()):this.__el=a},getParent:function(){return this.__parent},hasChild:function(a){return a&&a.cid()in this.__children},setParent:function(a){if(a!=this.__parent){if(this.deactivate(),this.__parent){this._unbindParent(this.__parent);var b=this.__parent;this.__parent.off(null,null,this),this.__parent=null,b.removeChild(this)}a&&(this.__parent=a,a.addChild(this),this._bindParent(a),a.isActive()&&this.activate())}},_bindParent:function(){},_unbindParent:function(){},children:function(){var a={};return BetaJS.Objs.iter(this.__children,function(b,c){a[c]=b.view},this),a},childOptions:function(a){return this.__children[a.cid()].options},addChildren:function(a){BetaJS.Objs.iter(a,function(a){this.addChild(a)},this)},addChild:function(a,b){return this.hasChild(a)?null:(b=b||{},this.__children[a.cid()]={view:a,options:b},this._notify("addChild",a,b),a.setParent(this),this.isActive()&&this.isVisible()&&this.trigger("resize"),a)},removeChildren:function(a){BetaJS.Objs.iter(a,function(a){this.removeChild(a)},this)},removeChild:function(a){this.hasChild(a)&&(delete this.__children[a.cid()],a.setParent(null),a.off(null,null,this),this._notify("removeChild",a),this.isActive()&&this.isVisible()&&this.trigger("resize"))
},width:function(){return this.$el.width()},innerWidth:function(){return this.$el.innerWidth()},outerWidth:function(){return this.$el.outerWidth()},height:function(){return this.$el.height()},innerHeight:function(){return this.$el.innerHeight()},outerHeight:function(){return this.$el.outerHeight()}}]),BetaJS.Views.BIND_EVENT_SPLITTER=/^(\S+)\s*(.*)$/,BetaJS.Class.extend("BetaJS.Views.DynamicTemplate",{constructor:function(a,b){this._inherited(BetaJS.Views.DynamicTemplate,"constructor"),this.__parent=a,this.__template=new BetaJS.Templates.Template(b),this.__instances={},this.__instances_by_name={}},reset:function(){BetaJS.Objs.iter(this.__instances,function(a){this.removeInstance(a)},this)},destroy:function(){this.reset(),this._inherited(BetaJS.Views.DynamicTemplate,"destroy")},renderInstance:function(a,b){b=b||{},b.name&&this.removeInstanceByName(b.name);var c=new BetaJS.Views.DynamicTemplateInstance(this,a,b);this.__instances[c.cid()]=c,b.name&&(this.__instances_by_name[name]=c)},removeInstanceByName:function(a){a in this.__instances_by_name&&this.removeInstance(this.__instances_by_name[a])},removeInstance:function(a){delete this.__instances[a.cid()],delete this.__instances_by_name[a.name()],a.destroy()},view:function(){return this.__parent},template:function(){return this.__template}}),BetaJS.Class.extend("BetaJS.Views.DynamicTemplateInstance",[BetaJS.Ids.ClientIdMixin,BetaJS.Events.ListenMixin,{__bind:{attr:function(a,b){return this.__context.__bind_attribute(a,b)},attrs:function(a){var b="";for(attribute in a)b+=this.attr(attribute,a[attribute])+" ";return b},value:function(a){return this.__context.__bind_value(a)},inner:function(a){return this.__context.__bind_inner(a)},css_if:function(a,b){return this.__context.__bind_css_if(a,b,!0)},css_if_not:function(a,b){return this.__context.__bind_css_if(a,b,!1)}},__new_element:function(a){var b=BetaJS.Ids.uniqueId();return this.__elements[b]=BetaJS.Objs.extend({id:b,$el:null},a),this.__elements[b]},__decompose_variable:function(a){var b=a.split(".");return{object:1==b.length?this.__parent.view():this.__args[b[0]],key:1==b.length?a:b[1]}},__get_variable:function(a){var b=this.__decompose_variable(a);return b.object.get(b.key)},__set_variable:function(a,b){var c=this.__decompose_variable(a);return c.object.set(c.key,b)},__update_element:function(a){var b=this.__get_variable(a.variable);"inner"==a.type?a.$el.html(b):"value"==a.type?a.$el.val()!=b&&a.$el.val(b):"attribute"==a.type?a.$el.attr(a.attribute,b):"css"==a.type&&(a.positive||(b=!b),b?a.$el.addClass(this.__parent.view().css(a.css)):a.$el.removeClass(this.__parent.view().css(a.css)))},__prepare_element:function(a){var b=this;a.$el=this.$el.find(a.selector),"inner"==a.type||"css"==a.type?this.__update_element(a):"value"==a.type&&a.$el.on("change input keyup paste",function(){b.__set_variable(a.variable,a.$el.val())})},__bind_attribute:function(a,b){var c=this.__new_element({type:"attribute",attribute:a,variable:b}),d="data-bind-"+a+"='"+c.id+"'";c.selector="["+d+"]";var e=this.__decompose_variable(b);return this.listenOn(e.object,"change:"+e.key,function(){this.__update_element(c)},this),d+" "+a+"='"+e.object.get(e.key)+"'"},__bind_css_if:function(a,b,c){var d=this.__new_element({type:"css",css:a,variable:b,positive:c}),e="data-bind-css-"+a+"='"+d.id+"'";d.selector="["+e+"]";var f=this.__decompose_variable(b);return this.listenOn(f.object,"change:"+f.key,function(){this.__update_element(d)},this),e},__bind_value:function(a){var b=this.__new_element({type:"value",variable:a}),c="data-bind-value='"+b.id+"'";b.selector="["+c+"]";var d=this.__decompose_variable(a);return this.listenOn(d.object,"change:"+d.key,function(){this.__update_element(b)},this),c+" value='"+d.object.get(d.key)+"'"},__bind_inner:function(a){var b=this.__new_element({type:"inner",variable:a}),c="data-bind-inner='"+b.id+"'";b.selector="["+c+"]";var d=this.__decompose_variable(a);return this.listenOn(d.object,"change:"+d.key,function(){this.__update_element(b)},this),c},constructor:function(a,b,c){this._inherited(BetaJS.Views.DynamicTemplateInstance,"constructor"),this.__elements={},this.__inners={},c=c||{},c.name&&(this.__name=name),this.__parent=a,this.$el=b,this.__args=BetaJS.Objs.extend(c.args||{},this.__parent.view().templateArguments()),this.__args.bind=BetaJS.Objs.extend({__context:this},this.__bind),this.$el.html(a.template().evaluate(this.__args)),BetaJS.Objs.iter(this.__elements,function(a){this.__prepare_element(a)},this)},destroy:function(){BetaJS.Objs.iter(this.__elements,function(a){a.$el.off()},this),this._inherited(BetaJS.Views.DynamicTemplateInstance,"destroy")},name:function(){return this.__name}}]),BetaJS.Classes.Module.extend("BetaJS.Views.Modules.Centering",{constructor:function(a){this._inherited(BetaJS.Views.Modules.Centering,"constructor",a),this.__vertical="vertical"in a?a.vertical:!1,this.__horizontal="horizontal"in a?a.horizontal:!1},_register:function(a){a.on("resize",function(){a.isVisible()&&this.__update(a)},this),a.isActive()&&a.isVisible()&&this.__update(a)},__update:function(a){this.__vertical&&(a.$el.css("top","50%"),a.$el.css("margin-top",Math.round(-a.$el.height()/2)+"px")),this.__horizontal&&(a.$el.css("left","50%"),a.$el.css("margin-left",Math.round(-a.$el.width()/2)+"px"))}},{__vertical:null,vertical:function(){return this.__vertical||(this.__vertical=new this({auto_destroy:!1,vertical:!0,horizontal:!1})),this.__vertical},__horizontal:null,horizontal:function(){return this.__horizontal||(this.__horizontal=new this({auto_destroy:!1,horizontal:!0,vertical:!1})),this.__horizontal},__both:null,both:function(){return this.__both||(this.__both=new this({auto_destroy:!1,vertical:!0,horizontal:!0})),this.__both}}),BetaJS.Classes.Module.extend("BetaJS.Views.Modules.BindOnActivate",{_register:function(a,b){b.bound=!1,a.on("activate",function(){this.__bind(a)},this),a.on("deactivate",function(){this.__unbind(a)},this),a.isActive()&&this.__bind(a)},_unregister:function(a){this.__unbind(a)},__bind:function(a){var b=this._data(a);b.bound||(this._bind(a,b),b.bound=!0)},__unbind:function(a){var b=this._data(a);b.bound&&(this._unbind(a,b),b.bound=!1)},_bind:function(){},_unbind:function(){}}),BetaJS.Classes.Module.extend("BetaJS.Views.Modules.BindOnVisible",{_register:function(a,b){b.bound=!1,a.on("visibility",function(b){b?this.__bind(a):this.__unbind(a)},this),a.isActive()&&a.isVisible()&&this.__bind(a)},_unregister:function(a){this.__unbind(a)},__bind:function(a){var b=this._data(a);b.bound||(this._bind(a,b),b.bound=!0)},__unbind:function(a){var b=this._data(a);b.bound&&(this._unbind(a,b),b.bound=!1)},_bind:function(){},_unbind:function(){}}),BetaJS.Views.Modules.BindOnVisible.extend("BetaJS.Views.Modules.HideOnLeave",{_bind:function(a,b){var c=a.$el.get(0);b.hide_on_leave_func=function(d){return b.hide_on_leave_skip?(b.hide_on_leave_skip=!1,void 0):(document.contains(d.target)&&d.target!==c&&!BetaJS.$.contains(c,d.target)&&a.hide(),void 0)},b.hide_on_leave_skip=!0,BetaJS.$(document.body).on("click",b.hide_on_leave_func)},_unbind:function(a,b){BetaJS.$(document.body).unbind("click",b.hide_on_leave_func)}}),BetaJS.Views.Modules.BindOnActivate.extend("BetaJS.Views.Modules.Hotkeys",{constructor:function(a){this._inherited(BetaJS.Views.Modules.Hotkeys,"constructor",a),this.__hotkeys=a.hotkeys},_bind:function(a,b){b.hotkeys={},BetaJS.Objs.iter(this.__hotkeys,function(c,d){b.hotkeys[d]=BetaJS.Browser.Hotkeys.register(d,BetaJS.Types.is_function(c)?c:a[c],a)},this)},_unbind:function(a,b){BetaJS.Objs.iter(b.hotkeys,function(a){BetaJS.Browser.Hotkeys.unregister(a)},this),b.hotkeys={}}}),BetaJS.Templates.Cached=BetaJS.Templates.Cached||{},BetaJS.Templates.Cached["holygrail-view-template"]="  <div data-selector=\"right\" class='holygrail-view-right-container'></div>  <div data-selector=\"left\" class='holygrail-view-left-container'></div>  <div data-selector=\"center\" class='holygrail-view-center-container'></div> ",BetaJS.Templates.Cached["list-container-view-item-template"]='  <{%= container_element %} data-view-id="{%= cid %}"></{%= container_element %}> ',BetaJS.Templates.Cached["switch-container-view-item-template"]='  <div data-view-id="{%= cid %}" class="switch-container" data-selector="switch-container-item"></div> ',BetaJS.Templates.Cached["button-view-template"]='   <{%= button_container_element %} data-selector="button-inner" class="{%= supp.css("default") %}"    {%= bind.css_if("disabled", "disabled") %}    {%= bind.css_if("selected", "selected") %}    {%= bind.inner("label") %}>   </{%= button_container_element %}>  ',BetaJS.Templates.Cached["check-box-view-template"]='  <input type="checkbox" {%= checked ? "checked" : "" %} id="check-{%= supp.view_id %}" />  <label for="check-{%= supp.view_id %}">{%= label %}</label> ',BetaJS.Templates.Cached["input-view-template"]='  <input class="input-view" type="{%= input_type %}" {%= bind.value("value") %} {%= bind.attr("placeholder", "placeholder") %} /> ',BetaJS.Templates.Cached["label-view-template"]='  <{%= element %} class="{%= supp.css(\'label\') %}" {%= bind.inner("label") %}></{%= element %}> ',BetaJS.Templates.Cached["link-view-template"]='  <a href="javascript:{}" {%= bind.inner("label") %}></a> ',BetaJS.Templates.Cached["text-area-template"]='   <textarea {%= bind.value("value") %} {%= bind.attr("placeholder", "placeholder") %}             {%= bind.css_if_not("text-area-no-resize", "resizable") %}             {%= readonly ? \'readonly\' : \'\' %}             style="resize: {%= horizontal_resize ? (vertical_resize ? \'both\' : \'horizontal\') : (vertical_resize ? \'vertical\' : \'none\') %}"             {%= bind.css_if("text-area-horizontal-fill", "horizontal_fill") %}></textarea>  ',BetaJS.Templates.Cached["progress-template"]='  <div class="{%= supp.css(\'outer\') %}">   <div data-selector="inner" class="{%= supp.css(\'inner\') %}" style="{%= horizontal ? \'width\': \'height\' %}:{%= value*100 %}%">   </div>   <div class="progress-view-overlay" data-selector="label">    {%= label %}   </div>  </div> ',BetaJS.Templates.Cached["list-view-template"]='   <{%= list_container_element %}    {%= supp.attrs(list_container_attrs) %}    class="{%= list_container_classes %}"    data-selector="list">   </{%= list_container_element %}>  ',BetaJS.Templates.Cached["list-view-item-container-template"]='   <{%= item_container_element %}    {%= supp.attrs(item_container_attrs) %}    class="{%= item_container_classes %}"    {%= supp.list_item_attr(item) %}>   </{%= item_container_element %}>  ',BetaJS.Templates.Cached["overlay-view-template"]='  <div data-selector="container"></div> ',BetaJS.Templates.Cached["fullscreen-overlay-view-template"]='  <div class="fullscreen-overlay-background" data-selector="outer"></div>  <div class="fullscreen-overlay" data-selector="inner"></div> ',BetaJS.Views.View.extend("BetaJS.Views.HolygrailView",{_templates:{"default":BetaJS.Templates.Cached["holygrail-view-template"]},constructor:function(a){this._inherited(BetaJS.Views.HolygrailView,"constructor",a),this.__left=null,this.__center=null,this.__right=null},getLeft:function(){return this.__left},setLeft:function(a){return this.__setView("left",a)},getCenter:function(){return this.__center},setCenter:function(a){return this.__setView("center",a)},getRight:function(){return this.__right},setRight:function(a){return this.__setView("right",a)},__setView:function(a,b){return this.removeChild(this["__"+a]),this["__"+a]=null,b&&(b.setEl('[data-selector="'+a+'"]'),this["__"+a]=this.addChild(b)),b}}),BetaJS.Views.View.extend("BetaJS.Views.ListContainerView",{_templates:{item:BetaJS.Templates.Cached["list-container-view-item-template"]},_notifications:{addChild:"__addChildContainer",removeChild:"__removeChildContainer"},constructor:function(a){a=a||{},this._inherited(BetaJS.Views.ListContainerView,"constructor",a),this._setOption(a,"alignment","horizontal"),this._setOption(a,"positioning","float"),this._setOption(a,"container_element","div"),this.on("show",function(){"computed"==this.__positioning&&this.__updatePositioning()},this)},isHorizontal:function(){return"horizontal"==this.__alignment},_render:function(){this.$el.html(""),BetaJS.Objs.iter(this.children(),function(a){this.__addChildContainer(a)},this)},__addChildContainer:function(a){var b=this.childOptions(a);if(this.isActive()&&this.$el.append(this.evaluateTemplate("item",{cid:a.cid(),container_element:this.__container_element})),a.setEl("[data-view-id='"+a.cid()+"']"),!this.isHorizontal()||"float"in b||"float"!=this.__positioning||(b["float"]="left"),this.isActive()&&"float"in b&&"float"==this.__positioning){var c=this.$("[data-view-id='"+a.cid()+"']");c.css("float",b["float"])}},__removeChildContainer:function(a){this.$data({"view-id":a.cid()}).remove()},__updatePositioningHelper:function(a,b,c){var d=0;BetaJS.Objs.iter(a,function(a){var e=this.childOptions(a);return e.type&&"ignore"==e.type||(a.$el.css(b,d+"px"),a.isVisible()&&(d+=parseInt(a.$el.css(c))),!e.type||"dynamic"!=e.type)?void 0:!1},this)},__updatePositioning:function(){var a=BetaJS.Objs.values(this.children()),b=BetaJS.Objs.clone(a,1).reverse(),c=this.isHorizontal()?"left":"top",d=this.isHorizontal()?"right":"bottom",e=this.isHorizontal()?"width":"height";this.__updatePositioningHelper(b,d,e),this.__updatePositioningHelper(a,c,e)},updateChildVisibility:function(a){this._inherited(BetaJS.Views.ListContainerView,"updateChildVisibility",a),"computed"==this.__positioning&&this.__updatePositioning()}}),BetaJS.Views.View.extend("BetaJS.Views.SingleContainerView",{constructor:function(a){this._inherited(BetaJS.Views.SingleContainerView,"constructor",a),this.__view=null},getView:function(){return this.__view},setView:function(a){return this.removeChild(this.__view),a&&(a.setEl(""),this.__view=this.addChild(a)),a}}),BetaJS.Views.View.extend("BetaJS.Views.SwitchContainerView",{_templates:{item:BetaJS.Templates.Cached["switch-container-view-item-template"]},_notifications:{addChild:"__addChildContainer",removeChild:"__removeChildContainer"},constructor:function(a){this._inherited(BetaJS.Views.SwitchContainerView,"constructor",a),this.__selected=null},_render:function(){this.$el.html(""),BetaJS.Objs.iter(this.children(),function(a){this.__addChildContainer(a)},this)},__addChildContainer:function(a){this.isActive()&&this.$el.append(this.evaluateTemplate("item",{cid:a.cid()})),a.setEl("[data-view-id='"+a.cid()+"']"),this.__selected=this.__selected||a,a.setVisibility(this.__selected==a)},__removeChildContainer:function(a){this.$data({"view-id":a.cid()}).remove(),this.__selected==a&&(this.__selected=null)},select:function(a){this.__selected=a,BetaJS.Objs.iter(this.children(),function(a){a.setVisibility(this.__selected==a)},this)},selected:function(){return this.__selected}}),BetaJS.Views.View.extend("BetaJS.Views.ButtonView",{_dynamics:{"default":BetaJS.Templates.Cached["button-view-template"]},_css:function(){return{disabled:"","default":"",selected:""}},constructor:function(a){if(a=a||{},this._inherited(BetaJS.Views.ButtonView,"constructor",a),this._setOptionProperty(a,"label",""),this._setOptionProperty(a,"button_container_element","button"),this._setOptionProperty(a,"disabled",!1),this._setOptionProperty(a,"selected",!1),this._setOption(a,"selectable",!1),this._setOption(a,"deselect_all",!1),a.hotkey){var b={};b[a.hotkey]=function(){this.click()},this.add_module(new BetaJS.Views.Modules.Hotkeys({hotkeys:b}))}},_events:function(){return this._inherited(BetaJS.Views.ButtonView,"_events").concat([{"click [data-selector='button-inner']":"click"}])},click:function(){this.get("disabled")||(this.__selectable&&this.select(),this.trigger("click"))},_bindParent:function(a){a.on("select",function(){this.unselect()},this)},_unbindParent:function(a){a.off("select",this)},select:function(){this.__selectable&&(this.getParent().trigger("select",this),this.set("selected",!0))},unselect:function(){this.__selectable&&this.set("selected",!1)},isSelected:function(){return this.get("selected")}}),BetaJS.Views.View.extend("BetaJS.Views.InputView",{_dynamics:{"default":BetaJS.Templates.Cached["input-view-template"]},_events:function(){return[{"blur input":"__leaveEvent","keyup input":"__changeEvent","change input":"__changeEvent","input input":"__changeEvent","paste input":"__changeEvent"},{"keyup input":"__keyupEvent"}]},constructor:function(a){a=a||{},this._inherited(BetaJS.Views.InputView,"constructor",a),this._setOptionProperty(a,"value",""),this._setOptionProperty(a,"placeholder",""),this._setOptionProperty(a,"input_type","text")},__keyupEvent:function(a){var b=a.keyCode||a.which;13==b&&this.trigger("enter_key",this.get("value"))},__leaveEvent:function(){this.trigger("leave")},__changeEvent:function(){this.trigger("change",this.get("value"))},focus:function(a){this.$("input").focus(),this.$("input").focus(),a&&this.$("input").select()}}),BetaJS.Views.View.extend("BetaJS.Views.CheckBoxView",{_templates:{"default":BetaJS.Templates.Cached["check-box-view-template"]},_events:function(){return this._inherited(BetaJS.Views.ButtonView,"_events").concat([{"click input":"__click"}])},constructor:function(a){a=a||{},a.invalidate_on_change=!0,this._inherited(BetaJS.Views.CheckBoxView,"constructor",a),this._setOptionProperty(a,"checked",!1),this._setOptionProperty(a,"label","")},__click:function(){this.set("checked",this.$("input").is(":checked")),this.trigger("check",this.get("checked"))}}),BetaJS.Views.View.extend("BetaJS.Views.LabelView",{_dynamics:{"default":BetaJS.Templates.Cached["label-view-template"]},_css:function(){return{label:"label-view-class"}},_events:function(){return[{click:"__clickEvent"}]},constructor:function(a){this._inherited(BetaJS.Views.LabelView,"constructor",a),this._setOptionProperty(a,"label",""),this._setOptionProperty(a,"element","span")},__clickEvent:function(){this.trigger("click")}}),BetaJS.Views.SwitchContainerView.extend("BetaJS.Views.InputLabelView",{constructor:function(a){this._inherited(BetaJS.Views.InputLabelView,"constructor",a),this._setOptionProperty(a,"value",""),this._setOptionProperty(a,"placeholder",""),this._setOption(a,"edit_on_click",!0),this._setOption(a,"label_mode",!0),this._setOption(a,"read_only",!1),this.label=this.addChild(new BetaJS.Views.LabelView({label:this.binding("value"),el_classes:a.label_el_classes,children_classes:a.label_children_classes})),this.input=this.addChild(new BetaJS.Views.InputView({value:this.binding("value"),placeholder:this.binding("placeholder")})),this.__label_mode||this.select(this.input),this.input.on("leave enter_key",function(){this.label_mode()},this),this.__edit_on_click&&this.label.on("click",function(){this.edit_mode()},this)},is_label_mode:function(){return this.__label_mode},is_edit_mode:function(){return!this.__label_mode},label_mode:function(){this.is_label_mode()||(this.__label_mode=!0,this.select(this.label))},edit_mode:function(){this.is_edit_mode()||this.__read_only||(this.__label_mode=!1,this.select(this.input),this.input.focus(!0))}}),BetaJS.Views.View.extend("BetaJS.Views.LinkView",{_dynamics:{"default":BetaJS.Templates.Cached["link-view-template"]},constructor:function(a){this._inherited(BetaJS.Views.LinkView,"constructor",a),this._setOptionProperty(a,"label","")},_events:function(){return this._inherited(BetaJS.Views.LinkView,"_events").concat([{"click a":"__click"}])},__click:function(){this.trigger("click")}}),BetaJS.Views.View.extend("BetaJS.Views.TextAreaView",{_dynamics:{"default":BetaJS.Templates.Cached["text-area-template"]},constructor:function(a){this._inherited(BetaJS.Views.TextAreaView,"constructor",a),this._setOptionProperty(a,"value",""),this._setOptionProperty(a,"placeholder",""),this._setOptionProperty(a,"horizontal_resize",!1),this._setOptionProperty(a,"vertical_resize",!0),this._setOptionProperty(a,"horizontal_fill",!1),this._setOptionProperty(a,"readonly",!1),this.on("change:readonly",function(){this.get("readonly")?this.$("textarea").attr("readonly","readonly"):this.$("textarea").removeAttr("readonly")},this)}}),BetaJS.Views.View.extend("BetaJS.Views.ProgressView",{_templates:{"default":BetaJS.Templates.Cached["progress-template"]},_css:function(){return{outer:"",inner:""}},constructor:function(a){this._inherited(BetaJS.Views.ProgressView,"constructor",a),this._setOptionProperty(a,"label",""),this._setOptionProperty(a,"horizontal",!0),this._setOptionProperty(a,"value",1),this.on("change:value",function(a){this.isActive()&&this.$("[data-selector='inner']").css(this.get("horizontal")?"width":"height",100*a+"%")},this),this.on("change:label",function(a){this.isActive()&&this.$("[data-selector='label']").html(a)},this)}}),BetaJS.Views.View.extend("BetaJS.Views.CustomListView",{_templates:function(){return{"default":BetaJS.Templates.Cached["list-view-template"],"item-container":BetaJS.Templates.Cached["list-view-item-container-template"]}},_supp:function(){return BetaJS.Objs.extend(this._inherited(BetaJS.Views.CustomListView,"_supp"),{list_item_attr:function(a){return this.attrs({"data-view-id":this.__context.cid(),"data-cid":BetaJS.Ids.objectId(a),"data-index":this.__context.__collection.getIndex(a)})}})},constructor:function(a){if(this._inherited(BetaJS.Views.CustomListView,"constructor",a),this._setOption(a,"list_container_element","ul"),this._setOption(a,"list_container_attrs",{}),this._setOption(a,"list_container_classes",""),this._setOption(a,"item_container_element","li"),this._setOption(a,"item_container_classes",""),this.__itemData={},"collection"in a)this.__collection=a.collection,this.__destroy_collection="destroy_collection"in a?a.destroy_collection:!1,"compare"in a&&this.__collection.set_compare(a.compare);else{var b={};"objects"in a&&(b.objects=a.objects),"compare"in a&&(b.compare=a.compare),this.__collection=new BetaJS.Collections.Collection(b),this.__destroy_collection=!0}this.__collection.on("add",function(a){this.__addItem(a,!0)},this),this.__collection.on("remove",function(a){this.__removeItem(a)},this),this.__collection.on("change",function(a){this.__changeItem(a)},this),this.__collection.on("index",function(a,b){this.__updateItemIndex(a,b)},this),this.__collection.on("reindexed",function(a){this.__reIndexItem(a)},this),this.__collection.on("sorted",function(){this.__sorted()},this)},destroy:function(){for(var a in this.__itemData)this._destroyItemData(this.__itemData[a]);this.__itemData=null,this.__collection.off(null,null,this),this.__destroy_collection&&this.__collection.destroy(),this._inherited(BetaJS.Views.CustomListView,"destroy")},collection:function(){return this.__collection},add:function(a){this.__collection.add(a)},remove:function(a){this.__collection.remove(a)},_render:function(){this.$selector_list=this._renderListContainer();var a=this;this.__collection.iterate(function(b){a.__addItem(b,!1)})},_renderListContainer:function(){return this.$el.html(this.evaluateTemplate("default",{list_container_element:this.__list_container_element,list_container_attrs:this.__list_container_attrs,list_container_classes:this.__list_container_classes})),this.$data({selector:"list"})},_findItemElement:function(a){return this.$data({"view-id":this.cid(),cid:BetaJS.Ids.objectId(a)},this.$selector_list)},_findIndexElement:function(a){return this.$data({"view-id":this.cid(),index:a},this.$selector_list)},__changeItem:function(a){this.isActive()&&this._changeItem(a)},_newItemData:function(){return{}},_destroyItemData:function(){},itemData:function(a){return this.__itemData[BetaJS.Ids.objectId(a)]},_changeItem:function(){},__addItem:function(a,b){if(this.isActive()){var c=this.evaluateTemplate("item-container",{item:a,item_container_element:this.__item_container_element,item_container_attrs:this.__item_container_attrs,item_container_classes:this.__item_container_classes}),d=this.__collection.getIndex(a);if(0==d)this.$selector_list.prepend(c);else{var e=this._findIndexElement(d-1);if(e.length>0)e.after(c);else{var f=this._findIndexElement(d+1);f.length>0?f.before(c):this.$selector_list.append(c)}}var g=this._findItemElement(a);this.__itemData[BetaJS.Ids.objectId(a)]&&this._destroyItemData(this.__itemData[BetaJS.Ids.objectId(a)]),this.__itemData[BetaJS.Ids.objectId(a)]=this._newItemData(a),this._addItem(a,g,b),this._addElement(g,b)}},_addElement:function(){},_addItem:function(){},__removeItem:function(a){if(this.isActive()){var b=this._findItemElement(a);this._removeItem(a,b),this._destroyItemData(this.__itemData[BetaJS.Ids.objectId(a)]),delete this.__itemData[BetaJS.Ids.objectId(a)],this._removeElement(b)}},_removeElement:function(a){a.remove()},_removeItem:function(){},__updateItemIndex:function(a,b){var c=this._findItemElement(a);c.attr("data-index",b),this._updateItemIndex(a,c)},__reIndexItem:function(a){var b=this._findItemElement(a),c=this.collection().getIndex(a);if(0==c)this.$selector_list.prepend(b);else{var d=this._findIndexElement(c-1);d.after(b)}},_updateItemIndex:function(){},__sort:function(){for(var a=this.collection().count()-1;a>=0;a--)this.$selector_list.prepend(this._findIndexElement(a))}}),BetaJS.Views.CustomListView.extend("BetaJS.Views.ListView",{constructor:function(a){this._inherited(BetaJS.Views.ListView,"constructor",a),this._setOption(a,"item_label","label"),this._setOption(a,"render_item_on_change",null==this.dynamics("item"))},_changeItem:function(a){if(this.__render_item_on_change){var b=this._findItemElement(a);this._renderItem(a,b,!1)}},_addItem:function(a,b,c){this._renderItem(a,b,c)},_renderItem:function(a,b){null!=this.templates("item")?b.html(this.evaluateTemplate("item",{item:a})):null!=this.dynamics("item")?this.evaluateDynamics("item",b,{item:a},{name:"item-"+BetaJS.Ids.objectId(a)}):b.html(a.get(this.__item_label))},_removeItem:function(a){null!=this.dynamics("item")&&this.dynamics("item").removeInstanceByName("item-"+BetaJS.Ids.objectId(a))}}),BetaJS.Views.CustomListView.extend("BetaJS.Views.SubViewListView",{constructor:function(a){this._inherited(BetaJS.Views.SubViewListView,"constructor",a),"create_view"in a&&(this._create_view=a.create_view),this._setOption(a,"sub_view",BetaJS.Views.LabelView),this._setOption(a,"item_label","label");var b=this;this._setOption(a,"sub_view_options",function(a){return{label:a.binding(b.__item_label)}})},_create_view:function(a,b){var c=this.__sub_view_options(a);return c.el=b,new this.__sub_view(c)},_addItem:function(a,b){var c=this._create_view(a,b);this.itemData(a).view=c,this.addChild(c)},_destroyItemData:function(a){this.removeChild(a.view),a.view.destroy()}}),BetaJS.Views.View.extend("BetaJS.Views.ItemListItemView",{constructor:function(a){this._inherited(BetaJS.Views.ItemListItemView,"constructor",a),this._setOptionProperty(a,"item",null),this._setOptionProperty(a,"_selected",!1)},_events:function(){return[{click:"__click"}]},isSelected:function(){return this.get("_selected")},__click:function(){this.getParent()&&this.getParent().__click_select&&this.select()},select:function(){this.getParent().select(this.get("item"))},unselect:function(){this.getParent().unselect(this.get("item"))}}),BetaJS.Views.CustomListView.extend("BetaJS.Views.ItemListView",{constructor:function(a){if(this._inherited(BetaJS.Views.ItemListView,"constructor",a),this._setOption(a,"sub_view",BetaJS.Views.ItemListItemView),this._sub_view_options||(this._sub_view_options={}),this._sub_view_options&&!BetaJS.Types.is_function(this._sub_view_options)){var b=this._sub_view_options;this._sub_view_options=function(){return b}}if(a.sub_view_options){if(!BetaJS.Types.is_function(a.sub_view_options)){var b=a.sub_view_options;a.sub_view_options=function(){return b}}this.__sub_view_options=a.sub_view_options;var c=this;this._sub_view_options&&(this.__sub_view_options=function(b){return BetaJS.Objs.extend(c._sub_view_options(b),a.sub_view_options(b))})}else this.__sub_view_options=this._sub_view_options;this._setOption(a,"selectable",!0),this._setOption(a,"multi_select",!1),this._setOption(a,"click_select",!0)},_addItem:function(a,b){var c=new this.__sub_view(BetaJS.Objs.extend({el:b,item:a},this.__sub_view_options(a)));this.itemData(a).view=c,this.addChild(c)},_destroyItemData:function(a){this.removeChild(a.view),a.view.destroy()},isSelected:function(a){return this.itemData(a).view.get("_selected")},select:function(a){if(this.itemData(a)){var b=this;return this.__selectable&&!this.isSelected(a)&&(this.__multi_select||this.collection().iterate(function(a){b.unselect(a)}),this.itemData(a).view.set("_selected",!0),this.trigger("select",a)),this.itemData(a).view}},unselect:function(a){return this.__selectable&&this.isSelected(a)&&(this.itemData(a).view.set("_selected",!1),this.trigger("unselect",a)),this.itemData(a).view}}),BetaJS.Views.View.extend("BetaJS.Views.OverlayView",{_templates:{"default":BetaJS.Templates.Cached["overlay-view-template"]},constructor:function(a){a=a||{},a.anchor=a.anchor||"absolute",a.visible="visible"in a?a.visible:!1,a.children_classes=a.children_classes||[],BetaJS.Types.is_string(a.children_classes)&&(a.children_classes=a.children_classes.split(" ")),a.children_classes.push("overlay-container-class"),this._inherited(BetaJS.Views.OverlayView,"constructor",a),this._setOption(a,"anchor","none"),this._setOption(a,"element",""),this._setOption(a,"overlay_left",0),this._setOption(a,"overlay_top",0),this._setOption(a,"overlay_align_vertical","top"),this._setOption(a,"overlay_align_horizontal","left"),this._setOption(a,"element_align_vertical","bottom"),this._setOption(a,"element_align_horizontal","left"),a.overlay_inner&&(a.overlay_inner.setEl('[data-selector="container"]'),this.overlay_inner=this.addChild(a.overlay_inner)),"hide_on_leave"in a&&!a.hide_on_leave||this.add_module(BetaJS.Views.Modules.HideOnLeave.singleton()),this.on("show",this._after_show,this)},_after_show:function(){if("none"!=this.__anchor){var a=this.$(".overlay-container-class"),b=a.outerWidth(),c=a.outerHeight(),d=this.__overlay_left,e=this.__overlay_top;"bottom"==this.__overlay_align_vertical?e-=c:"center"==this.__overlay_align_vertical&&(e-=Math.round(c/2)),"right"==this.__overlay_align_horizontal?d-=b:"center"==this.__overlay_align_horizontal&&(d-=Math.round(b/2));var f=this.$el;"element"==this.__anchor&&this.__element&&(f=this.__element,BetaJS.Types.is_string(f)?f=BetaJS.$(f):BetaJS.Class.is_class_instance(f)&&(f=f.$el)),("relative"==this.__anchor||"element"==this.__anchor)&&(element_width=f.outerWidth(),element_height=f.outerHeight(),d+=f.offset().left-$(window).scrollLeft(),e+=f.offset().top-$(window).scrollTop(),"bottom"==this.__element_align_vertical?e+=element_height:"center"==this.__element_align_vertical&&(e+=Math.round(element_height/2)),"right"==this.__element_align_horizontal?d+=element_width:"center"==this.__element_align_horizontal&&(d+=Math.round(element_width/2))),a.css("left",d+"px"),a.css("top",e+"px")}}}),BetaJS.Views.View.extend("BetaJS.Views.FullscreenOverlayView",{_templates:{"default":BetaJS.Templates.Cached["fullscreen-overlay-view-template"]},_events:function(){return[{'click [data-selector="outer"]':"__unfocus",'touchstart [data-selector="outer"]':"__unfocus"}]},constructor:function(a){a=a||{},a.el=a.el||"body",a.append_to_el="append_to_el"in a?a.append_to_el:!0,a.visible="visible"in a?a.visible:!1,this._inherited(BetaJS.Views.FullscreenOverlayView,"constructor",a),a.overlay_inner.setEl('[data-selector="inner"]'),this.overlay_inner=this.addChild(a.overlay_inner),this._setOption(a,"hide_on_unfocus",!0),this._setOption(a,"destroy_on_unfocus",!1),this.on("show",this._after_show,this),this.on("hide",this._after_hide,this)},_after_show:function(){var a=this.$('[data-selector="outer"]'),b=this.$('[data-selector="inner"]');b.removeClass("fullscreen-overlay-float"),b.removeClass("fullscreen-overlay-fit");var c=a.outerWidth(),d=a.outerHeight(),e=b.outerWidth(),f=b.outerHeight(),g=Math.floor((c-e)/2),h=Math.floor((d-f)/2);g>=0&&h>=0?(b.css("left",g+"px"),b.css("top",h+"px"),b.addClass("fullscreen-overlay-float")):(b.css("left","0px"),b.css("top","0px"),b.addClass("fullscreen-overlay-fit")),BetaJS.$("body").addClass("fullscreen-overlay-body")
},_after_hide:function(){BetaJS.$("body").removeClass("fullscreen-overlay-body")},__unfocus:function(){this.__destroy_on_unfocus?this.destroy():this.__hide_on_unfocus&&this.hide()}}),BetaJS.Views.ListContainerView.extend("BetaJS.Views.FormControlView",{constructor:function(a){this._inherited(BetaJS.Views.FormControlView,"constructor",a),this._model=a.model,this._property=a.property,this._setOption(a,"validate_on_change",!1),this._setOption(a,"validate_on_show",!1),this._setOption(a,"error_classes",""),this.control_view=this.addChild(this._createControl(this._model,this._property,a.control_options||{})),this.label_view=this.addChild(new BetaJS.Views.LabelView(BetaJS.Objs.extend(a.label_options||{},{visible:!1}))),this.__validate_on_change&&this._model.on("change:"+this._property,this.validate,this),this.__validate_on_show&&this.on("show",this.validate,this),this._model.on("validate:"+this._property,this.validate,this)},validate:function(){if(this.isActive()){var a=this._model.validateAttr(this._property);this.label_view.setVisibility(!a),a?this.$el.removeClass(this.__error_classes):(this.$el.addClass(this.__error_classes),this.label_view.set("label",this._model.getError(this._property)))}},_createControl:function(){}}),BetaJS.Views.FormControlView.extend("BetaJS.Views.FormInputView",{_createControl:function(a,b,c){return new BetaJS.Views.InputView(BetaJS.Objs.extend(c,{value:a.binding(b)}))}}),BetaJS.Views.FormControlView.extend("BetaJS.Views.FormCheckBoxView",{_createControl:function(a,b,c){return new BetaJS.Views.CheckBoxView(BetaJS.Objs.extend(c,{checked:a.binding(b)}))}});