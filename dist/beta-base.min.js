/*! betajs - v0.0.2 - 2013-11-13, Copyright (c) Oliver Friedmann & Victor Lingenthal, MIT Software License. */var BetaJS=BetaJS||{};"undefined"!=typeof module&&"exports"in module&&(module.exports=BetaJS),BetaJS.Types={is_object:function(t){return"object"==typeof t},is_array:function(t){return"[object Array]"===Object.prototype.toString.call(t)},is_undefined:function(t){return t===void 0},is_null:function(t){return null==t},is_none:function(t){return this.is_undefined(t)||this.is_null(t)},is_defined:function(t){return t!==void 0},is_empty:function(t){if(this.is_none(t))return!0;if(this.is_array(t))return 0==t.length;if(this.is_object(t)){for(var e in t)return!1;return!0}return!1},is_string:function(t){return"string"==typeof t},is_function:function(t){return"function"==typeof t},is_boolean:function(t){return"boolean"==typeof t},compare:function(t,e){if(BetaJS.Types.is_boolean(t)&&BetaJS.Types.is_boolean(e))return t==e?0:t?1:-1;if(BetaJS.Types.is_array(t)&&BetaJS.Types.is_array(e)){for(var i=t.length,n=e.length,s=Math.min(i,n),r=0;s>r;++r){var o=this.compare(t[r],e[r]);if(0!=o)return o}return i==n?0:i>n?1:-1}return t.localeCompare(e)},parseBool:function(t){return this.is_boolean(t)?t:"true"==t?!0:"false"==t?!1:null}},BetaJS.Strings={nl2br:function(t){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},htmlentities:function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},JS_ESCAPES:{"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},JS_ESCAPER_REGEX:function(){return this.JS_ESCAPER_REGEX_CACHED||(this.JS_ESCAPER_REGEX_CACHED=RegExp(BetaJS.Objs.keys(this.JS_ESCAPES).join("|"),"g")),this.JS_ESCAPER_REGEX_CACHED},js_escape:function(t){var e=this;return t.replace(this.JS_ESCAPER_REGEX(),function(t){return"\\"+e.JS_ESCAPES[t]})},starts_with:function(t,e){return t.substring(0,e.length)==e},ends_with:function(t,e){return-1!==t.indexOf(e,t.length-e.length)},strip_start:function(t,e){return this.starts_with(t,e)?t.substring(e.length):t},last_after:function(t,e){return t.substring(t.lastIndexOf(e)+e.length,t.length)},EMAIL_ADDRESS_REGEX:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,is_email_address:function(t){return this.EMAIL_ADDRESS_REGEX.test(t)}},BetaJS.Functions={as_method:function(t,e){return function(){return t.apply(e,arguments)}},once:function(t){var e=!1,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}}},BetaJS.Scopes={base:function(t,e){if(!BetaJS.Types.is_string(t))return t;if(e)return e[t];try{if(window)return window[t]}catch(i){}try{if(global&&global[t])return global[t]}catch(i){}try{if(module&&module.exports)return module.exports}catch(i){}return null},resolve:function(t,e){if(!BetaJS.Types.is_string(t))return t;for(var i=t.split("."),n=this.base(i[0],e),s=1;i.length>s;++s)n=n[i[s]];return n},touch:function(t,e){if(!BetaJS.Types.is_string(t))return t;for(var i=t.split("."),n=this.base(i[0],e),s=1;i.length>s;++s)i[s]in n||(n[i[s]]={}),n=n[i[s]];return n},set:function(t,e,i){if(!BetaJS.Types.is_string(e))return e;for(var n=e.split("."),s=this.base(n[0],i),r=1;n.length-1>r;++r)n[r]in s||(s[n[r]]={}),s=s[n[r]];return n.length>1&&(s[n[n.length-1]]=t),t}},BetaJS.Objs={count:function(t){if(BetaJS.Types.is_array(t))return t.length;var e=0;for(var i in t)++e;return e},clone:function(t,e){return!e||0>=e?t:BetaJS.Types.is_array(t)?t.slice(0):BetaJS.Types.is_object(t)?this.extend({},t,e-1):t},extend:function(t,e,i){for(var n in e)t[n]=this.clone(e[n],i);return t},merge:function(t,e,i){t=t||{},e=e||{};var n={},s=BetaJS.Objs.extend(BetaJS.Objs.keys(t,!0),BetaJS.Objs.keys(e,!0));for(var r in s){var o=r in i?i[r]:"primary";"primary"==o||"secondary"==o?(r in e||r in t)&&(n[r]="primary"==o?r in e?e[r]:t[r]:r in t?t[r]:e[r]):BetaJS.Types.is_function(o)?n[r]=o(t[r],e[r]):BetaJS.Types.is_object(o)&&(n[r]=BetaJS.Objs.merge(t[r],e[r],o))}return n},tree_merge:function(t,e){t=t||{},e=e||{};var i={},n=BetaJS.Objs.extend(BetaJS.Objs.keys(t,!0),BetaJS.Objs.keys(e,!0));for(var s in n)i[s]=BetaJS.Types.is_object(e[s])&&t[s]?BetaJS.Objs.tree_merge(t[s],e[s]):s in e?e[s]:t[s];return i},keys:function(t,e){if(BetaJS.Types.is_undefined(e)){var i=[];for(var n in t)i.push(n);return i}var i={};for(var n in t)i[n]=e;return i},map:function(t,e,i){if(BetaJS.Types.is_array(t)){for(var n=[],s=0;t.length>s;++s)n.push(i?e.apply(i,t[s],s):e(t[s],s));return n}var n={};for(var r in t)n[r]=i?e.apply(i,t[r],r):e(t[r],r)},values:function(t){var e=[];for(var i in t)e.push(t[i]);return e},filter:function(t,e,i){if(BetaJS.Types.is_array(t)){for(var n=[],s=0;t.length>s;++s)(i?e.apply(i,[t[s],s]):e(t[s],s))&&n.push(t[s]);return n}var n={};for(var r in t)(i?e.apply(i,[t[r],r]):e(t[r],r))&&(n[r]=t[r]);return n},equals:function(t,e,i){if(i&&i>0){for(var n in t)if(!n in e||!this.equals(t[n],e[n],i-1))return!1;for(var n in e)if(!n in t)return!1;return!0}return t==e},iter:function(t,e,i){if(BetaJS.Types.is_array(t))for(var n=0;t.length>n;++n){var s=i?e.apply(i,[t[n],n]):e(t[n],n);if(BetaJS.Types.is_defined(s)&&!s)return!1}else for(var r in t){var s=i?e.apply(i,[t[r],r]):e(t[r],r);if(BetaJS.Types.is_defined(s)&&!s)return!1}return!0},intersect:function(t,e){var i={};for(var n in t)n in e&&(i[n]=t[n]);return i},contains_key:function(t,e){return BetaJS.Types.is_array(t)?BetaJS.Types.is_defined(t[e]):e in t},contains_value:function(t,e){if(BetaJS.Types.is_array(t)){for(var i=0;t.length>i;++i)if(t[i]===e)return!0}else for(var n in t)if(t[n]===e)return!0;return!1},exists:function(t,e,i){var n=!1;return BetaJS.Objs.iter(t,function(){return n=n||e.apply(this,arguments),!n},i),n},all:function(t,e,i){var n=!0;return BetaJS.Objs.iter(t,function(){return n=n&&e.apply(this,arguments)},i),n}},BetaJS.Ids={__uniqueId:0,uniqueId:function(t){return(t||"")+this.__uniqueId++},objectId:function(t){return t.__cid||(t.__cid=this.uniqueId("cid_")),t.__cid}},BetaJS.Ids.ClientIdMixin={cid:function(){return BetaJS.Ids.objectId(this)}},BetaJS.Class=function(){},BetaJS.Class.classname="Class",BetaJS.Class.extend=function(t,e,i,n){e=e||[],BetaJS.Types.is_array(e)||(e=[e]),i=i||[],BetaJS.Types.is_array(i)||(i=[i]),n=n||[],BetaJS.Types.is_array(n)||(n=[n]);var s,r=this;BetaJS.Objs.iter(e,function(t){t.hasOwnProperty("constructor")&&(s=t.constructor)});var o=BetaJS.Types.is_defined(s);BetaJS.Types.is_defined(s)||(s=function(){r.apply(this,arguments)}),BetaJS.Objs.extend(s,r),BetaJS.Objs.iter(i,function(t){BetaJS.Objs.extend(s,t)});var _={};if(r.__class_statics_keys)for(var a in r.__class_statics_keys)s[a]=BetaJS.Objs.clone(r[a],1);BetaJS.Objs.iter(n,function(t){BetaJS.Objs.extend(s,t),BetaJS.Objs.extend(_,BetaJS.Objs.keys(t,!0))}),r.__class_statics_keys&&BetaJS.Objs.extend(_,r.__class_statics_keys),s.__class_statics_keys=_,s.parent=r,s.children=[],s.extend=this.extend,r.children||(r.children=[]),r.children.push(s);var c=function(){};return c.prototype=r.prototype,s.prototype=new c,s.prototype.cls=s,s.classname=t,t&&BetaJS.Scopes.set(s,t),s.__notifications={},r.__notifications&&BetaJS.Objs.extend(s.__notifications,r.__notifications,1),BetaJS.Objs.iter(e,function(t){if(BetaJS.Objs.extend(s.prototype,t),"constructor"in t&&(s.prototype.constructor=t.constructor),t._notifications)for(var e in t._notifications)s.__notifications[e]||(s.__notifications[e]=[]),s.__notifications[e].push(t._notifications[e])}),delete s.prototype._notifications,o||(s.prototype.constructor=r.prototype.constructor),s},BetaJS.Class.prototype.constructor=function(){this._notify("construct")},BetaJS.Class.prototype.as_method=function(t){return BetaJS.Functions.as_method(this[t],this)},BetaJS.Class.prototype._auto_destroy=function(t){return this.__auto_destroy_list||(this.__auto_destroy_list=[]),this.__auto_destroy_list.push(t),t},BetaJS.Class.prototype._notify=function(t){if(this.cls.__notifications){var e=Array.prototype.slice.call(arguments,1),i=this.cls.__notifications[t];if(i)for(var n in i){var s=BetaJS.Types.is_function(i[n])?i[n]:this[i[n]];s.apply(this,e)}}},BetaJS.Class.prototype.destroy=function(){if(this._notify("destroy"),this.__auto_destroy_list)for(var t=0;this.__auto_destroy_list.length>t;++t)"destroy"in this.__auto_destroy_list[t]&&this.__auto_destroy_list[t].destroy();for(var e in this)delete this[e]},BetaJS.Class.prototype._inherited=function(t,e){return t.parent.prototype[e].apply(this,Array.prototype.slice.apply(arguments,[2]))},BetaJS.Class._inherited=function(t,e){return t.parent[e].apply(this,Array.prototype.slice.apply(arguments,[2]))},BetaJS.Class.prototype.instance_of=function(t){return this.cls.ancestor_of(t)},BetaJS.Class.ancestor_of=function(t){return this==t||this!=BetaJS.Class&&this.parent.ancestor_of(t)},BetaJS.Class.prototype.cls=BetaJS.Class,BetaJS.Class.__notifications={},BetaJS.Class.is_class_instance=function(t){return null!=t&&BetaJS.Types.is_object(t)&&"_inherited"in t&&"cls"in t},BetaJS.Exceptions={ensure:function(t){return null!=t&&BetaJS.Types.is_object(t)&&"instance_of"in t&&t.instance_of(BetaJS.Exceptions.Exception)?t:new BetaJS.Exceptions.NativeException(t)}},BetaJS.Class.extend("BetaJS.Exceptions.Exception",{constructor:function(t){this._inherited(BetaJS.Exceptions.Exception,"constructor"),this.__message=t},assert:function(t){if(!this.instance_of(t))throw this;return this},callstack:function(){for(var t=[],e=arguments.callee.caller;e;)t.push(""+e),e=e.caller;return t},callstack_to_string:function(){return this.callstack().join("\n")},message:function(){return this.__message},toString:function(){return this.message()},format:function(){return this.cls.classname+": "+(""+this)+"\n\nCall Stack:\n"+this.callstack_to_string()}},{ensure:function(t){var t=BetaJS.Exceptions.ensure(t);return t.assert(this),t}}),BetaJS.Exceptions.Exception.extend("BetaJS.Exceptions.NativeException",{constructor:function(t){this._inherited(BetaJS.Exceptions.NativeException,"constructor",""+t),this.__object=t},object:function(){return this.__object}}),BetaJS.Class.extend("BetaJS.Lists.AbstractList",{_add:function(){},_remove:function(){},_get:function(){},_iterate:function(){},get_ident:function(t){var e=null;return this._iterate(function(i,n){return i==t?(e=n,!1):!0}),e},exists:function(t){return null!=this.get_ident(t)},_ident_changed:function(){},constructor:function(t){this._inherited(BetaJS.Lists.AbstractList,"constructor"),this.__count=0,t&&BetaJS.Objs.iter(t,function(t){this.add(t)},this)},add:function(t){var e=this._add(t);return BetaJS.Types.is_defined(e)&&this.__count++,e},count:function(){return this.__count},clear:function(){var t=this;this._iterate(function(e,i){return t.remove_by_ident(i),!0})},remove_by_ident:function(t){var e=this._remove(t);return BetaJS.Types.is_defined(e)&&this.__count--,e},remove:function(t){return this.remove_by_ident(this.get_ident(t))},remove_by_filter:function(t){var e=this;this._iterate(function(i,n){return t(i)&&e.remove_by_ident(n),!0})},get:function(t){return this._get(t)},iterate:function(t){this._iterate(function(e,i){var n=t(e,i);return BetaJS.Types.is_defined(n)?n:!0})}}),BetaJS.Lists.AbstractList.extend("BetaJS.Lists.LinkedList",{constructor:function(t){this.__first=null,this.__last=null,this._inherited(BetaJS.Lists.LinkedList,"constructor",t)},_add:function(t){return this.__last={obj:t,prev:this.__last,next:null},this.__first?this.__last.prev.next=this.__last:this.__first=this.__last,this.__last},_remove:function(t){return t.next?t.next.prev=t.prev:this.__last=t.prev,t.prev?t.prev.next=t.next:this.__first=t.next,t.obj},_get:function(t){return t.obj},_iterate:function(t){for(var e=this.__first;null!=e;){var i=e;if(e=e.next,!t(i.obj,i))return}}}),BetaJS.Lists.AbstractList.extend("BetaJS.Lists.ObjectIdList",{constructor:function(t){this.__map={},this._inherited(BetaJS.Lists.ObjectIdList,"constructor",t)},_add:function(t){var e=BetaJS.Ids.objectId(t);return this.__map[e]=t,e},_remove:function(t){var e=this.__map[t];return delete this.__map[t],e},_get:function(t){return this.__map[t]},_iterate:function(t){for(var e in this.__map)t(this.__map[e],e)},get_ident:function(t){var e=BetaJS.Ids.objectId(t);return this.__map[e]?e:null}}),BetaJS.Lists.AbstractList.extend("BetaJS.Lists.ArrayList",{constructor:function(t,e){this.__idToIndex={},this.__items=[],e=e||{},"compare"in e&&(this._compare=e.compare),this._inherited(BetaJS.Lists.ArrayList,"constructor",t)},set_compare:function(t){this._compare=t,t&&this.sort()},get_compare:function(){return this._compare},sort:function(t){if(t=t||this._compare){this.__items.sort(t);for(var e=0;this.__items.length>e;++e)this.__ident_changed(this.__items[e],e);this._sorted()}},_sorted:function(){},re_index:function(t){if(!("_compare"in this))return t;for(var e=this.__items.length-1,i=this.__items[t],n=t;e>n&&this._compare(this.__items[n],this.__items[n+1])>0;)this.__items[n]=this.__items[n+1],this.__ident_changed(this.__items[n],n),this.__items[n+1]=i,++n;if(n==t)for(;n>0&&0>this._compare(this.__items[n],this.__items[n-1]);)this.__items[n]=this.__items[n-1],this.__ident_changed(this.__items[n],n),this.__items[n-1]=i,--n;return n!=t&&(this.__ident_changed(i,n),this._re_indexed(i)),n},_re_indexed:function(){},_add:function(t){var e=this.__items.length;this.__items.push(t);var i=this.re_index(e);return this.__idToIndex[BetaJS.Ids.objectId(t)]=i,i},_remove:function(t){for(var e=this.__items[t],i=t+1;this.__items.length>i;++i)this.__items[i-1]=this.__items[i],this.__ident_changed(this.__items[i-1],i-1);return this.__items.pop(),delete this.__idToIndex[BetaJS.Ids.objectId(e)],e},_get:function(t){return this.__items[t]},_iterate:function(t){for(var e=BetaJS.Objs.clone(this.__items,1),i=0;e.length>i;++i)t(e[i],this.get_ident(e[i]))},__ident_changed:function(t,e){this.__idToIndex[BetaJS.Ids.objectId(t)]=e,this._ident_changed(t,e)},get_ident:function(t){var e=BetaJS.Ids.objectId(t);return e in this.__idToIndex?this.__idToIndex[e]:null},ident_by_id:function(t){return this.__idToIndex[t]}}),BetaJS.Iterators={ensure:function(t){return null==t?new BetaJS.Iterators.ArrayIterator([]):t.instance_of(BetaJS.Iterators.Iterator)?t:BetaJS.Types.is_array(t)?new BetaJS.Iterators.ArrayIterator(t):new BetaJS.Iterators.ArrayIterator([t])}},BetaJS.Class.extend("BetaJS.Iterators.Iterator",{asArray:function(){for(var t=[];this.hasNext();)t.push(this.next());return t}}),BetaJS.Iterators.Iterator.extend("BetaJS.Iterators.ArrayIterator",{constructor:function(t){this._inherited(BetaJS.Iterators.ArrayIterator,"constructor"),this.__array=t,this.__i=0},hasNext:function(){return this.__i<this.__array.length},next:function(){return this.__array[this.__i++]}}),BetaJS.Iterators.ArrayIterator.extend("BetaJS.Iterators.ObjectKeysIterator",{constructor:function(t){this._inherited(BetaJS.Iterators.ObjectKeysIterator,"constructor",BetaJS.Objs.keys(t))}}),BetaJS.Iterators.ArrayIterator.extend("BetaJS.Iterators.ObjectValuesIterator",{constructor:function(t){this._inherited(BetaJS.Iterators.ObjectValuesIterator,"constructor",BetaJS.Objs.values(t))}}),BetaJS.Iterators.Iterator.extend("BetaJS.Iterators.MappedIterator",{constructor:function(t,e){this._inherited(BetaJS.Iterators.MappedIterator,"constructor"),this.__iterator=t,this.__map=e},hasNext:function(){return this.__iterator.hasNext()},next:function(){return this.hasNext()?this.__map(this.__iterator.next()):null}}),BetaJS.Iterators.Iterator.extend("BetaJS.Iterators.FilteredIterator",{constructor:function(t,e,i){this._inherited(BetaJS.Iterators.FilteredIterator,"constructor"),this.__iterator=t,this.__filter=e,this.__context=i||this,this.__next=null},hasNext:function(){return this.__crawl(),null!=this.__next},next:function(){this.__crawl();var t=this.__next;return this.__next=null,t},__crawl:function(){for(;null==this.__next&&this.__iterator.hasNext();){var t=this.__iterator.next();this.__filter_func(t)&&(this.__next=t)}},__filter_func:function(t){return this.__filter.apply(this.__context,[t])}}),BetaJS.Iterators.Iterator.extend("BetaJS.Iterators.SkipIterator",{constructor:function(t,e){for(this._inherited(BetaJS.Iterators.SkipIterator,"constructor"),this.__iterator=t;e>0;)t.next(),e--},hasNext:function(){return this.__iterator.hasNext()},next:function(){return this.__iterator.next()}}),BetaJS.Iterators.Iterator.extend("BetaJS.Iterators.LimitIterator",{constructor:function(t,e){this._inherited(BetaJS.Iterators.LimitIterator,"constructor"),this.__iterator=t,this.__limit=e},hasNext:function(){return this.__limit>0&&this.__iterator.hasNext()},next:function(){return 0>=this.__limit?null:(this.__limit--,this.__iterator.next())}}),BetaJS.Iterators.Iterator.extend("BetaJS.Iterators.SortedIterator",{constructor:function(t,e){this._inherited(BetaJS.Iterators.SortedIterator,"constructor"),this.__array=t.asArray(),this.__array.sort(e),this.__i=0},hasNext:function(){return this.__i<this.__array.length},next:function(){return this.__array[this.__i++]}}),BetaJS.Events={},BetaJS.Events.EVENT_SPLITTER=/\s+/,BetaJS.Events.EventsMixin={__create_event_object:function(t,e,i){i=i||{};var n={callback:t,context:e};return i.min_delay&&(n.min_delay=new BetaJS.Timers.Timer({delay:i.min_delay,once:!0,start:!1,context:this,fire:function(){n.max_delay&&n.max_delay.stop(),n.callback.apply(n.context||this,n.params)}})),i.max_delay&&(n.max_delay=new BetaJS.Timers.Timer({delay:i.max_delay,once:!0,start:!1,context:this,fire:function(){n.min_delay&&n.min_delay.stop(),n.callback.apply(n.context||this,n.params)}})),n},__destroy_event_object:function(t){t.min_delay&&t.min_delay.destroy(),t.max_delay&&t.max_delay.destroy()},__call_event_object:function(t,e){t.min_delay&&t.min_delay.restart(),t.max_delay&&t.max_delay.start(),t.min_delay||t.max_delay?t.params=e:t.callback.apply(t.context||this,e)},on:function(t,e,i,n){this.__events_mixin_events=this.__events_mixin_events||{},t=t.split(BetaJS.Events.EVENT_SPLITTER);for(var s;s=t.shift();)this.__events_mixin_events[s]=this.__events_mixin_events[s]||new BetaJS.Lists.LinkedList,this.__events_mixin_events[s].add(this.__create_event_object(e,i,n));return this},off:function(t,e,i){if(this.__events_mixin_events=this.__events_mixin_events||{},t){t=t.split(BetaJS.Events.EVENT_SPLITTER);for(var n;n=t.shift();)this.__events_mixin_events[n]&&(this.__events_mixin_events[n].remove_by_filter(function(t){var n=!(e&&t.callback!=e||i&&t.context!=i);return n&&this.__destroy_event_object&&this.__destroy_event_object(t),n}),0==this.__events_mixin_events[n].count()&&(this.__events_mixin_events[n].destroy(),delete this.__events_mixin_events[n]))}else for(n in this.__events_mixin_events)this.__events_mixin_events[n].remove_by_filter(function(t){var n=!(e&&t.callback!=e||i&&t.context!=i);return n&&this.__destroy_event_object&&this.__destroy_event_object(t),n}),0==this.__events_mixin_events[n].count()&&(this.__events_mixin_events[n].destroy(),delete this.__events_mixin_events[n]);return this},trigger:function(t){var e=this;t=t.split(BetaJS.Events.EVENT_SPLITTER);var i,n=Array.prototype.slice.call(arguments,1);if(this.__events_mixin_events){for(;i=t.shift();)this.__events_mixin_events&&this.__events_mixin_events[i]&&this.__events_mixin_events[i].iterate(function(t){e.__call_event_object(t,n)}),this.__events_mixin_events&&"all"in this.__events_mixin_events&&this.__events_mixin_events.all.iterate(function(t){e.__call_event_object(t,n)});return this}},once:function(t,e,i,n){var s=this,r=BetaJS.Functions.once(function(){s.off(t,r),e.apply(this,arguments)});return r._callback=e,this.on(name,r,i,n)},delegateEvents:function(t,e){BetaJS.Types.is_array(t)||(t=[t]),BetaJS.Objs.iter(t,function(t){e.on(t,function(){var e=Array.prototype.slice.call(arguments,0);this.trigger.apply(this,[t].concat(e))},this)},this)}},BetaJS.Class.extend("BetaJS.Events.Events",BetaJS.Events.EventsMixin),BetaJS.Events.ListenMixin={_notifications:{destroy:"listenOff"},listenOn:function(t,e,i,n){this.__listen_mixin_listen||(this.__listen_mixin_listen={}),this.__listen_mixin_listen[BetaJS.Ids.objectId(t)]=t,t.on(e,i,this,n)},listenOnce:function(t,e,i,n){this.__listen_mixin_listen||(this.__listen_mixin_listen={}),this.__listen_mixin_listen[BetaJS.Ids.objectId(t)]=t,t.once(e,i,this,n)},listenOff:function(t,e,i){this.__listen_mixin_listen&&(t?(t.off(e,i,this),e||i||delete this.__listen_mixin_listen[BetaJS.Ids.objectId(t)]):BetaJS.Objs.iter(this.__listen_mixin_listen,function(t){t.off(e,i,this),e||i||delete this.__listen_mixin_listen[BetaJS.Ids.objectId(t)]},this))}},BetaJS.Class.extend("BetaJS.Events.Listen",BetaJS.Events.ListenMixin),BetaJS.Classes={},BetaJS.Classes.AutoDestroyMixin={_notifications:{construct:"__initialize_auto_destroy",destroy:"__finalize_auto_destroy"},__initialize_auto_destroy:function(){this.__auto_destroy={}},__finalize_auto_destroy:function(){var t=this.__auto_destroy;this.__auto_destroy={},BetaJS.Objs.iter(t,function(t){t.unregister(this)},this)},register_auto_destroy:function(t){t.cid()in this.__auto_destroy||(this.__auto_destroy[t.cid()]=t,t.register(this),this._notify("register_auto_destroy",t))},unregister_auto_destroy:function(t){t.cid()in this.__auto_destroy&&(this._notify("unregister_auto_destroy",t),delete this.__auto_destroy[t.cid()],t.unregister(this),BetaJS.Types.is_empty(this.__auto_destroy)&&this.destroy())}},BetaJS.Class.extend("BetaJS.Classes.AutoDestroyObject",[BetaJS.Ids.ClientIdMixin,{constructor:function(){this._inherited(BetaJS.Classes.AutoDestroyObject,"constructor"),this.__objects={}},register:function(t){var e=BetaJS.Ids.objectId(t);e in this.__objects||(this.__objects[e]=t,t.register_auto_destroy(this))},unregister:function(t){var e=BetaJS.Ids.objectId(t);e in this.__objects&&(delete this.__objects[e],t.unregister_auto_destroy(this))},clear:function(){BetaJS.Objs.iter(this.__objects,function(t){this.unregister(t)},this)}}]),BetaJS.Class.extend("BetaJS.Classes.ObjectCache",[BetaJS.Events.EventsMixin,{constructor:function(t){this._inherited(BetaJS.Classes.ObjectCache,"constructor"),this.__size="size"in t?t.size:null,this.__destroy_on_remove="destroy_on_remove"in t?t.destroy_on_remove:!0,this.__id_to_container={},this.__first=null,this.__last=null,this.__count=0},destroy:function(){this.clear(),this._inherited(BetaJS.Classes.ObjectCache,"destroy")},add:function(t){if(!this.get(t)){null!=this.__size&&this.__count>=this.__size&&this.__first&&this.remove(this.__first.object);var e={object:t,prev:this.__last,next:null};this.__id_to_container[BetaJS.Ids.objectId(t)]=e,this.__first?this.__last.next=e:this.__first=e,this.__last=e,this.__count++,this.trigger("cache",t)}},remove:function(t){BetaJS.Class.is_class_instance(t)&&(t=BetaJS.Ids.objectId(t));var e=this.__id_to_container[t];e&&(delete this.__id_to_container[t],e.next?e.next.prev=e.prev:this.__last=e.prev,e.prev?e.prev.next=e.next:this.__first=e.next,this.__count--,this.trigger("release",e.object),this.__destroy_on_remove&&e.object.destroy())},get:function(t){return BetaJS.Class.is_class_instance(t)&&(t=BetaJS.Ids.objectId(t)),this.__id_to_container[t]?this.__id_to_container[t].object:null},clear:function(){BetaJS.Objs.iter(this.__id_to_container,function(t){this.remove(t.object)},this)}}]),BetaJS.Classes.ModuleMixin={_notifications:{construct:function(){this.__modules={}},destroy:function(){BetaJS.Objs.iter(this.__modules,this.remove_module,this)}},add_module:function(t){t.cid()in this.__modules||(this.__modules[t.cid()]=t,t.register(this),this._notify("add_module",t))},remove_module:function(t){t.cid()in this.__modules&&(delete this.__modules[t.cid()],t.unregister(this),this._notify("remove_module",t))}},BetaJS.Class.extend("BetaJS.Classes.Module",[BetaJS.Ids.ClientIdMixin,{constructor:function(t){this._inherited(BetaJS.Classes.Module,"constructor"),this._objects={},this.__auto_destroy="auto_destroy"in t?t.auto_destroy:!0},destroy:function(){BetaJS.Objs.iter(this._objects,this.unregister,this),this._inherited(BetaJS.Classes.Module,"destroy")},register:function(t){var e=BetaJS.Ids.objectId(t);if(!(e in this._objects)){var i={};this._objects[e]={object:t,data:i},t.add_module(this),this._register(t,i)}},_register:function(){},unregister:function(t){var e=BetaJS.Ids.objectId(t);if(e in this._objects){var i=this._objects[e].data;this._unregister(t,i),delete this._objects[e],t.remove_module(this),"off"in t&&t.off(null,null,this),this.__auto_destroy&&BetaJS.Types.is_empty(this._objects)&&this.destroy()}},_unregister:function(){},_data:function(t){return this._objects[BetaJS.Ids.objectId(t)].data}}],{__instance:null,singleton:function(){return this.__instance||(this.__instance=new this({auto_destroy:!1})),this.__instance}}),BetaJS.Properties={},BetaJS.Properties.TYPE_VALUE=0,BetaJS.Properties.TYPE_BINDING=1,BetaJS.Properties.TYPE_COMPUTED=2,BetaJS.Properties.PropertiesMixin={get:function(t){return t in this.__properties?this.__properties[t].value:null},_canSet:function(){return!0},_beforeSet:function(t,e){return e},_afterSet:function(){},has:function(t){return t in this.__properties},setAll:function(t,e){for(var i in t)this.set(i,t[i],e)},keys:function(t){return BetaJS.Objs.keys(this.__properties,t)},binding:function(t){return{type:BetaJS.Properties.TYPE_BINDING,bindee:this,property:t}},computed:function(t,e){return{type:BetaJS.Properties.TYPE_COMPUTED,func:t,dependencies:e||[]}},_isBinding:function(t){return BetaJS.Types.is_object(t)&&t&&t.type&&t.type==BetaJS.Properties.TYPE_BINDING&&t.bindee&&t.property},_isComputed:function(t){return BetaJS.Types.is_object(t)&&t&&t.type&&t.type==BetaJS.Properties.TYPE_COMPUTED&&t.func&&t.dependencies},getAll:function(){var t={};for(var e in this.__properties)t[e]=this.get(e);return t},unset:function(t){if(t in this.__properties){var e=this.__properties[t];if(e.type==BetaJS.Properties.TYPE_BINDING)e.bindee.off("change:"+e.property,null,this.__properties[t]);else if(e.type==BetaJS.Properties.TYPE_COMPUTED){var i=this;BetaJS.Objs.iter(e.dependencies,function(n){this._isBinding(n)?n.bindee.off("change:"+n.property,null,this.__properties[t]):this._isTimer(n)?e.timers[n].destroy:i.off("change:"+n,null,this.__properties[t])},this)}delete this.__properties[t]}},_set_changed:function(t,e,i){this._afterSet(t,this.get(t),e,i),this.trigger("change",t,this.get(t),e,i),this.trigger("change:"+t,this.get(t),e,i)},_isTimer:function(){return BetaJS.Strings.starts_with("dep","timer:")},_parseTimer:function(){return parseInt(BetaJS.Strings.strip_start("timer:"))},set:function(t,e,i){var n=this.get(t);if(n!=e){var s=this;this.__properties[t],this._isBinding(e)?(this.unset(t),this.__properties[t]={type:BetaJS.Properties.TYPE_BINDING,bindee:e.bindee,property:e.property,value:e.bindee.get(e.property)},e.bindee.on("change:"+e.property,function(){var i=s.__properties[t].value;s.__properties[t].value=e.bindee.get(e.property),s._set_changed(t,i)},this.__properties[t]),this._set_changed(t,n,i)):this._isComputed(e)?(this.unset(t),this.__properties[t]={type:BetaJS.Properties.TYPE_COMPUTED,func:e.func,dependencies:e.dependencies,value:e.func.apply(s),timers:{}},BetaJS.Objs.iter(e.dependencies,function(i){this._isBinding(i)?i.bindee.on("change:"+i.property,function(){var i=s.__properties[t].value;s.__properties[t].value=e.func.apply(s),s._set_changed(t,i)},this.__properties[t]):this._isTimer(i)?this.__properties[t].timers[i]=new BetaJS.Timers.Timer({delay:this._parseTimer(i),fire:function(){var i=s.__properties[t].value;s.__properties[t].value=e.func.apply(s),s._set_changed(t,i)}}):s.on("change:"+i,function(){var i=s.__properties[t].value;s.__properties[t].value=e.func.apply(s),s._set_changed(t,i)},this.__properties[t])},this),this._set_changed(t,n)):(e=this._beforeSet(t,e),this._canSet(t,e)&&(this.__properties[t]&&this.__properties[t].type==BetaJS.Properties.TYPE_BINDING?this.__properties[t].bindee.set(this.__properties[t].property,e):(this.unset(t),this.__properties[t]={type:BetaJS.Properties.TYPE_VALUE,value:e},this._set_changed(t,n,i))))}},_notifications:{construct:"__properties_construct",destroy:"__properties_destroy"},__properties_construct:function(){this.__properties={}},__properties_destroy:function(){for(var t in this.__properties)this.unset(t)}},BetaJS.Class.extend("BetaJS.Properties.Properties",[BetaJS.Events.EventsMixin,BetaJS.Properties.PropertiesMixin,{constructor:function(t){this._inherited(BetaJS.Properties.Properties,"constructor"),t&&this.setAll(t)}}]),BetaJS.Class.extend("BetaJS.Collections.Collection",[BetaJS.Ids.ClientIdMixin,BetaJS.Events.EventsMixin,{constructor:function(t){this._inherited(BetaJS.Collections.Collection,"constructor"),t=t||{};var e={};"compare"in t&&(e.compare=t.compare),this.__data=new BetaJS.Lists.ArrayList([],e);var i=this;this.__data._ident_changed=function(t,e){i._index_changed(t,e)},this.__data._re_indexed=function(t){i._re_indexed(t)},this.__data._sorted=function(){i._sorted()},"objects"in t&&this.add_objects(t.objects)},set_compare:function(t){this.__data.set_compare(t)},get_compare:function(){this.__data.get_compare()},destroy:function(){this.__data.iterate(function(t){"off"in t&&t.off(null,null,this)}),this.__data.destroy(),this.trigger("destroy"),this._inherited(BetaJS.Collections.Collection,"destroy")},count:function(){return this.__data.count()},_index_changed:function(t,e){this.trigger("index",t,e)},_re_indexed:function(t){this.trigger("reindexed",t)},_sorted:function(){this.trigger("sorted")},_object_changed:function(t,e,i){this.trigger("change",t,e,i),this.trigger("change:"+e,t,i),this.__data.re_index(this.getIndex(t))},add:function(t){if(this.exists(t))return null;var e=this.__data.add(t);return null!=e&&(this.trigger("add",t),"on"in t&&t.on("change",function(e,i){this._object_changed(t,e,i)},this)),e},add_objects:function(t){BetaJS.Objs.iter(t,function(t){this.add(t)},this)},exists:function(t){return this.__data.exists(t)},remove:function(t){if(!this.exists(t))return null;this.trigger("remove",t),"off"in t&&t.off(null,null,this);var e=this.__data.remove(t);return e},getByIndex:function(t){return this.__data.get(t)},getById:function(t){return this.__data.get(this.__data.ident_by_id(t))},getIndex:function(t){return this.__data.get_ident(t)},iterate:function(t){this.__data.iterate(t)},clear:function(){var t=this;this.iterate(function(e){t.remove(e)})}}]),BetaJS.Collections.Collection.extend("BetaJS.Collections.FilteredCollection",{constructor:function(t,e){this.__parent=t,e=e||{},delete e.objects,e.compare=e.compare||t.get_compare(),this._inherited(BetaJS.Collections.FilteredCollection,"constructor",e),"filter"in e&&(this.filter=e.filter);var i=this;this.__parent.iterate(function(t){return i.add(t),!0}),this.__parent.on("add",this.add,this),this.__parent.on("remove",this.remove,this)},filter:function(){return!0},_object_changed:function(t,e,i){this._inherited(BetaJS.Collections.FilteredCollection,"_object_changed",t,e,i),this.filter(t)||this.__selfRemove(t)},destroy:function(){this.__parent.off(null,null,this),this._inherited(BetaJS.Collections.FilteredCollection,"destroy")},__selfAdd:function(t){return this._inherited(BetaJS.Collections.FilteredCollection,"add",t)},add:function(t){if(this.exists(t)||!this.filter(t))return null;var e=this.__selfAdd(t);return this.__parent.add(t),e},__selfRemove:function(t){return this._inherited(BetaJS.Collections.FilteredCollection,"remove",t)},remove:function(t){if(!this.exists(t))return null;var e=this.__selfRemove(t);return null==e?null:this.__parent.remove(t)}}),BetaJS.Comparators={byObject:function(t){return function(e,i){for(key in t){var n=e[key]||null,s=i[key]||null,r=BetaJS.Comparators.byValue(n,s);if(0!=r)return r*t[key]}return 0}},byValue:function(t,e){return BetaJS.Types.is_string(t)?t.localCompare(e):e>t?-1:t>e?1:0}},BetaJS.Sort={dependency_sort:function(t,e,i,n){for(var s=BetaJS.Types.is_string(e)?function(t){return t[e]}:e,r=BetaJS.Types.is_string(i)?function(t){return t[i]}:i,o=BetaJS.Types.is_string(n)?function(t){return t[n]}:n,_=t.length,a=[],c={},u={},h=0;_>h;++h){u[h]=!0;var d=s(t[h],h);c[d]=h,a.push({before:{},after:{}})}for(var h=0;_>h;++h)BetaJS.Objs.iter(r(t[h],h)||[],function(t){var e=c[t];BetaJS.Types.is_defined(e)&&(a[h].before[e]=!0,a[e].after[h]=!0)
}),BetaJS.Objs.iter(o(t[h])||[],function(t){var e=c[t];BetaJS.Types.is_defined(e)&&(a[h].after[e]=!0,a[e].before[h]=!0)});for(var f=[];!BetaJS.Types.is_empty(u);)for(var h in u)if(BetaJS.Types.is_empty(a[h].after)){delete u[h],f.push(t[h]);for(var i in a[h].before)delete a[i].after[h]}return f}},BetaJS.Tokens={generate_token:function(t){t=t||16;for(var e="";t>e.length;)e+=Math.random().toString(36).substr(2);return e.substr(0,t)}},BetaJS.Locales={__data:{},get:function(t){return t in this.__data?this.__data[t]:t},register:function(t,e){e=e?e+".":"";for(var i in t)this.__data[e+i]=t[i]}},BetaJS.Time={format_time:function(t,e){var i=this.seconds(t),n=this.minutes(t),s=this.hours(t),r={hh:10>s?"0"+s:s,h:s,mm:10>n?"0"+n:n,m:n,ss:10>i?"0"+i:i,s:i};for(var o in r)e=e.replace(o,r[o]);return e},make:function(t){var e=0,i={hours:60,minutes:60,seconds:60,milliseconds:1e3};for(var n in i)e*=i[n],n in t&&(e+=t[n]);return e},seconds:function(t){return Math.floor(t/1e3)%60},minutes:function(t){return Math.floor(t/60/1e3)%60},hours:function(t){return Math.floor(t/60/60/1e3)%24},days:function(t){return Math.floor(t/24/60/60/1e3)},now:function(){var t=new Date;return t.getTime()},ago:function(t){return this.now()-t},days_ago:function(t){return this.days(this.ago(t))},format_ago:function(t){return this.days_ago(t)>1?this.format(t,{time:!1}):this.format_period(Math.max(this.ago(t),0))+" ago"},format_period:function(t){return t=Math.round(t/1e3),60>t?t+" "+BetaJS.Locales.get(1==t?"second":"seconds"):(t=Math.round(t/60),60>t?t+" "+BetaJS.Locales.get(1==t?"minute":"minutes"):(t=Math.round(t/60),24>t?t+" "+BetaJS.Locales.get(1==t?"hour":"hours"):(t=Math.round(t/24),t+" "+BetaJS.Locales.get(1==t?"day":"days"))))},format:function(t,e){e=BetaJS.Objs.extend({time:!0,date:!0,locale:!0},e||{});var i=new Date(t);return e.locale?e.date?e.time?i.toLocaleString():i.toLocaleDateString():i.toLocaleTimeString():e.date?e.time?""+i:i.toDateString():i.toTimeString()}},BetaJS.Class.extend("BetaJS.Timers.Timer",{constructor:function(t){this._inherited(BetaJS.Timers.Timer,"constructor"),t=BetaJS.Objs.extend({once:!1,start:!0,fire:null,context:this,destroy_on_fire:!1},t),this.__delay=t.delay,this.__destroy_on_fire=t.destroy_on_fire,this.__once=t.once,this.__fire=t.fire,this.__context=t.context,this.__started=!1,t.start&&this.start()},destroy:function(){this.stop(),this._inherited(BetaJS.Timers.Timer,"destroy")},fire:function(){this.__once&&(this.__started=!1),this.__fire&&this.__fire.apply(this.__context,[this]),this.__destroy_on_fire&&this.destroy()},stop:function(){this.__started&&(this.__once?clearTimeout(this.__timer):clearInterval(this.__timer),this.__started=!1)},start:function(){if(!this.__started){var t=this;this.__timer=this.__once?setTimeout(function(){t.fire()},this.__delay):setInterval(function(){t.fire()},this.__delay),this.__started=!0}},restart:function(){this.stop(),this.start()}}),BetaJS.Net=BetaJS.Net||{},BetaJS.Net.HttpHeader={HTTP_STATUS_OK:200,HTTP_STATUS_CREATED:201,HTTP_STATUS_PAYMENT_REQUIRED:402,HTTP_STATUS_FORBIDDEN:403,HTTP_STATUS_NOT_FOUND:404,HTTP_STATUS_PRECONDITION_FAILED:412,HTTP_STATUS_INTERNAL_SERVER_ERROR:500,format:function(t,e){var i="";return i=t==this.HTTP_STATUS_OK?"OK":t==this.HTTP_STATUS_CREATED?"Created":t==this.HTTP_STATUS_PAYMENT_REQUIRED?"Payment Required":t==this.HTTP_STATUS_FORBIDDEN?"Forbidden":t==this.HTTP_STATUS_NOT_FOUND?"Not found":t==this.HTTP_STATUS_PRECONDITION_FAILED?"Precondition Failed":t==this.HTTP_STATUS_INTERNAL_SERVER_ERROR?"Internal Server Error":"Other Error",e?t+" "+i:i}},BetaJS.Net=BetaJS.Net||{},BetaJS.Net.Uri={encodeUriParams:function(t,e){e=e||"";var i=[];return BetaJS.Objs.iter(t,function(t,n){BetaJS.Types.is_object(t)?i=i.concat(this.encodeUriParams(t,e+n+"_")):i.push(e+n+"="+encodeURI(t))},this),i.join("&")},parse:function(t,e){for(var i=e?this.__parse_strict_regex:this.__parse_loose_regex,n=i.exec(t),s={},r=14;r--;)s[this.__parse_key[r]]=n[r]||"";return s.queryKey={},s[this.__parse_key[12]].replace(this.__parse_key_parser,function(t,e,i){e&&(s.queryKey[e]=i)}),s},__parse_strict_regex:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,__parse_loose_regex:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,__parse_key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],__parse_key_parser:/(?:^|&)([^&=]*)=?([^&]*)/g};