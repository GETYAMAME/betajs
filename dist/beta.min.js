/*! betajs - v0.0.1 - 2013-04-08, Copyright (c) Oliver Friedmann & Victor Lingenthal, MIT Software License. */var BetaJS=BetaJS||{};BetaJS.Types={is_object:function(t){return"object"==typeof t},is_array:function(t){return"[object Array]"==toString.call(t)},is_undefined:function(t){return t===void 0},is_null:function(t){return null==t},is_none:function(t){return this.is_undefined(t)||this.is_null(t)},is_defined:function(t){return t!==void 0},is_empty:function(t){if(this.is_none(t))return!0;if(this.is_array(t))return 0==t.length;if(this.is_object(t)){for(var e in t)return!1;return!0}return!1},is_string:function(t){return"string"==typeof t},is_function:function(t){return"function"==typeof t}},BetaJS.Strings={nl2br:function(t){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},htmlentities:function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},JS_ESCAPES:{"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},JS_ESCAPER_REGEX:function(){return this.JS_ESCAPER_REGEX_CACHED||(this.JS_ESCAPER_REGEX_CACHED=RegExp(BetaJS.Objs.keys(this.JS_ESCAPES).join("|"),"g")),this.JS_ESCAPER_REGEX_CACHED},js_escape:function(t){var e=this;return t.replace(this.JS_ESCAPER_REGEX(),function(t){return"\\"+e.JS_ESCAPES[t]})}},BetaJS.Functions={as_method:function(t,e){return function(){return t.apply(e,arguments)}},once:function(t){var e,i=!1;return function(){return i?e:(i=!0,e=t.apply(this,arguments),t=null,e)}}},BetaJS.Objs={clone:function(t,e){return BetaJS.Types.is_object(t)&&e&&e>0?this.extend({},t,e-1):t},extend:function(t,e,i){for(var n in e)t[n]=this.clone(e[n],i);return t},keys:function(t,e){if(BetaJS.Types.is_undefined(e)){var i=[];for(var n in t)i.push(n);return i}var i={};for(var n in t)i[n]=e;return i},values:function(t){var e=[];for(var i in t)e.push(t[i]);return e},equals:function(t,e,i){if(i&&i>0){for(var n in t)if(!n in e||!this.equals(t[n],e[n],i-1))return!1;for(var n in e)if(!n in t)return!1;return!0}return t==e},iter:function(t,e,i){if(BetaJS.Types.is_array(t))for(var n=0;t.length>n;++n){var s=i?e.apply(i,[t[n],n]):e(t[n],n);if(BetaJS.Types.is_defined(s)&&!s)return}else for(var r in t){var s=i?e.apply(i,[t[r],r]):e(t[r],r);if(BetaJS.Types.is_defined(s)&&!s)return}}},BetaJS.Ids={__uniqueId:0,uniqueId:function(t){return(t||"")+this.__uniqueId++},objectId:function(t){return t.__cid||(t.__cid=this.uniqueId("cid_")),t.__cid}},BetaJS.Ids.ClientIdMixin={cid:function(){return BetaJS.Ids.objectId(this)}},BetaJS.Class=function(){},BetaJS.Class.classname="Class",BetaJS.Class.extend=function(t,e,i,n){e=e||[],BetaJS.Types.is_array(e)||(e=[e]),i=i||[],BetaJS.Types.is_array(i)||(i=[i]),n=n||[],BetaJS.Types.is_array(n)||(n=[n]);var s,r=this;BetaJS.Objs.iter(e,function(t){t.hasOwnProperty("constructor")&&(s=t.constructor)}),BetaJS.Types.is_defined(s)||(s=function(){r.apply(this,arguments)}),BetaJS.Objs.extend(s,r),BetaJS.Objs.iter(i,function(t){BetaJS.Objs.extend(s,t)});var o={};if(r.__class_statics_keys)for(var a in r.__class_statics_keys)s[a]=BetaJS.Objs.clone(r[a],1);BetaJS.Objs.iter(n,function(t){BetaJS.Objs.extend(s,t),BetaJS.Objs.extend(o,BetaJS.Objs.keys(t,!0))}),r.__class_statics_keys&&BetaJS.Objs.extend(o,r.__class_statics_keys),s.__class_statics_keys=o,s.parent=r,s.children=[],s.extend=this.extend,r.children||(r.children=[]),r.children.push(s);var _=function(){};return _.prototype=r.prototype,s.prototype=new _,s.prototype.cls=s,s.classname=t,s.__notifications={},r.__notifications&&BetaJS.Objs.extend(s.__notifications,r.__notifications),BetaJS.Objs.iter(e,function(t){if(BetaJS.Objs.extend(s.prototype,t),t._notifications)for(var e in t._notifications)s.__notifications[e]||(s.__notifications[e]=[]),s.__notifications[e].push(t._notifications[e])}),delete s.prototype._notifications,s},BetaJS.Class.prototype.constructor=function(){this._notify("construct")},BetaJS.Class.prototype._notify=function(t){if(this.cls.__notifications){var e=Array.prototype.slice.call(arguments,1),i=this.cls.__notifications[t];if(i)for(var n in i)this[i[n]].apply(this,e)}},BetaJS.Class.prototype.destroy=function(){this._notify("destroy");for(var t in this)delete this[t]},BetaJS.Class.prototype._inherited=function(t,e){return t.parent.prototype[e].apply(this,Array.prototype.slice.apply(arguments,[2]))},BetaJS.Class._inherited=function(t,e){return t.parent[e].apply(this,Array.prototype.slice.apply(arguments,[2]))},BetaJS.Class.prototype.cls=BetaJS.Class,BetaJS.Class.__notifications={},BetaJS.Classes={},BetaJS.Classes.AutoDestroyMixin={enter:function(){this.__enter_count||(this.__enter_count=0),this.__enter_count++},leave:function(){this.__enter_count||(this.__enter_count=0),this.__enter_count--,1>this.__enter_count&&this.destroy()}},BetaJS.Lists={},BetaJS.Lists.AbstractList=BetaJS.Class.extend("AbstractList",{_add:function(){},_remove:function(){},_get:function(){},_iterate:function(){},constructor:function(){this._inherited(BetaJS.Lists.AbstractList,"constructor"),this.__count=0},add:function(t){var e=this._add(t);return BetaJS.Types.is_defined(e)&&this.__count++,e},count:function(){return this.__count},clear:function(){var t=this;this._iterate(function(e,i){return t.remove_by_ident(i),!0})},remove_by_ident:function(t){var e=this._remove(t);return BetaJS.Types.is_defined(e)&&this.__count--,e},getIdent:function(t){var e=null;return this._iterate(function(e,i){return e==t?(ident=i,!1):!0}),e},remove:function(t){return this.remove_by_ident(this.getIdent(t))},remove_by_filter:function(t){var e=this;this._iterate(function(i,n){return t(i)&&e.remove_by_ident(n),!0})},get:function(t){return this._get(t)},iterate:function(t){this._iterate(function(e,i){var n=t(e,i);return BetaJS.Types.is_defined(n)?n:!0})}}),BetaJS.Lists.IdObjectList=BetaJS.Lists.AbstractList.extend("IdObjectList",{constructor:function(){this._inherited(BetaJS.Lists.IdObjectList,"constructor"),this.__objects={},this.__last_id=0},_add:function(t){var e=this.__last_id++;return this.__objects[e]=t,e},_get:function(t){return this.__objects[t]},_remove:function(t){var e=this.__objects[t];return delete this.__objects[t],e},_iterate:function(t){for(var e in this.__objects)if(!t(this.__objects[e],e))return}}),BetaJS.Lists.LinkedList=BetaJS.Lists.AbstractList.extend("LinkedList",{constructor:function(){this._inherited(BetaJS.Lists.LinkedList,"constructor"),this.__first=null,this.__last=null},_add:function(t){return this.__last={obj:t,prev:this.__last,next:null},this.__first?this.__last.prev.next=this.__last:this.__first=this.__last,this.__last},_remove:function(t){return t.next?t.next.prev=t.prev:this.__last=t.prev,t.prev?t.prev.next=t.next:this.__first=t.next,t.obj},_get:function(t){return t.obj},_iterate:function(t){for(var e=this.__first;null!=e;){var i=e;if(e=e.next,!t(i.obj,i))return}}}),BetaJS.Iterators={},BetaJS.Iterators.Iterator=BetaJS.Class.extend("Iterator"),BetaJS.Iterators.ArrayIterator=BetaJS.Iterators.Iterator.extend("ArrayIterator",{constructor:function(t){this._inherited(BetaJS.Iterators.ArrayIterator,"constructor"),this.__arr=t,this.__i=0},hasNext:function(){return this.__i<this.__arr.length},next:function(){return this.__arr[this.__i++]}}),BetaJS.Iterators.MappedIterator=BetaJS.Iterators.Iterator.extend("MappedIterator",{constructor:function(t,e){this._inherited(BetaJS.Iterators.MappedIterator,"constructor"),this.__iterator=t,this.__map=e},hasNext:function(){return this.__iterator.hasNext()},next:function(){return this.__map(this.__iterator.next())}}),BetaJS.Events={},BetaJS.Events.EVENT_SPLITTER=/\s+/,BetaJS.Events.EventsMixin={on:function(t,e,i){this.__events=this.__events||{},t=t.split(BetaJS.Events.EVENT_SPLITTER);for(var n;n=t.shift();)this.__events[n]=this.__events[n]||new BetaJS.Lists.LinkedList,this.__events[n].add({callback:e,context:i});return this},off:function(t,e,i){this.__events=this.__events||{},t=t.split(BetaJS.Events.EVENT_SPLITTER);for(var n;n=t.shift();)this.__events[n]&&(this.__events[n].remove_by_filter(function(t){return!(e&&t.callback!=e||i&&t.context!=i)}),0==this.__events[n].count()&&(this.__events[n].destroy(),delete this.__events[n]));return this},trigger:function(t){var e=this;t=t.split(BetaJS.Events.EVENT_SPLITTER);var i,n=Array.prototype.slice.call(arguments,1);if(this.__events){for(;i=t.shift();)this.__events[i]&&this.__events[i].iterate(function(t){t.callback.apply(t.context||e,n)}),this.__events.all&&this.__events.all.iterate(function(t){t.callback.apply(t.context||e,n)});return this}},once:function(t,e,i){var n=this,s=BetaJS.Functions.once(function(){n.off(t,s),e.apply(this,arguments)});return s._callback=e,this.on(name,s,i)}},BetaJS.Events.Events=BetaJS.Class.extend("Events",BetaJS.Events.EventsMixin),BetaJS.Events.ListenMixin={_notifications:{destroy:"listenOff"},listenOn:function(t,e,i){this.__listen||(this.__listen={}),this.__listen[BetaJS.Ids.objectId(t)]=t,t.on(e,i,this)},listenOnce:function(t,e,i){this.__listen||(this.__listen={}),this.__listen[BetaJS.Ids.objectId(t)]=t,t.once(e,i,this)},listenOff:function(t,e,i){this.__listen&&(t?(t.off(e,i,this),e||i||delete this.__listen[BetaJS.Ids.objectId(t)]):BetaJS.Objs.iter(this.__listen,function(t){t.off(e,i,this),e||i||delete this.__listen[BetaJS.Ids.objectId(t)]},this))}},BetaJS.Events.Listen=BetaJS.Class.extend("Listen",BetaJS.Events.ListenMixin),BetaJS.Properties={},BetaJS.Properties.PropertiesMixin={get:function(t){return this.__properties?this.__properties[t]:null},set:function(t,e){this.__properties||(this.__properties={}),(!t in this.__properties||this.__properties[t]!=e)&&(this.__properties[t]=e,this.trigger("change"),this.trigger("change:"+t))},getAll:function(){return BetaJS.Objs.clone(this.__properties||{},1)},setAll:function(t){for(var e in t)this.set(e,t[e])}},BetaJS.Properties.Properties=BetaJS.Class.extend("Properties",[BetaJS.Events.EventsMixin,BetaJS.Properties.PropertiesMixin,{constructor:function(t){this._inherited(BetaJS.Properties.Properties,"constructor"),t&&this.setAll(t)}}]),BetaJS.Properties.BindablePropertiesMixin={_notifications:{construct:"__bindable_properties_construct",destroy:"__bindable_properties_destroy"},__bindable_properties_construct:function(){this.__properties={}},__bindable_properties_destroy:function(){for(var t in this.__properties)this.__bindable_remove(t)},__bindable_remove:function(t){var e=this.__properties[t];e.bindee&&e.bindee.off("change:"+e.property,null,this),delete this.__properties[t]},get:function(t){var e=this.__properties[t];return null==e?null:e.bindee?e.bindee.get(e.property):e.value},set:function(t,e){if(this.get(t)!=e){var i=this.__properties[t];e.bindee&&e.property?(i&&this.__bindable_remove(t),this.__properties[t]=e,e.bindee.on("change:"+e.property,function(){this.trigger("change"),this.trigger("change:"+t)},this)):i&&i.bindee?i.bindee.set(i.property,e):this.__properties[t]={value:e},this.trigger("change"),this.trigger("change:"+t)}},binding:function(t){return{bindee:this,property:t}},getAll:function(){var t={};for(var e in this.__properties)t[e]=this.get(e);return t},setAll:function(t){for(var e in t)this.set(e,t[e])}},BetaJS.Properties.BindableProperties=BetaJS.Class.extend("BindableProperties",[BetaJS.Events.EventsMixin,BetaJS.Properties.BindablePropertiesMixin,{constructor:function(t){this._inherited(BetaJS.Properties.BindableProperties,"constructor"),t&&this.setAll(t)}}]);