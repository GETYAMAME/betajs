/*! betajs - v0.0.1 - 2013-03-20, Copyright (c) Oliver Friedmann & Victor Lingenthal, MIT Software License. */var BetaJS=BetaJS||{};BetaJS.Types={is_object:function(t){return"object"==typeof t},is_array:function(t){return"[object Array]"==toString.call(t)},is_undefined:function(t){return t===void 0},is_null:function(t){return null==t},is_none:function(t){return this.is_undefined(t)||this.is_null(t)},is_defined:function(t){return t!==void 0},is_empty:function(t){if(this.is_none(t))return!0;if(this.is_array(t))return 0==t.length;if(this.is_object(t)){for(var e in t)return!1;return!0}return!1},is_string:function(t){return"string"==typeof t},is_function:function(t){return"function"==typeof t}},BetaJS.Strings={nl2br:function(t){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br />$2")},htmlentities:function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}},BetaJS.Functions={as_method:function(t,e){return function(){return t.apply(e,arguments)}}},BetaJS.Objs={clone:function(t,e){return BetaJS.Types.is_object(t)&&e&&e>0?this.extend({},t,e-1):t},extend:function(t,e,n){for(var i in e)t[i]=this.clone(e[i],n);return t},keys:function(t,e){if(BetaJS.Types.is_undefined(e)){var n=[];for(var i in t)n.push(i);return n}var n={};for(var i in t)n[i]=e;return n},values:function(t){var e=[];for(var n in t)e.push(t[n]);return e},equals:function(t,e,n){if(n&&n>0){for(var i in t)if(!i in e||!this.equals(t[i],e[i],n-1))return!1;for(var i in e)if(!i in t)return!1;return!0}return t==e},iter:function(t,e,n){if(BetaJS.Types.is_array(t))for(var i=0;t.length>i;++i){var s=n?e.apply(n,[t[i],i]):e(t[i],i);if(BetaJS.Types.is_defined(s)&&!s)return}else for(var r in t){var s=n?e.apply(n,[t[r],r]):e(t[r],r);if(BetaJS.Types.is_defined(s)&&!s)return}}},BetaJS.Ids={__uniqueId:0,uniqueId:function(t){return(t||"")+this.__uniqueId++}},BetaJS.Ids.ClientIdMixin={cid:function(){return this.__cid||(this.__cid=BetaJS.Ids.uniqueId("cid_")),this.__cid}},BetaJS.Class=function(){},BetaJS.Class.classname="Class",BetaJS.Class.extend=function(t,e,n,i){e=e||[],BetaJS.Types.is_array(e)||(e=[e]),n=n||[],BetaJS.Types.is_array(n)||(n=[n]),i=i||[],BetaJS.Types.is_array(i)||(i=[i]);var s,r=this;BetaJS.Objs.iter(e,function(t){t.hasOwnProperty("constructor")&&(s=t.constructor)}),BetaJS.Types.is_defined(s)||(s=function(){r.apply(this,arguments)}),BetaJS.Objs.extend(s,r),BetaJS.Objs.iter(n,function(t){BetaJS.Objs.extend(s,t)});var a={};if(r.__class_statics_keys)for(var o in r.__class_statics_keys)s[o]=BetaJS.Objs.clone(r[o],1);BetaJS.Objs.iter(i,function(t){BetaJS.Objs.extend(s,t),BetaJS.Objs.extend(a,BetaJS.Objs.keys(t,!0))}),r.__class_statics_keys&&BetaJS.Objs.extend(a,r.__class_statics_keys),s.__class_statics_keys=a,s.parent=r,s.children=[],s.extend=this.extend,r.children||(r.children=[]),r.children.push(s);var _=function(){};return _.prototype=r.prototype,s.prototype=new _,s.prototype.cls=s,s.classname=t,s.__notifications={},r.__notifications&&BetaJS.Objs.extend(s.__notifications,r.__notifications),BetaJS.Objs.iter(e,function(t){if(BetaJS.Objs.extend(s.prototype,t),t._notifications)for(var e in t._notifications)s.__notifications[e]||(s.__notifications[e]=[]),s.__notifications[e].push(t._notifications[e])}),delete s.prototype._notifications,s},BetaJS.Class.prototype.constructor=function(){this._notify("construct")},BetaJS.Class.prototype._notify=function(t){if(this.cls.__notifications){var e=Array.prototype.slice.call(arguments,1),n=this.cls.__notifications[t];if(n)for(var i in n)this[n[i]].apply(this,e)}},BetaJS.Class.prototype.destroy=function(){this._notify("destroy");for(var t in this)delete this[t]},BetaJS.Class.prototype._inherited=function(t,e){return t.parent.prototype[e].apply(this,Array.prototype.slice.apply(arguments,[2]))},BetaJS.Class._inherited=function(t,e){return t.parent[e].apply(this,Array.prototype.slice.apply(arguments,[2]))},BetaJS.Class.prototype.cls=BetaJS.Class,BetaJS.Class.__notifications={},BetaJS.Classes={},BetaJS.Classes.AutoDestroyMixin={enter:function(){this.__enter_count||(this.__enter_count=0),this.__enter_count++},leave:function(){this.__enter_count||(this.__enter_count=0),this.__enter_count--,1>this.__enter_count&&this.destroy()}},BetaJS.Lists={},BetaJS.Lists.AbstractList=BetaJS.Class.extend("AbstractList",{_add:function(){},_remove:function(){},_get:function(){},_iterate:function(){},constructor:function(){this._inherited(BetaJS.Lists.AbstractList,"constructor"),this.__count=0},add:function(t){var e=this._add(t);return BetaJS.Types.is_defined(e)&&this.__count++,e},count:function(){return this.__count},clear:function(){var t=this;this._iterate(function(e,n){return t.remove_by_ident(n),!0})},remove_by_ident:function(t){var e=this._remove(t);return BetaJS.Types.is_defined(e)&&this.__count--,e},getIdent:function(t){var e=null;return this._iterate(function(e,n){return e==t?(ident=n,!1):!0}),e},remove:function(t){return this.remove_by_ident(this.getIdent(t))},remove_by_filter:function(t){var e=this;this._iterate(function(n,i){return t(n)&&e.remove_by_ident(i),!0})},get:function(t){return this._get(t)},iterate:function(t){this._iterate(function(e,n){var i=t(e,n);return BetaJS.Types.is_defined(i)?i:!0})}}),BetaJS.Lists.IdObjectList=BetaJS.Lists.AbstractList.extend("IdObjectList",{constructor:function(){this._inherited(BetaJS.Lists.IdObjectList,"constructor"),this.__objects={},this.__last_id=0},_add:function(t){var e=this.__last_id++;return this.__objects[e]=t,e},_get:function(t){return this.__objects[t]},_remove:function(t){var e=this.__objects[t];return delete this.__objects[t],e},_iterate:function(t){for(var e in this.__objects)if(!t(this.__objects[e],e))return}}),BetaJS.Lists.LinkedList=BetaJS.Lists.AbstractList.extend("LinkedList",{constructor:function(){this._inherited(BetaJS.Lists.LinkedList,"constructor"),this.__first=null,this.__last=null},_add:function(t){return this.__last={obj:t,prev:this.__last,next:null},this.__first?this.__last.prev.next=this.__last:this.__first=this.__last,this.__last},_remove:function(t){return t.next?t.next.prev=t.prev:this.__last=t.prev,t.prev?t.prev.next=t.next:this.__first=t.next,t.obj},_get:function(t){return t.obj},_iterate:function(t){for(var e=this.__first;null!=e;){var n=e;if(e=e.next,!t(n.obj,n))return}}}),BetaJS.Iterators={},BetaJS.Iterators.Iterator=BetaJS.Class.extend("Iterator"),BetaJS.Iterators.ArrayIterator=BetaJS.Iterators.Iterator.extend("ArrayIterator",{constructor:function(t){this._inherited(BetaJS.Iterators.ArrayIterator,"constructor"),this.__arr=t,this.__i=0},hasNext:function(){return this.__i<this.__arr.length},next:function(){return this.__arr[this.__i++]}}),BetaJS.Iterators.MappedIterator=BetaJS.Iterators.Iterator.extend("MappedIterator",{constructor:function(t,e){this._inherited(BetaJS.Iterators.MappedIterator,"constructor"),this.__iterator=t,this.__map=e},hasNext:function(){return this.__iterator.hasNext()},next:function(){return this.__map(this.__iterator.next())}}),BetaJS.Events={},BetaJS.Events.EVENT_SPLITTER=/\s+/,BetaJS.Events.EventsMixin={on:function(t,e,n){this.__events=this.__events||{},t=t.split(BetaJS.Events.EVENT_SPLITTER);for(var i;i=t.shift();)this.__events[i]=this.__events[i]||new BetaJS.Lists.LinkedList,this.__events[i].add({callback:e,context:n});return this},off:function(t,e,n){this.__events=this.__events||{},t=t.split(BetaJS.Events.EVENT_SPLITTER);for(var i;i=t.shift();)this.__events[i]&&(this.__events[i].remove_by_filter(function(t){return!(e&&t.callback!=e||n&&t.context!=n)}),0==this.__events[i].count()&&(this.__events[i].destroy(),delete this.__events[i]));return this},trigger:function(t){var e=this;t=t.split(BetaJS.Events.EVENT_SPLITTER);var n,i=Array.prototype.slice.call(arguments,1);if(this.__events){for(;n=t.shift();)this.__events[n]&&this.__events[n].iterate(function(t){t.callback.apply(t.context||e,i)}),this.__events.all&&this.__events.all.iterate(function(t){t.callback.apply(t.context||e,i)});return this}}},BetaJS.Events.Events=BetaJS.Class.extend("Events",BetaJS.Events.EventsMixin),BetaJS.Events.PropertiesMixin=BetaJS.Objs.extend({get:function(t){return this.__properties?this.__properties[t]:null},set:function(t,e){this.__properties||(this.__properties={}),(!t in this.__properties||this.__properties[t]!=e)&&(this.__properties[t]=e,this.trigger("change"),this.trigger("change:"+t))},getAll:function(){return BetaJS.Objs.clone(this.__properties||{},1)},setAll:function(t){for(var e in t)this.set(e,t[e])}},BetaJS.Events.EventsMixin),BetaJS.Events.Properties=BetaJS.Class.extend("Properties",[BetaJS.Events.PropertiesMixin,{constructor:function(t){this._inherited(BetaJS.Events.Properties,"constructor"),t&&this.setAll(t)}}]);